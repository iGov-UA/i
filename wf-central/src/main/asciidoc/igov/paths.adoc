== Resources
=== AccessCentralController -- Доступ Центральный
:hardbreaks:
Access Central Controller

==== Получения ключа для аутентификации
----
GET /access/getAccessKey
----

===== Description
:hardbreaks:
##### Возвращает ключ для аутентификации. Пример:
https://test.igov.org.ua/wf/service/access/getAccessKey?sAccessLogin=activiti-master&sAccessContract=Request&sData=/wf/service/setMessage


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sAccessLogin|строка-технический логин|true|string|
|QueryParameter|sAccessContract|строка-контракт|true|string|
|QueryParameter|sData|строка-контент по которому генерируется ключ|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== AccessCommonController — Доступ Общий (права Доступа К Сервисам)
:hardbreaks:
Access Common Controller

==== Добавить/обновить объект-связку включение одного права, другим правом
----
GET /access/setAccessServiceRoleRightInclude
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект-связку, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и включенного права|false|integer (int64)|
|QueryParameter|nID_AccessServiceRole|Строка логин пользователя|true|integer (int64)|
|QueryParameter|nID_AccessServiceRole_Include|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект-связку включение одного права, другим правом|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-связку включение одного права, другим правом
----
POST /access/setAccessServiceRoleRightInclude
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект-связку, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и включенного права|false|integer (int64)|
|QueryParameter|nID_AccessServiceRole|Строка логин пользователя|true|integer (int64)|
|QueryParameter|nID_AccessServiceRole_Include|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект-связку включение одного права, другим правом|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить массив объектов-прав на сервис по фильтру
----
GET /access/getAccessServiceRights
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД права|false|integer (int64)|
|QueryParameter|sService|строка-сервис (маска)|false|string|
|QueryParameter|saMethod|строка-название метода вызова|false|string|
|QueryParameter|sHandlerBean|строка-название бина-обработчика|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Проверка разрешения на доступ к сервису для пользователя
----
GET /access/hasAccessServiceLoginRight
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/access/hasAccessServiceLoginRight?sLogin=SomeLogin&sService=access/hasAccessServiceLoginRight&sMethod=GET

```
Ответ false

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|QueryParameter|sService|Строка название сервиса|true|string|
|QueryParameter|sData|Строка параметр со строкой параметров к сервису (формат передачи пока не определен)|false|string|
|QueryParameter|sMethod|Метод доступа к свервису (GET или POST или другиие)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|true - если у пользоватля с логином sLogin есть доступ к рест-сервиcу sService при вызове его с аргументами sData, или false - если доступа нет.|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Ошибка бизнес-процесса|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-роли
----
GET /access/removeAccessServiceRole
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-роли
----
POST /access/removeAccessServiceRole
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-право на сервис
----
GET /access/removeAccessServiceRight
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-право на сервис
----
POST /access/removeAccessServiceRight
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-связку роли на право доступа к сервису
----
GET /access/setAccessServiceRoleRight
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект связку роли на право, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и роли|false|integer (int64)|
|QueryParameter|nID_AccessServiceRole|строка логин пользователя|true|integer (int64)|
|QueryParameter|nID_AccessServiceRight|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект-связку роли на право доступа к сервису|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-связку роли на право доступа к сервису
----
POST /access/setAccessServiceRoleRight
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект связку роли на право, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и роли|false|integer (int64)|
|QueryParameter|nID_AccessServiceRole|строка логин пользователя|true|integer (int64)|
|QueryParameter|nID_AccessServiceRight|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект-связку роли на право доступа к сервису|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

====  Аутентификация пользователя. Логаут пользователя (наличие cookie JSESSIONID)
----
DELETE /access/logout
----

===== Description
:hardbreaks:
##### 
Response:

```json
  {"session":"97AE7CA414A5DA85749FE379CC843796"}

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Возращает JSESSIONID|<<LogoutResponseI>>
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

====  Аутентификация пользователя. Логаут пользователя (наличие cookie JSESSIONID)
----
POST /access/logout
----

===== Description
:hardbreaks:
##### 
Response:

```json
  {"session":"97AE7CA414A5DA85749FE379CC843796"}

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Возращает JSESSIONID|<<LogoutResponseI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-права на сервис
----
GET /access/setAccessServiceRight
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект-право, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД права|true|integer (int64)|
|QueryParameter|sName|строка-название|true|string|
|QueryParameter|nOrder|номер порядка (проверки)|false|integer (int32)|
|QueryParameter|sService|строка-сервис|false|string|
|QueryParameter|saMethod|строка-название метода вызова|false|string|
|QueryParameter|sHandlerBean|строка-название бина-обработчика|false|string|
|QueryParameter|bDeny|булевый, запретить доступ к сервису?|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий объект-права на сервис|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-права на сервис
----
POST /access/setAccessServiceRight
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект-право, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД права|true|integer (int64)|
|QueryParameter|sName|строка-название|true|string|
|QueryParameter|nOrder|номер порядка (проверки)|false|integer (int32)|
|QueryParameter|sService|строка-сервис|false|string|
|QueryParameter|saMethod|строка-название метода вызова|false|string|
|QueryParameter|sHandlerBean|строка-название бина-обработчика|false|string|
|QueryParameter|bDeny|булевый, запретить доступ к сервису?|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий объект-права на сервис|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-связку включение одного права, другим правом
----
GET /access/removeAccessServiceRoleRightInclude
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-связку включение одного права, другим правом
----
POST /access/removeAccessServiceRoleRightInclude
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки права и права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-связку роли на право доступа к сервису
----
GET /access/removeAccessServiceRoleRight
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки роли и права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить объект-связку роли на право доступа к сервису
----
POST /access/removeAccessServiceRoleRight
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки роли и права|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-роли
----
GET /access/setAccessServiceRole
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект роли, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД роли|false|integer (int64)|
|QueryParameter|sName|строка-название|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект роли|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/обновить объект-роли
----
POST /access/setAccessServiceRole
----

===== Description
:hardbreaks:
Если задан nID, то обновляет обьект роли, если нет - создает новый

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД роли|false|integer (int64)|
|QueryParameter|sName|строка-название|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект роли|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Авторизирует пользователя и возвращает соответсвующую ему структуру объектов
----
POST /access/loginSubject
----

===== Description
:hardbreaks:
##### При вводе корректных данных метод возвращает код 200 и, при этом, открывается сессия и возвращается структура объектов, которая соответсвует этому пользователю.
 Если же пользователя с таким логином и паролем не существует, - то вернется ошибка с кодом LI_0001 и сообщением Login or password invalid.


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Строка логин пользователя|true|string|kermit
|BodyParameter|sPassword|Строка пароль пользователя|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление роли с логина
----
GET /access/removeAccessServiceLoginRole
----

===== Description
:hardbreaks:
Удаление происходит либо по nID связки, либо по парезначений sLogin и nID_AccessServiceRole.

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки|false|integer (int64)|
|QueryParameter|sLogin|строка-логин|false|string|
|QueryParameter|nID_AccessServiceRole|номер-ИД роли|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление роли с логина
----
POST /access/removeAccessServiceLoginRole
----

===== Description
:hardbreaks:
Удаление происходит либо по nID связки, либо по парезначений sLogin и nID_AccessServiceRole.

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД связки|false|integer (int64)|
|QueryParameter|sLogin|строка-логин|false|string|
|QueryParameter|nID_AccessServiceRole|номер-ИД роли|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сервис верификации контакта - электронного адреса
----
GET /access/verifyContactEmail
----

===== Description
:hardbreaks:
##### Примеры:
https://test.region.igov.org.ua/wf/service/access/verifyContactEmail?sQuestion=\test@igov.org.ua
Response

```json
{
    "bVerified":true,
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sQuestion|Строка запрос (электронный адрес)|true|string|
|QueryParameter|sAnswer|Строка ответ (код )|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить массив объеков ролей с правами в виде дерева
----
GET /access/getAccessServiceRoleRights
----

===== Description
:hardbreaks:
Если задан nID_AccessServiceRole то возвращает права для этой роли, если нет - то для всех ролей.

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_AccessServiceRole|номер-ИД роли|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Установить роль логина
----
GET /access/setAccessServiceLoginRole
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД|false|integer (int64)|
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|QueryParameter|nID_AccessServiceRole|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект роли логина|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Установить роль логина
----
POST /access/setAccessServiceLoginRole
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД|false|integer (int64)|
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|QueryParameter|nID_AccessServiceRole|номер-ИД роли|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Результирующий обьект роли логина|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Логин пользователя
----
POST /access/login-v2
----

===== Description
:hardbreaks:
##### Response:

```json
  {"session":"true"}

```
Пример:
https://test.region.igov.org.ua/wf/access/login?sLogin=kermit&sPassword=kermit


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|QueryParameter|sPassword|Строка пароль пользователя|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Возращает признак успеха/неудачи входа:
 - **true** - Пользователь авторизирован; 
- **false** - Имя пользователя или пароль некорректны. 
|<<LoginResponseI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить массив ролей логина
----
GET /access/getAccessServiceLoginRoles
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Логин пользователя
----
POST /access/login
----

===== Description
:hardbreaks:
##### Response:

```json
  {"session":"true"}

```
Пример:
https://test.region.igov.org.ua/wf/access/login?sLogin=kermit&sPassword=kermit


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Строка логин пользователя|true|string|
|QueryParameter|sPassword|Строка пароль пользователя|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Возращает признак успеха/неудачи входа:
 - **true** - Пользователь авторизирован; 
- **false** - Имя пользователя или пароль некорректны. 
|<<LoginResponseI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionEventController -- События По Действиям И Статистика
:hardbreaks:
Action Event Controller

==== Проверка наличия задачи определенного Бизнес процесса (БП), указанного гражданина
----
GET /action/event/getLastTaskHistory
----

===== Description
:hardbreaks:
##### Примеры:
http://test.igov.org.ua/wf/service/action/task/event/getLastTaskHistory?nID_Subject=2&nID_Service=1&sID_UA=1200000000

Ответ, если запись существует (HTTP status Code: 200 OK):

```json
{
"sID": "2",
"nID_Task": 2,
"nID_Subject": 2,
  "sStatus": "processing",
  "sID_Status": "заявка в обработке",
  "sDate": null,
  "nID_Service": 1,
  "nID_Region": 1,
  "sID_UA": "1200000000",
  "nRate": 0,
  "soData": "[]",
  "sToken": "",
  "sHead": "",
  "sBody": "",
  "nTimeMinutes": 0,
  "sID_Order": "0-22",
  "nID_Server": 0,
  "nID_Protected": null,
  "nID": 8
}


```
Ответ, если записи не существует. (HTTP status Code: 500 Internal Server Error):


```json
{
  "code": "BUSINESS_ERR",
  "message": "Record not found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|Номер-ИД субьекта|true|integer (int64)|
|QueryParameter|nID_Service|Номер-ИД услуги|true|integer (int64)|
|QueryParameter|sID_UA|Строка-ИД места (по Украинскому классификатору)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== setActionProcessCount
----
GET /action/event/setActionProcessCount
----

===== Description
:hardbreaks:
getActionProcessCount

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|sID_BP|true|string|
|QueryParameter|nID_Service|nID_Service|true|integer (int32)|
|QueryParameter|nYear |nYear |false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getActionProcessCount
----
GET /action/event/getActionProcessCount
----

===== Description
:hardbreaks:
getActionProcessCount

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|sID_BP|true|string|
|QueryParameter|nID_Service|nID_Service|true|integer (int32)|
|QueryParameter|nYear |nYear |false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Определения числа заявок по определенной услуге в рамках места, в котором она была подана
----
GET /action/event/getCountClaimHistory
----

===== Description
:hardbreaks:
Возвращает:\n\n"
     + "\n```json\n"
     + "{\n"
     + "  \"countClaim\": \"число заявок по определенной услуге в рамках места\",\n"
     + "}\n"
     + "\n```\n"

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_UA|Строка-ИД места (по Украинскому классификатору)|false|string|
|QueryParameter|nID_Service|Номер-ИД услуги|true|string|
|QueryParameter|nID_StatusType|Тип статуса заявки|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение события истории по его id
----
GET /action/event/getHistoryEvent
----

===== Description
:hardbreaks:

Пример 1 (Нет документа или HistoryEvent_Service связанных с этим событием):
https://test.igov.org.ua/wf/service/action/event/getHistoryEvent?nID=11


```json
{
  "sMessage": "Новая заявка создана_11",
  "sDate": "2015-07-04 12:18:56.235",
  "oHistoryEvent_Service": null,
  "oDocument": null,
  "nID": 11,
  "nID_Subject": 10,
  "nID_HistoryEventType": 6,
  "sEventName": "Изменение статуса заявки"
}

```
Пример 2 (Есть Документ и HistoryEvent_Service связанные с этим событием):
https://test.igov.org.ua/wf/service/action/event/getHistoryEvent?nID=12


```json
{
  "sMessage": "Новая заявка создана_11",
  "sDate": "2015-07-04 12:18:56.235",
  "oHistoryEvent_Service": {
    "sID": "2",
    "nID_Task": 2,
    "nID_Subject": 2,
    "sUserTaskName": "processing",
    "sDate": null,
    "nID_Service": 1,
    "nID_Region": 1,
    "sID_UA": "1200000000",
    "nRate": 0,
    "soData": "[]",
    "sToken": "TokenValue",
    "sHead": "",
    "sBody": "",
    "nTimeMinutes": 567,
    "sID_Order": "0-22",
    "nID_Server": 0,
    "nID_Proccess_Feedback": 0,
    "nID_Proccess_Escalation": 0,
    "sID_Rate_Indirectly": "",
    "nID_StatusType": 13,
    "sID_StatusType": "Unknown",
    "sName_UA_StatusType": "Заявка у невідомому статусі",
    "nID_Protected": null,
    "nID": 2
  },
  "oDocument": {
    "sContentType": "text/plain",
    "oSignData": "{}",
    "contentType": "text/plain",
    "nID": 7,
    "sName": "Справка",
    "oDocumentType": {
      "bHidden": false,
      "nID": 0,
      "sName": "Квитанція про сплату"
    },
    "sID_Content": "0",
    "oDocumentContentType": {
      "nID": 2,
      "sName": "text/plain"
    },
    "sFile": "dd1.txt",
    "sDate_Upload": "2015-01-01",
    "sID_Subject_Upload": "2872618520",
    "sSubjectName_Upload": "ВасяПупкин3",
    "oSubject_Upload": {
      "sID": "ПАО",
      "sLabel": "ПАО ПриватБанк",
      "sLabelShort": "ПриватБанк",
      "aSubjectAccountContact": null,
      "nID": 1
    },
    "oSubject": {
      "sID": "",
      "sLabel": "Fozzie Bear",
      "sLabelShort": "",
      "aSubjectAccountContact": null,
      "nID": 25
    }
  },
  "nID": 12,
  "nID_Subject": 10,
  "nID_HistoryEventType": 6,
  "sEventName": "Изменение статуса заявки"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер документа|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обновить объект события по услуге
----
GET /action/event/updateHistoryEvent_Service
----

===== Description
:hardbreaks:
##### Пример:
http://test.igov.org.ua/wf/service/action/event/updateHistoryEvent_Service?nID_Process=1&sUserTaskName=finish 
Также при апдейте охраняется информация о действии в Моем Журнале 1) запись "Ваша заявка №[nID_Process] змiнила свiй статус на [sUserTaskName]" 2) если есть параметр soData, то еще создается запись в виде:

- "По заявці №[nID_Process] задане прохання уточнення: [sBody]" (если sToken не пустой) -- согласно сервису запроса на уточнение
- "По заявці №[nID_Process] дана відповідь громадянином: [sBody]" (если sToken пустой) -- согласно сервису ответа на запрос по уточнению

плюс перечисление полей из soData в формате таблицы Поле / Тип / Текущее значение

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид события по услуге, в формате XXX-XXXXXX = nID_Server-nID_Protected|true|string|
|QueryParameter|sUserTaskName|строка-статус|false|string|
|QueryParameter|soData|строка-объект с данными (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sToken|строка-токена (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sBody|строка тела сообщения (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|nTimeMinutes|строка-время обработки задачи (в минутах, опционально)|false|string|
|QueryParameter|nID_Proccess_Feedback|номер-ид запущенного процесса для обработки фидбеков (issue 962)|false|integer (int64)|
|QueryParameter|nID_Proccess_Escalation|номер-ид бп эсклации (поле на перспективу для следующего тз по эскалации)|false|integer (int64)|
|QueryParameter|nID_StatusType|числовой код, который соответсвует статусу|true|integer (int64)|
|QueryParameter|sSubjectInfo|строка информация о субьекте|false|string|
|QueryParameter|nID_Subject|номер - ИД субьекта|false|integer (int64)|
|BodyParameter|body|JSON-строка для передачи всех параметров в POST-запросе|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обновить объект события по услуге
----
POST /action/event/updateHistoryEvent_Service
----

===== Description
:hardbreaks:
##### Пример:
http://test.igov.org.ua/wf/service/action/event/updateHistoryEvent_Service?nID_Process=1&sUserTaskName=finish 
Также при апдейте охраняется информация о действии в Моем Журнале 1) запись "Ваша заявка №[nID_Process] змiнила свiй статус на [sUserTaskName]" 2) если есть параметр soData, то еще создается запись в виде:

- "По заявці №[nID_Process] задане прохання уточнення: [sBody]" (если sToken не пустой) -- согласно сервису запроса на уточнение
- "По заявці №[nID_Process] дана відповідь громадянином: [sBody]" (если sToken пустой) -- согласно сервису ответа на запрос по уточнению

плюс перечисление полей из soData в формате таблицы Поле / Тип / Текущее значение

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид события по услуге, в формате XXX-XXXXXX = nID_Server-nID_Protected|true|string|
|QueryParameter|sUserTaskName|строка-статус|false|string|
|QueryParameter|soData|строка-объект с данными (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sToken|строка-токена (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sBody|строка тела сообщения (опционально, для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|nTimeMinutes|строка-время обработки задачи (в минутах, опционально)|false|string|
|QueryParameter|nID_Proccess_Feedback|номер-ид запущенного процесса для обработки фидбеков (issue 962)|false|integer (int64)|
|QueryParameter|nID_Proccess_Escalation|номер-ид бп эсклации (поле на перспективу для следующего тз по эскалации)|false|integer (int64)|
|QueryParameter|nID_StatusType|числовой код, который соответсвует статусу|true|integer (int64)|
|QueryParameter|sSubjectInfo|строка информация о субьекте|false|string|
|QueryParameter|nID_Subject|номер - ИД субьекта|false|integer (int64)|
|BodyParameter|body|JSON-строка для передачи всех параметров в POST-запросе|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== cleanActionProcessCount
----
GET /action/event/cleanActionProcessCount
----

===== Description
:hardbreaks:
cleanActionProcessCount

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|sID_BP|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить объект события по услуге
----
GET /action/event/getHistoryEvent_Service
----

===== Description
:hardbreaks:
##### Пример:
http://test.igov.org.ua/wf/service/action/event/getHistoryEvent_Service?nID_Protected=11
для sID_Order проверяется соответствие формату (должен содержать "-"), если черточки нету -- то перед строкой добавляется "0-"
для nID_Protected проверяется его корректность , где последняя цифра - это последний разряд контрольной суммы (по алгоритму Луна) для всего числа без нее.
- если не совпадает -- возвращается ошибка "CRC Error" (код состояния HTTP 403)
- если совпадает -- ищется запись по nID_Process = nID_Protected без последней цифры (берется последняя по дате добавления)
- Если не найдена запись, то возвращает объект ошибки со значением "Record not found" (код состояния HTTP 403)


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид заявки, в формате XXX-XXXXXX = nID_Server-nID_Order, первая часть -- ид сервера, где расположена задача, вторая часть -- nID_Protected, ид задачи + контрольная сумма по алгоритму Луна|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|401|Unauthorized|No Content
|403|CRC Error или Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение количества записей HistoryEvent_Service для сервиса по регионам
----
GET /action/event/getStatisticServiceCounts
----

===== Description
:hardbreaks:
##### Примеры:
https://test.igov.org.ua/wf/service/action/event/getStatisticServiceCounts?nID_Service=26

Результат

```json
[
  {
    "nCount": 5,
    "nRate": 0,
    "nTimeMinutes": "0",
    "sName": "Київ"
  },
  {
    "nCount": 15,
    "nRate": 0,
    "nTimeMinutes": "2",
    "sName": "Дніпропетровська"
  }
]
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Service|номер-ид сервиса(услуги)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Сохранение события в Мой Журнал
----
POST /action/event/setHistoryEvent
----

===== Description
:hardbreaks:
##### Пример:
http://test.igov.org.ua/wf/service/action/event/setHistoryEvent

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ИД-строка субъекта, который загрузил документ|false|integer (int64)|
|QueryParameter|nID_HistoryEventType|ИД-номер типа документа|false|integer (int64)|
|QueryParameter|sEventName|строка-кастомное описание документа|false|string|
|QueryParameter|sMessage|строка-сохраняемое содержимое|true|string|
|QueryParameter|nID_HistoryEvent_Service|номер-id обьекта события по услуге|false|integer (int64)|
|QueryParameter|nID_Document|номер-id - документа|false|integer (int64)|
|QueryParameter|sSubjectInfo|строка-информация о субъекте|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /sheduleAnswer_DFS
----
GET /action/event/sheduleAnswer_DFS
----

===== Description
:hardbreaks:
##### Получение ответов по процессам ДФС#####



===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение отчета о поданных заявках
----
GET /action/event/getServiceHistoryReport
----

===== Description
:hardbreaks:
##### Возвращает csv файл с информацией о задачах за указанный период на основании HistoryEventService записей.
В результате возвращаются следующий набор полей - sID_Order, nID_Server, nID_Service, sID_Place, nID_Subject, nRate, sTextFeedback, sUserTaskName, sHead, sBody, nTimeMinutes, sPhone
Результат для колонки sTextFeedback возвращается из сущности SubjectMessage, у которой nID_SubjectMessageType = 2
Результат для колонки sPhone возвращается из стартовой формы процесса из поля phone соответствующего регионального сервера
Примеры:
https://test.igov.org.ua/wf/service/action/event/getServiceHistoryReport?sDateAt=2016-02-09 00:00:00&sDateTo=2016-02-11 00:00:00&sanID_Service_Exclude=1,5,24,56

Результат

```csv
sID_Order,nID_Server,nID_Service,sID_Place,nID_Subject,nRate,sTextFeedback,sUserTaskName,sHead,sBody,nTimeMinutes,sPhone
0-88625055,0,740,6500000000,20045,,,,,Необхідно уточнити дані, за коментарем: не вірно вказані дані членів родини. Син - не відповідні ПІБ, бат - відсутні обов'язкові дані,,+380 97 225 5363

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sDateAt|строка-Дата начала выборки данных в формате yyyy-MM-dd HH:mm:ss|true|string|
|QueryParameter|sDateTo|строка-Дата окончания выборки данных в формате yyyy-MM-dd HH:mm:ss|true|string|
|QueryParameter|sID_FilterDateType|строка, указывающая на тип даты, по которой идет выгрузка данных|false|string|
|QueryParameter|bIncludeTaskInfo|загрузка данных из заявок|false|boolean|
|QueryParameter|sanID_Service_Exclude|строка-массив(перечисление) ИД услуг, которые нужно исключить|false|multi string array|
|QueryParameter|sCodepage|строка, указывающая желаемую кодировку ответа (windows-1251, utf-8)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== добавляет объект события по услуге
----
GET /action/event/addHistoryEvent_Service
----

===== Description
:hardbreaks:
при добавлении сначала проверяется, не было ли уже такой записи для данного nID_Process и nID_Server. если было -- ошибка Cannot create event_service with the same nID_Process and nID_Server!

потом генерируется поле nID_Protected по принципу: nID_Protected = nID_Process (ид задачи) + "контрольная цифра"

контрольная цифра -- это последний разряд суммы цифр числа по алгоритму Луна (для проверки корректности запрашиваемого ид записи) 

также генерируется поле sID_Order по принципу: sID_Order = nID_Server + "-" + nID_Protected

пример: http://test.igov.org.ua/wf/service/action/event/addHistoryEvent_Service?nID_Process=2&sUserTaskName=new&nID_Subject=2&sProcessInstanceName=test_bp

ответ:


```json
{
    "sID":null,
    "nID_Task":2,
    "nID_Subject":2,
    "sStatus":"new",
    "sUserTaskName":"new",
    "sDate":"2015-11-09 18:50:02.772",
    "nID_Service":null,
    "nID_Region":null,
    "sID_UA":null,
    "nRate":0,
    "soData":"[]",
    "sToken":null,
    "sHead":null,
    "sBody":null,
    "nTimeMinutes":null,
    "sID_Order":"0-22",
    "nID_Server":0,
    "nID_Protected":22,
    "nID":40648
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид заявки, в формате XXX-XXXXXX = nID_Server-nID_Order|true|string|
|QueryParameter|nID_Subject|ИД-номер|true|integer (int64)|
|QueryParameter|sUserTaskName|строка-статус|true|string|
|QueryParameter|nID_Service|ид услуги|false|integer (int64)|
|QueryParameter|nID_ServiceData|ид под-услуги|false|integer (int64)|
|QueryParameter|nID_Region|ид области|false|integer (int64)|
|QueryParameter|sID_UA|ид страны|false|string|
|QueryParameter|soData|строка-объект с данными (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sToken|строка-токена (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sHead|строка заглавия сообщения (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sBody|строка тела сообщения (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|nID_Proccess_Feedback|номер-ид запущенного процесса для обработки фидбеков (issue 962)|false|integer (int64)|
|QueryParameter|nID_Proccess_Escalation|номер-ид бп эсклации (поле на перспективу для следующего тз по эскалации)|false|integer (int64)|
|QueryParameter|nID_StatusType|числовой код, который соответсвует статусу|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Определения числа заявок по определенной услуге в рамках места и в отношении определенного субьекта
----
GET /action/event/getCountOrders
----

===== Description
:hardbreaks:
Возвращает:\n\n"
     + "\n```json\n"
     + "{\n"
     + "  \"nOpened\": \"количество открытых заявок\",\n"
     + "  \"bIsLimitReached\": \"0 - если лимит по открытым заявкам не достигнут; 1 - лостигнут лимит\"\n"
     + "}\n"
     + "\n```\n"

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|Номер-ИД субьекта|true|integer (int64)|
|QueryParameter|nID_Service|Номер-ИД услуги|true|integer (int64)|
|QueryParameter|sID_UA|Строка-ИД места (по Украинскому классификатору)|false|string|
|QueryParameter|nLimit|Число-лимит заявок, по умолчанию без лимита|false|integer (int32)|
|QueryParameter|bExcludeClosed|Булевый, true исключает закрытые из подсчета|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Загрузка событий
----
GET /action/event/getHistoryEvents
----

===== Description
:hardbreaks:
Пример 1: http://test.igov.org.ua/wf/service/action/event/getServicesStatistics?nID_Subject=10

Пример 2: http://test.igov.org.ua/wf/service/action/event/getServicesStatistics?nID_Subject=10&nID_HistoryEvent_Service=2

В зависимости от параметра **bGrouped** к списку может применяться фильтр.

- Если **bGrouped = false** - выбираются все сущности для данного субъекта
- если **bGrouped = true**, то в список попадают только уникальные сущности. Если сущности не уникальные, то из них отбирается только одна с самым большим временем в поле sDate

Уникальность сущности определяется путем сравнения полей **oHistoryEvent_Service, oDocument**

Алгоритм сравнения сущностей:

- если поля **oHistoryEvent_Service = null** и **oDocument=null**- сущности разные
- если **oHistoryEvent_Service = null**, а **oDocument = не null** -сравнение идет только по **oDocument**
- если **oHistoryEvent_Service = не null**, **а oDocument = null** - савнение идет только по **oHistoryEvent_Service**
- если **oHistoryEvent_Service = не null** и **oDocument = не null** - сравнение идет и по **oHistoryEvent_Service** и по **oDocument**


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|id авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|QueryParameter|nID_HistoryEvent_Service|id HistoryEvent_Service. Если задан, то параметр добавляется к кретериям отбора|false|integer (int64)|
|QueryParameter|bGrouped|булевый флаг, если **true**, то возвращает только последнюю по дате (sDate) запись, из тех, у которых nID_HistoryEvent_Service или nID_Document - один и тот-же|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение статистики по сервисам и регионам за заданный промежуток времени
----
GET /action/event/getServicesStatistic
----

===== Description
:hardbreaks:
##### Примеры:
https://test.igov.org.ua/wf/service/action/event/getServicesStatistic?sDate_from=2010-07-04 12:09:56&sDate_to=2019-07-04 12:09:56

Результат

```csv
nID_Service;ServiceName;SID_UA;placeName;nCountTotal;averageRate;averageTime
1;Надання довідки про притягнення до кримінальної відповідальності, відсутність (наявність) судимості або обмежень, передбачених кримінально-процесуальним законодавством України;1200000000;Дніпропетровська;4;0.0;7.516667

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sDate_from|дата "С", обязательный в формате YYYY-MM-DD hh:mm:ss|true|string|
|QueryParameter|sDate_to|дата "По", обязательный в формате YYYY-MM-DD hh:mm:ss|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionExecuteController
:hardbreaks:
Action Execute Controller

==== переместить записи из основной таблицы в олд или обратно
----
POST /action/execute/moveActionExecute
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nRowsMax|число строк максимальное (максимально - не более 1000, по умолчанию 10)|false|integer (int32)|
|QueryParameter|sMethodMask|строка-маска метода для выборки|false|string|
|QueryParameter|bOldOnly|булевый флаг, если true=только из олд-таблицы, иначе только из основной (по умолчанию false)|false|boolean|
|QueryParameter|asID_Status|массив JSON статусов для выборки|false|string|
|QueryParameter|nTryMax|число-лимит. выбрать только те, у которых число попыток не превышает указанный лимит (иначе с любым числом попыток)|false|integer (int32)|
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|QueryParameter|bBack|булевый флаг, если указан true, то переместить из олд-а в основную (по умолчанию false)|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== переместить записи из основной таблицы в олд или обратно
----
POST /action/execute/testMail
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nRowsMax|число строк максимальное (максимально - не более 1000, по умолчанию 10)|false|integer (int32)|
|QueryParameter|sMethodMask|строка-маска метода для выборки|false|string|
|QueryParameter|bOldOnly|булевый, true=только из олд-таблицы, иначе только из основной (по умолчанию false)|false|boolean|
|QueryParameter|asID_Status|массив JSON статусов для выборки|false|string|
|QueryParameter|nTryMax|число-лимит. выбрать только те, у которых число попыток не превышает указанный лимит (иначе с любым числом попыток)|false|integer (int32)|
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|QueryParameter|bBack|булевый, если указан true, то переместить из олд-а в основную (по умолчанию false)|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

====  получить массив всех акций
----
GET /action/execute/getActionExecute
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nRowsMax|число строк максимальное (максимально - не более 1000, по умолчанию 10)|false|integer (int32)|
|QueryParameter|sMethodMask|строка-маска метода для выборки|false|string|
|QueryParameter|bOldOnly|булевый флаг, если true=только из олд-таблицы, иначе только из основной (по умолчанию false)|false|boolean|
|QueryParameter|asID_Status|массив JSON статусов для выборки|false|string|
|QueryParameter|nTryMax|число-лимит. выбрать только те, у которых число попыток не превышает указанный лимит (иначе с любым числом попыток)|false|integer (int32)|
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение массива всех акций 
----
GET /action/execute/getActionExecuteStatuses
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== выполнить задачи
----
POST /action/execute/runActionExecute
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nRowsMax|число строк максимальное (максимально - не более 1000, по умолчанию 10)|false|integer (int32)|
|QueryParameter|sMethodMask|строка-маска метода для выборки|false|string|
|QueryParameter|bOldOnly|булевый флаг, если true=только из олд-таблицы, иначе только из основной (по умолчанию false)|false|boolean|
|QueryParameter|asID_Status|массив JSON статусов для выборки|false|string|
|QueryParameter|nTryMax|число-лимит. выбрать только те, у которых число попыток не превышает указанный лимит (иначе с любым числом попыток)|false|integer (int32)|
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== ActionFeedBackController — Действия Фидбэков
:hardbreaks:
Action Feed Back Controller

==== Запуск фидбека по процессу
----
GET /action/feedback/runFeedBack
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process|ид процесса|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionFlowController — Действия Очередей (слоты Потока, Расписания И Тикеты)
:hardbreaks:
Action Flow Controller

==== Добавление/изменение расписания исключения
----
GET /action/flow/setSheduleFlowExclude
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/setSheduleFlowExclude?nID_Flow_ServiceData=1&sName=Test&sRegionTime=%2210:30-11:30%22&sDateTimeAt=%222010-08-01%2010:10:30%22&sDateTimeTo=%222010-08-01%2018:10:00%22&saRegionWeekDay=%22mo,tu%22

```json
Пример результата
{
  "sData": null,
  "bExclude": true,
  "sName": "Test",
  "sRegionTime": "10:30-11:30",
  "saRegionWeekDay": "mo,tu",
  "sDateTimeAt": "2010-08-01 10:10:30",
  "sDateTimeTo": "2010-08-01 18:10:00",
  "nID": 20367,
  "nID_FlowPropertyClass": {
    "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
    "sBeanName": "defaultFlowSlotScheduler",
    "nID": 1,
    "sName": "DefaultFlowSlotScheduler"
  }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер //опциональный ,если задан - редактирование|false|integer (int64)|
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|номер-ИН департамента|false|integer (int64)|
|QueryParameter|sName|Строка-название ("Вечерний прием")|true|string|
|QueryParameter|sRegionTime|Строка период времени ("14:16-16-30")|true|string|
|QueryParameter|nLen|Число, определяющее длительность слота|false|integer (int32)|
|QueryParameter|sLenType|Строка определяющее тип длительности слота|false|string|
|QueryParameter|sData|Строка с данными(выражением), описывающими формулу расписания (например: {"0 0/30 9-12 ? * TUE-FRI":"PT30M"})|false|string|
|QueryParameter|saRegionWeekDay|Массив дней недели ("su,mo,tu")|true|string|
|QueryParameter|sDateTimeAt|Строка-дата начала(на) в формате YYYY-MM-DD hh:mm:ss ("2015-07-31 19:00:00")|true|string|
|QueryParameter|sDateTimeTo|Строка-дата конца(к) в формате YYYY-MM-DD hh:mm:ss ("2015-07-31 23:00:00")|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Резервирование тайм слота.
----
POST /action/flow/DMS/setSlotHold
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/DMS/setSlotHold

nID_Service_Private - 428sDateTime - 2016-08-17 14:05:00sSubjectFamily - SidorovsSubjectName - VladimirsSubjectSurname - PetrovichsSubjectPassport - 0101sSubjectPhone - +380666800000Пример результата


```json
{
  "reserved_to": "2016-08-14 22:28:15",
  "reserve_id": "18573",
  "interval": "15"
}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Service_Private|ИД услуги|true|string|
|QueryParameter|sDateTime|Дата и время в формате "YYYY-MM-DD hh:ii:ss"|true|string|
|QueryParameter|sSubjectFamily|Фамилия клиента|true|string|
|QueryParameter|sSubjectName|Имя клиента|true|string|
|QueryParameter|sSubjectSurname|Отчество клиента|true|string|
|QueryParameter|sSubjectPassport|Последние 4 цифры паспорта|true|string|
|QueryParameter|sSubjectPhone|Номер телефона клиента|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Удаление расписания включений
----
GET /action/flow/removeSheduleFlowInclude
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/removeSheduleFlowInclude?nID_Flow_ServiceData=1&nID=20367

Пример результата

```json
{
  "sData": null,
  "bExclude": false,
  "sName": "Test",
  "sRegionTime": "10:30-11:30",
  "saRegionWeekDay": "mo,tu",
  "sDateTimeAt": "2010-08-01 10:10:30",
  "sDateTimeTo": "2010-08-01 18:10:00",
  "nID": 20367,
  "nID_FlowPropertyClass": {
    "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
    "sBeanName": "defaultFlowSlotScheduler",
    "nID": 1,
    "sName": "DefaultFlowSlotScheduler"
  }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД записи|true|integer (int64)|
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Генерация слотов на заданный интервал для заданного потока
----
POST /action/flow/buildFlowSlots
----

===== Description
:hardbreaks:
##### Пример:
 http://test.igov.org.ua/wf/service/action/flow/buildFlowSlots
- nID_Flow_ServiceData=1
- sDateStart=2015-06-01 00:00:00.000
- sDateStop=2015-06-07 00:00:00.000
Ответ: HTTP STATUS 200.
Ниже приведена часть json ответа:

```json
[
    {
        "nID": 1000,
        "sTime": "08:00",
        "nMinutes": 15,
        "bFree": true
    },
    {
        "nID": 1001,
        "sTime": "08:15",
        "nMinutes": 15,
        "bFree": true
    },
    {
        "nID": 1002,
        "sTime": "08:30",
        "nMinutes": 15,
        "bFree": true
    },
...
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|QueryParameter|sDateStart|строка дата, начиная с такого-то момента времени, в формате "2015-06-28 12:12:56.001"|false|string|
|QueryParameter|sDateStop|строка дата, заканчивая к такому-то моменту времени, в формате "2015-07-28 12:12:56.001"|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|json перечисление всех сгенерированных слотов
Если на указанные даты слоты уже сгенерены то они не будут генерится повторно, и в ответ включаться не будут.|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавление/изменение расписания включений
----
GET /action/flow/setSheduleFlowInclude
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/setSheduleFlowInclude?nID_Flow_ServiceData=1&sName=Test&sRegionTime=%2210:30-11:30%22&sDateTimeAt=%222010-08-01%2010:10:30%22&sDateTimeTo=%222010-08-01%2018:10:00%22&saRegionWeekDay=%22mo,tu%22
Пример результата

```json
{
  "sData": null,
  "bExclude": false,
  "sName": "Test",
  "sRegionTime": "10:30-11:30",
  "saRegionWeekDay": "mo,tu",
  "sDateTimeAt": "2010-08-01 10:10:30",
  "sDateTimeTo": "2010-08-01 18:10:00",
  "nID": 20367,
  "nID_FlowPropertyClass": {
    "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
    "sBeanName": "defaultFlowSlotScheduler",
    "nID": 1,
    "sName": "DefaultFlowSlotScheduler"
  }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер, если задан - редактирование|false|integer (int64)|
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|QueryParameter|sName|Строка-название ("Вечерний прием")|true|string|
|QueryParameter|sRegionTime|Строка период времени ("14:16-16-30")|true|string|
|QueryParameter|nLen|Число, определяющее длительность слота|false|integer (int32)|
|QueryParameter|sLenType|Строка определяющее тип длительности слота|false|string|
|QueryParameter|sData|Строка с данными(выражением), описывающими формулу расписания (например: {"0 0/30 9-12 ? * TUE-FRI":"PT30M"})|false|string|
|QueryParameter|saRegionWeekDay|Массив дней недели ("su,mo,tu")|true|string|
|QueryParameter|sDateTimeAt|Строка-дата начала(на) в формате YYYY-MM-DD hh:mm:ss ("2015-07-31 19:00:00")|true|string|
|QueryParameter|sDateTimeTo|Строка-дата конца(к) в формате YYYY-MM-DD hh:mm:ss ("2015-07-31 23:00:00")|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Генерация слотов на заданный интервал для заданного потока
----
GET /action/flow/buildFlowSlot
----

===== Description
:hardbreaks:
##### Пример:
 alpha.test.region.igov.org.ua/wf/service/action/flow/buildFlowSlot
- nID_Flow_ServiceData=1
- sDateStart=2015-06-01 00:00:00.000
- sDateStop=2015-06-07 00:00:00.000
Ответ: HTTP STATUS 200.
Ниже приведена часть json ответа:

```json
[
    {
        "nID": 1000,
        "sTime": "08:00",
        "nMinutes": 15,
        "bFree": true
    },
    {
        "nID": 1001,
        "sTime": "08:15",
        "nMinutes": 15,
        "bFree": true
    },
    {
        "nID": 1002,
        "sTime": "08:30",
        "nMinutes": 15,
        "bFree": true
    },
...
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|json перечисление всех сгенерированных слотов
Если на указанные даты слоты уже сгенерены то они не будут генерится повторно, и в ответ включаться не будут.|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Подтверждение резервации тайм слота.
----
POST /action/flow/DMS/setSlot
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/DMS/setSlot

nID_SlotHold - 18573Пример результата


```json
{
  "patronymic": "Petrovich",
  "date_time": "2016-08-17 14:05:00",
  "ticket_code": "418303677",
  "service_id": "428",
  "name": "Vladimir",
  "ticket_number": "501",
  "lastname": "Sidorov"
}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SlotHold|ИД слота резервации|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Удаление слотов на заданный интервал для заданного потока
----
DELETE /action/flow/clearFlowSlots
----

===== Description
:hardbreaks:
##### Пример:

```
http://test.igov.org.ua/wf/service/action/flow/clearFlowSlots?nID_Flow_ServiceData=1&sDateStart=2015-06-01 00:00:00.000&sDateStop=2015-06-07 00:00:00.000


```
Ответ: HTTP STATUS 200 
Ниже приведена часть json ответа:


```json
{
    "aDeletedSlot": [
        {
            "nID": 1000,
            "sTime": "08:00",
            "nMinutes": 15,
            "bFree": true
        },
        {
            "nID": 1001,
            "sTime": "08:15",
            "nMinutes": 15,
            "bFree": true
        },
        ...
     ],
     "aSlotWithTickets": []
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|QueryParameter|sDateStart|строка дата, начиная с такого-то момента времени, в формате "2015-06-28 12:12:56.001"|true|string|
|QueryParameter|sDateStop|строка дата, заканчивая к такому-то моменту времени, в формате "2015-07-28 12:12:56.001"|true|string|
|QueryParameter|bWithTickets|булевое значение удалять ли слоты с тикетами, отвязывая тикеты от слотов? (опциональный, по умолчанию false). 
 Если bWithTickets=true то эти слоты тоже удаляются и будут перечислены в aDeletedSlot, 
 иначе - не удаляются.|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|json Обьект содержащий 2 списка:
- aDeletedSlot - удаленные слоты
- aSlotWithTickets - слоты с тикетами.
  Если bWithTickets=true то эти слоты тоже удаляются и будут перечислены в aDeletedSlot,
 иначе - не удаляются.
|object
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение активных тикетов
----
GET /action/flow/getFlowSlotTickets
----

===== Description
:hardbreaks:
##### Примеры:
https://test.region.igov.org.ua/wf/service/action/flow/getFlowSlotTickets?sLogin=kermit

```json
[
  {
    "sDateStart": "2015-07-20T15:15:00",
    "sDateEdit": "2015-07-06T11:03:52",
    "sTaskDate": "2015-07-30T10:03:43",
    "sDateFinish": "2015-07-20T15:30:00",
    "nID_FlowSlot": "6",
    "sNameBP": "Киев - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Надання послуги: Огляд авто",
    "nID": "20005"
  },
  {
    "sDateStart": "2015-07-20T15:45:00",
    "sDateEdit": "2015-07-06T23:25:15",
    "sTaskDate": "2015-07-06T23:27:18",
    "sDateFinish": "2015-07-20T16:00:00",
    "nID_FlowSlot": "7",
    "sNameBP": "Киев - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Надання послуги: Огляд авто",
    "nID": "20010"
  }
]

```

https://test.region.igov.org.ua/wf/service/action/flow/getFlowSlotTickets?sLogin=kermit&bEmployeeUnassigned=true

```json
[
  {
    "sDateStart": "2015-08-03T08:00:00",
    "sDateEdit": "2015-07-30T23:10:58",
    "sTaskDate": "2015-07-30T23:50:07",
    "sDateFinish": "2015-08-03T08:15:00",
    "nID_FlowSlot": "20086",
    "sNameBP": "Днепропетровск - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Друк держ.номерів",
    "nID": "20151"
  },
  {
    "sDateStart": "2015-08-03T08:15:00",
    "sDateEdit": "2015-07-31T21:00:56",
    "sTaskDate": "2015-07-31T21:01:19",
    "sDateFinish": "2015-08-03T08:30:00",
    "nID_FlowSlot": "20023",
    "sNameBP": "Киев - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Перевірка наявності обтяжень",
    "nID": "20357"
  }
]

```

https://test.region.igov.org.ua/wf/service/action/flow/getFlowSlotTickets?sLogin=kermit&bEmployeeUnassigned=true&sDate=2015-07-20

```json
[
  {
    "sDateStart": "2015-07-20T15:15:00",
    "sDateEdit": "2015-07-06T11:03:52",
    "sTaskDate": "2015-07-30T10:03:43",
    "sDateFinish": "2015-07-20T15:30:00",
    "nID_FlowSlot": "6",
    "sNameBP": "Киев - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Надання послуги: Огляд авто",
    "nID": "20005"
  },
  {
    "sDateStart": "2015-07-20T15:45:00",
    "sDateEdit": "2015-07-06T23:25:15",
    "sTaskDate": "2015-07-06T23:27:18",
    "sDateFinish": "2015-07-20T16:00:00",
    "nID_FlowSlot": "7",
    "sNameBP": "Киев - Реєстрація авто з пробігом в МРЕВ",
    "nID_Subject": "20045",
    "sUserTaskName": "Надання послуги: Огляд авто",
    "nID": "20010"
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|строка имя пользователя для которого необходимо вернуть тикеты|true|string|
|QueryParameter|bEmployeeUnassigned|булевое значение опциональный параметр (false по умолчанию). Если true - возвращать тикеты не заассайненые на пользователей|false|boolean|
|QueryParameter|sDate|строка опциональный параметр в формате yyyy-MM-dd. Дата за которую выбирать тикеты. При выборке проверяется startDate тикета (без учета времени. только дата). Если день такой же как и у указанное даты - такой тикет добавляется в результат.|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Удаление расписания исключений
----
GET /action/flow/removeSheduleFlowExclude
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/removeSheduleFlowExclude?nID_Flow_ServiceData=1&nID=20367

Пример результата


```json
{
  "sData": null,
  "bExclude": true,
  "sName": "Test",
  "sRegionTime": "10:30-11:30",
  "saRegionWeekDay": "mo,tu",
  "sDateTimeAt": "2010-08-01 10:10:30",
  "sDateTimeTo": "2010-08-01 18:10:00",
  "nID": 20367,
  "nID_FlowPropertyClass": {
    "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
    "sBeanName": "defaultFlowSlotScheduler",
    "nID": 1,
    "sName": "DefaultFlowSlotScheduler"
  }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер|true|integer (int64)|
|QueryParameter|nID_Flow_ServiceData|номер-ИД потока (обязательный если нет sID_BP)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса потока (обязательный если нет nID_Flow_ServiceData)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение массива объектов SubjectOrganDepartment по ID бизнес процесса
----
GET /action/flow/getFlowSlots_Department
----

===== Description
:hardbreaks:
##### Примеры:
 https://test.region.igov.org.ua/wf/service/action/flow/getFlowSlots_Department?sID_BP=dnepr_dms-89
Ответ:

```json
[
  {
    "sName": "ДМС, Днепр, пр. Ильича, 3 (dnepr_dms-89,dnepr_dms-89s)",
    "nID_SubjectOrgan": 2,
    "sGroup_Activiti": "dnepr_dms_89_bab",
    "nID": 13
  },
  {
    "sName": "ДМС, Днепр, вул. Шевченко, 7 (dnepr_dms-89,dnepr_dms-89s)",
    "nID_SubjectOrgan": 2,
    "sGroup_Activiti": "dnepr_dms_89_zhovt",
    "nID": 14
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|строка имя Activiti BP|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|возвращает массив объектов SubjectOrganDepartment для указанного Activiti BP|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Создание или обновление тикета в указанном слоте.
----
POST /action/flow/setFlowSlot_ServiceData
----

===== Description
:hardbreaks:
##### Пример:
 http://test.igov.org.ua/wf/service/action/flow/setFlowSlot_ServiceData

- nID_FlowSlot=1
- nID_Subject=2

Ответ: HTTP STATUS 200


```json
{ "nID_Ticket": 1000 }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_FlowSlot|ИД сущности FlowSlot|true|integer (int64)|
|QueryParameter|nID_Subject|ИД сущности Subject — субьект пользователь услуги, который подписывается на слот|true|integer (int64)|
|QueryParameter|nID_Task_Activiti|ИД таски активити процесса предоставления услуги (не обязательный — вначале он null, а потом засчитывается после подтверждения тикета и создания процесса)|false|integer (int64)|
|QueryParameter|nSlots|Кол-во слотов идущих подряд включая текущий (без зазоров времени между соседними), которые надо зарезервировать|true|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Поля в ответе:
 -поле "nID_Ticket" - ID созданной/измененной сущности FlowSlotTicket.
|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение слотов по сервису сгруппированных по дням
----
GET /action/flow/getFlowSlots
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.igov.org.ua/wf/service/action/flow/getFlowSlots?nID_ServiceData=1 
или
https://test.region.igov.org.ua/wf/service/action/flow/getSheduleFlowIncludes?sID_BP=kiev_mreo_1 
Ответ: HTTP STATUS 200


```json
{
    "aDay": [
        {
            "sDate": "2015-07-19",
            "bHasFree": true,
            "aSlot": [
                {
                    "nID": 1,
                    "sTime": "18:00",
                    "nMinutes": 15,
                    "bFree": true
                }
            ]
        },
        {
            "sDate": "2015-07-20",
            "bHasFree": true,
            "aSlot": [
                {
                    "nID": 3,
                    "sTime": "18:15",
                    "nMinutes": 15,
                    "bFree": true
                }
            ]
        }
    ]
}


```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Service|номер-ИД услуги  (обязательный если нет sID_BP и nID_ServiceData)|false|integer (int64)|
|QueryParameter|nID_ServiceData|ИД сущности ServiceData (обязательный если нет sID_BP и nID_Service)|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД бизнес-процесса (обязательный если нет nID_ServiceData и nID_Service)|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД департамента субьекта-органа|false|integer (int64)|
|QueryParameter|bAll|булевое значение, если false то из возвращаемого объекта исключаются элементы, содержащие "bHasFree":false "bFree":false (опциональный, по умолчанию false)|false|boolean|
|QueryParameter|nFreeDays|число дней со слотами будут включаться в результат пока не наберется указанное кол-во свободных дней (опциональный, по умолчанию 60)|false|integer (int32)|
|QueryParameter|nDays|число дней от сегодняшего включительно(или sDateStart, если задан), до nDays в будущее за который нужно вернуть слоты (опциональный, по умолчанию 177 - пол года)|false|integer (int32)|
|QueryParameter|nDiffDays|число рабочих дней пропуска от даты начала выборки (если не задана - от текущего), с которой начинать отображать расписание|false|integer (int32)|
|QueryParameter|nDiffDaysForStartDate|число смещения даты начала выборки с которой начинать отбирать расписание|false|integer (int32)|
|QueryParameter|sDateStart|строка параметр, определяющие дату начала в формате "yyyy-MM-dd", с которую выбрать слоты. При наличии этого параметра слоты возвращаются только за указанный период(число дней задается nDays)|false|string|
|QueryParameter|nSlots|число, опциональный параметр (по умолчанию 1), группировать слоты по заданному числу штук|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Успех операции: 
 Калькулируемые поля в ответе:
- флаг "bFree" - является ли слот свободным? Слот считается свободным если на него нету тикетов у которых nID_Task_Activiti равен null, а у тех у которых nID_Task_Activiti = null - время создания тикета (sDateEdit) не позднее чем текущее время минус 5 минут (предопределенная константа)
- флаг "bHasFree" равен true , если данных день содержит хотя бы один свободный слот.
|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение расписаний включений
----
GET /action/flow/getSheduleFlowIncludes
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/getSheduleFlowIncludes?nID_Flow_ServiceData=1

Пример результата


```json
[
  {
    "sData": null,
    "bExclude": false,
    "sName": "Test",
    "sRegionTime": ""10:30-11:30"",
    "saRegionWeekDay": ""mo,tu"",
    "sDateTimeAt": ""2010-08-01 10:10:30"",
    "sDateTimeTo": ""2010-08-01 18:10:00"",
    "nID": 20367,
    "nID_FlowPropertyClass": {
      "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
      "sBeanName": "defaultFlowSlotScheduler",
      "nID": 1,
      "sName": "DefaultFlowSlotScheduler"
    }
  },
  {
    "sData": null,
    "bExclude": false,
    "sName": "Test",
    "sRegionTime": "10:30-11:30",
    "saRegionWeekDay": "mo,tu",
    "sDateTimeAt": "10:30",
    "sDateTimeTo": "12:30",
    "nID": 20364,
    "nID_FlowPropertyClass": {
      "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
      "sBeanName": "defaultFlowSlotScheduler",
      "nID": 1,
      "sName": "DefaultFlowSlotScheduler"
    }
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Flow_ServiceData|ИД потока|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД БизнесПроцесса|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение календаря рабочих дней оргиназиции по заданной услуге на ближайшие 15 дней, включая текущий
----
GET /action/flow/DMS/getSlotFreeDays
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/action/flow/DMS/getSlotFreeDays?nID_Service_Private=428



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Service_Private|ID сервиса|true|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Получение расписаний исключений
----
GET /action/flow/getSheduleFlowExcludes
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/getSheduleFlowExcludes?nID_Flow_ServiceData=1

Пример результата

```json
[
  {
    "sData": null,
    "bExclude": true,
    "sName": "Test",
    "sRegionTime": "10:30-11:30",
    "saRegionWeekDay": "mo,tu"
    "sDateTimeAt": "2010-08-01 10:10:30",
    "sDateTimeTo": "2010-08-01 18:10:00",
    "nID": 20367,
    "nID_FlowPropertyClass": {
      "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
      "sBeanName": "defaultFlowSlotScheduler",
      "nID": 1,
      "sName": "DefaultFlowSlotScheduler"
    }
  },
  {
    "sData": null,
    "bExclude": false,
    "sName": "Test",
    "sRegionTime": "10:30-11:30",
    "saRegionWeekDay": "mo,tu",
    "sDateTimeAt": "10:30",
    "sDateTimeTo": "12:30",
    "nID": 20364,
    "nID_FlowPropertyClass": {
      "sPath": "org.igov.service.business.flow.handler.DefaultFlowSlotScheduler",
      "sBeanName": "defaultFlowSlotScheduler",
      "nID": 1,
      "sName": "DefaultFlowSlotScheduler"
    }
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Flow_ServiceData|ИД потока|false|integer (int64)|
|QueryParameter|sID_BP|строка-ИД БизнесПроцесса|false|string|
|QueryParameter|nID_SubjectOrganDepartment|ИД номер-ИН департамента|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<FlowProperty>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка тайм слотов
----
POST /action/flow/DMS/getSlots
----

===== Description
:hardbreaks:
##### Пример:
https://test.region.igov.org.ua/wf/service/action/flow/DMS/getSlots

nID_Service_Private - 428nDays - 2Пример результата


```json
{
  "2016-08-15": [
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "09:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "09:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "09:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "09:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "10:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "10:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "10:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "10:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "11:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "11:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "11:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "11:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "12:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "12:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "12:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "12:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "14:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "14:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "14:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "14:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "15:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "15:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "15:35:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "15:50:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "16:05:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "16:20:00"
    },
    {
      "date": "2016-08-15",
      "t_length": 15,
      "time": "16:35:00"
    }
  ],
  "2016-08-14": []
}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Service_Private|уникальный строковой-ИД сервиса|true|integer (int32)|
|QueryParameter|nDays|опциональный параметр, укзывающий количество дней для которыйх нужно найти слоты|false|integer (int32)|7
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

=== ActionHistoryController -- История По Документам
:hardbreaks:
Action History Controller

==== addHistoryEvent
----
GET /history/document/event/addHistoryEvent
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид заявки, в формате XXX-XXXXXX = nID_Server-nID_Order|false|string|
|QueryParameter|nID_Subject|ИД-номер|false|integer (int64)|
|QueryParameter|sUserTaskName|строка-статус|false|string|
|QueryParameter|nID_Service|ид услуги|false|integer (int64)|
|QueryParameter|nID_ServiceData|ид под-услуги|false|integer (int64)|
|QueryParameter|nID_Region|ид области|false|integer (int64)|
|QueryParameter|sID_UA|ид страны|false|string|
|QueryParameter|soData|строка-объект с данными (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sToken|строка-токена (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sHead|строка заглавия сообщения (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|sBody|строка тела сообщения (для поддержки дополнения заявки со стороны гражданина)|false|string|
|QueryParameter|nID_Proccess_Feedback|номер-ид запущенного процесса для обработки фидбеков (issue 962)|false|integer (int64)|
|QueryParameter|nID_Proccess_Escalation|номер-ид бп эсклации (поле на перспективу для следующего тз по эскалации)|false|integer (int64)|
|QueryParameter|nID_StatusType|числовой код, который соответсвует статусу|false|integer (int64)|
|QueryParameter|nID_HistoryEventType|числовой код, который соответсвует типу события|false|integer (int64)|
|QueryParameter|newData|новые данные после редактирвоание|false|string|
|QueryParameter|oldData|старые данные до редактирвоания|false|string|
|QueryParameter|new_BP_ID|ид бп созданного документа (для вызова субпроцесса)|false|string|
|QueryParameter|sLogin|логин или ФИО|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HistoryEvent_Service>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionIdentityCommonController
:hardbreaks:
Action Identity Common Controller

==== Возвращает список пользователей, если указан id групы, - выводит всех ее пользователей, иначе, по умолчанию возвращает всех существующих пользователей.
----
GET /action/identity/getUsers
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Group|строка, которая содержит число, id групы, опциональный параметр|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,string»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возвращает список груп, если указан логин пользователя, - выводит все его групы, иначе, по умолчанию возвращает все существующие групы.
----
GET /action/identity/getGroups
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|строка текст, логин пользователя, опциональный параметр|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Group>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаляет пользователя с указанным логином
----
DELETE /action/identity/removeUser
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|строка текст, логин пользователя, которого необходимо удалить|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавляет пользователя как члена групы
----
POST /action/identity/setUserGroup
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Group|строка текст, айди групы, в которую нужно добавить пользователя|true|string|
|QueryParameter|sLogin|строка текст, логин пользователя, которого необходимо добавить|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаляет членство пользователя в групе
----
DELETE /action/identity/removeUserGroup
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Group|строка текст, айди групы, из которой необходимо удалить юзера|true|string|
|QueryParameter|sLogin|строка текст, логин пользователя, которого необходимо удалить|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавление/обновление групы. Если група с указаным id существует, - то происходит перезапись существующих данных указанными.Если же група с указанным id не найдена, - будет создана новая запись.
----
GET /action/identity/setGroup
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|строка, которая содержит число, id групы|true|string|
|QueryParameter|sName|строка текст, название групы|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавление/обновление пользователя. Если пользователь с указаным логином существует, - то происходит перезапись существующих данных указанными.Если же пользователь с указанным логином не найден, - будет создана новая запись.
----
POST /action/identity/setUser
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|строка текст, логин пользователя для определения наличия пользователя в базе|true|string|
|BodyParameter|body|JSON-объект с параметрами: sPassword - (обязательный при создании нового пользователя) строка текст, логин пользователя для определения наличия пользователя в базе; sName - (обязательный) строка текст, имя пользователя; sDescription - (обязательный) строка текст, фамилия пользователя; sEmail - строка текст, имейл пользователя, опциональный параметр|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаляет групу с указаным id. Если група содержит пользователей, - будет выброшена ошибка которая будет содержать данные о списке пользователей в этой групе. Если же група имеет задание (таску) то при попытке ее удалить будет получена ошибка, которая будет содержать данные о списке доступных заданий.
----
DELETE /action/identity/removeGroup
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|строка, которая содержит число, id групы|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionItemController - Предметы Действий (каталог Сервисов)
:hardbreaks:
Action Item Controller

==== Получение сервиса
----
GET /action/item/getService
----

===== Description
:hardbreaks:
#####Пример:
https://test.igov.org.ua/wf/service/action/item/getService?nID=1


```json
Ответ:
{
  "sSubjectOperatorName": "МВС",
  "subjectOperatorName": "МВС",
  "nID": 1,
  "sName": "Отримати довідку про несудимість",
  "nOrder": 1,
  "aServiceData": [
    {
      "nID": 1,
      "nID_City": {
        "nID": 2,
        "sName": "Кривий Ріг",
        "nID_Region": {
          "nID": 1,
          "sName": "Дніпропетровська"
        }
      },
      "nID_ServiceType": {
        "nID": 1,
        "sName": "Внешняя",
        "sNote": "Пользователь переходит по ссылке на услугу, реализованную на сторонней платформе"
      },
      "oSubject_Operator": {
        "nID": 1,
        "oSubject": {
          "nID": 1,
          "sID": "ПАО",
          "sLabel": "ПАО ПриватБанк",
          "sLabelShort": "ПриватБанк"
        },
        "sOKPO": "093205",
        "sFormPrivacy": "ПАО",
        "sName": "ПриватБанк",
        "sNameFull": "Банк ПриватБанк"
      },
      "oData": "{}",
      "sURL": "https://null.igov.org.ua",
      "bHidden": false
    }
  ],
  "sInfo": "",
  "sFAQ": "",
  "sLaw": "",
  "nSub": 0
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер сервиса |true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение дерева сервисов
----
GET /action/item/getServicesTree
----

===== Description
:hardbreaks:
Дополнительно:
Если general.bTest = false, сервисы, имя которых начинается с "_", не вовращаются.

Пример: 
https://test.igov.org.ua/wf/service/action/item/getServicesTree?asID_Place_UA=3200000000,8000000000

Ответ:

```json
[
  {
    "nID": 1,
    "sID": "Citizen",
    "sName": "Громадянам",
    "nOrder": 1,
    "aSubcategory": [
      {
        "nID": 1,
        "sName": "Будівництво, нерухомість, земля",
        "sID": "Build",
        "nOrder": 1,
        "aService": [
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 6,
            "sName": "Видача відомостей з документації, що включена до місцевого фонду документації із землеустрою.",
            "nOrder": 6,
            "nSub": 1
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 8,
            "sName": "Надання довідки про перебування на квартирному обліку при міськвиконкомі за місцем проживання та в житлово-будівельному кооперативі.",
            "nOrder": 8,
            "nSub": 1
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 9,
            "sName": "Надання довідки про перебування на обліку бажаючих отримати земельну ділянку під індивідуальне будівництво",
            "nOrder": 9,
            "nSub": 0
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 10,
            "sName": "Видача витягу з технічної документації про нормативну грошову оцінку земельної ділянки",
            "nOrder": 10,
            "nSub": 2
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 11,
            "sName": "Надання відомостей з Державного земельного кадастру у формі витягу з Державного земельного кадастру про земельну ділянку",
            "nOrder": 11,
            "nSub": 0
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 12,
            "sName": "Присвоєння поштової адреси об’єкту нерухомого майна",
            "nOrder": 12,
            "nSub": 1
          },
          {
            "sSubjectOperatorName": "Міська Рада",
            "subjectOperatorName": "Міська Рада",
            "nID": 13,
            "sName": "Видача довідок про перебування на квартирному обліку",
            "nOrder": 13,
            "nSub": 0
          }
        ]
      }
    ]
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|строка-фильтр по имени сервиса. Если задано, то производится фильтрация данных - возвращаются только сервисы, в имени которых встречается значение этого параметра, без учета регистра.|false|string|
|QueryParameter|asID_Place_UA|массив строк - фильтр по ID места (мест), где надается услуга. Поддерживаемие ID: 3200000000 (КИЇВСЬКА ОБЛАСТЬ/М.КИЇВ), 8000000000 (М.КИЇВ). Если указан другой ID, фильтр не применяется.|false|multi string array|
|QueryParameter|bShowEmptyFolders|булевый флаг. Возвращать или нет пустые категории и подкатегории (по умолчанию false)|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Скачать данные в json файле
----
GET /action/item/downloadServicesAndPlacesTables
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление сущности ServiceData
----
DELETE /action/item/removeServiceData
----

===== Description
:hardbreaks:
Вовращает:
HTTP STATUS 200 - удаление успешно. HTTP STATUS 304 - не удалено.

Пример:
https://test.igov.org.ua/wf/service/action/item/removeServiceData?nID=1&bRecursive=true

Ответ: HTTP STATUS 200

```json
{
"code": "success",
"message": "class org.igov.activiti.common.ServiceData id: 1 removed"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-идентификатор ServiceData|true|integer (int64)|
|QueryParameter|bRecursive|булевый флаг. если true -- удалять рекурсивно все данные связанные с ServiceData. Если false, то при наличии вложенных сущностей, ссылающихся на эту, ServiceData удалена не будет|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|304|Ошибка удаления данных сервиса|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Изменение дерева категорий
----
POST /action/item/setServicesTree
----

===== Description
:hardbreaks:
 Можно менять категории (не добавлять и не удалять) + менять/добавлять (но не удалять) вложенные сущности, Передается json в теле POST запроса в том же формате, в котором он был в getServicesTree.

Возвращает: HTTP STATUS 200 + json представление сервиса после изменения. Чаще всего то же, что было передано в теле POST запроса + сгенерированные id-шники вложенных сущностей, если такие были.

Пример: https://test.igov.org.ua/wf/service/action/item/setServicesTree

```json
[
  	{
  		"nID": 1,
    	"sID": "Citizen",
		"sName": "Гражданин",
    	"nOrder": 1,
    	"aSubcategory": [
            {
                "nID": 5,
                "sName": "Праця2",
                "sID": "Work",
                "nOrder": 3,
                "aService": [
                    {
                        "nID": 3,
                        "sName": "Видача картки обліку об’єкта торговельного призначення, сфери послуг та з виробництва продуктів харчування",
                        "nOrder": 3
                    },
                    {
                        "nID": 4,
                        "sName": "Легалізація об’єднань громадян шляхом повідомлення",
                        "nOrder": 4
                    }
                ]
            }
            ]
         }
]

```
Ответ: HTTP STATUS 200

```json
[
    {
        "nID": 1,
        "sID": "Citizen",
        "sName": "Гражданин",
        "nOrder": 1,
        "aSubcategory": [
            {
                "nID": 5,
                "sName": "Праця2",
                "sID": "Work",
                "nOrder": 3,
                "aService": [
                    {
                        "nID": 3,
                        "sName": "Видача картки обліку об’єкта торговельного призначення, сфери послуг та з виробництва продуктів харчування",
                        "nOrder": 3
                    },
                    {
                        "nID": 4,
                        "sName": "Легалізація об’єднань громадян шляхом повідомлення",
                        "nOrder": 4
                    }
                ]
            }
            ]
         }
]

```
Для добавления новой подкатегории нужно передать запрос вида:

```json
[
  {
    "nID": 1,
    "aSubcategory": [
      {
        "sID": "Yd",
        "sName": "Yjdd",
        "nOrder": "1",
        "oCategory": {
          "nID": 1
        }
      }
    ]
  }
]

```
Обязательно нужно указывать внутри подкатегории ссылку на категорию, с помощью

```json
"oCategory": {
  "nID": 1
}

```
Для добавления нового сервиса нужно передать запрос вида:

```json
[
  {
    "nID": 1,
    "aSubcategory": [
      {
        "nID": 3,
        "aService": [
          {
            "sName": "service name",
            "nOrder": 10,
            "sSubjectOperatorName": "subjectOperatorName",
            "oSubcategory": {
              "nID": 3
            },
            "sInfo": "",
            "sFAQ": "",
            "sLaw": ""
          }
        ]
      }
    ]
  }
]

```
Обязательно нужно указывать внутри сервиса ссылку на подкатегорию, с помощью

```json
"oSubcategory": {
  "nID": 3
}

```
А также обязательные поля "sInfo", "sFAQ", "sLaw" - можно с пустыми значениями.


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|jsonData|строка-json в том же формате, в котором он был в getService|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Загрузить в виде json (в теле POST запроса)
----
POST /action/item/setServicesAndPlacesTables
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|jsonData|строка-json в том же формате, в котором он был в getService|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение дерева тегов и услуг
----
GET /action/item/getCatalogTreeTagService
----

===== Description
:hardbreaks:
Дополнительно:


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|строка-фильтр по имени сервиса. Если задано, то производится фильтрация данных - возвращаются только сервисы, в имени которых встречается значение этого параметра, без учета регистра.|false|string|
|QueryParameter|asID_Place_UA|массив строк - фильтр по ID места (мест), где надается услуга. Значения ID перечисляются через запятую.Если указан другой ID, фильтр не применяется.|false|multi string array|
|QueryParameter|nID_Place_Profile|фильтр по ID места тега услуги (опциональный)|false|integer (int64)|
|QueryParameter|bShowEmptyFolders|булевый флаг. Возвращать или нет пустые категории и подкатегории (по умолчанию false)|true|boolean|
|QueryParameter|nID_Category|ID категории|true|integer (int64)|
|QueryParameter|nID_ServiceTag_Root|ID корневого тега|false|integer (int64)|
|QueryParameter|nID_ServiceTag_Child|ID корневого тега|false|integer (int64)|
|QueryParameter|bNew|Новый формат ответа|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление подкатегории
----
DELETE /action/item/removeSubcategory
----

===== Description
:hardbreaks:
Вовращает:

HTTP STATUS 200 - удаление успешно. HTTP STATUS 304 - не удалено.

Пример 1:
https://test.igov.org.ua/wf/service/action/item/removeSubcategory?nID=1
Ответ 1: HTTP STATUS 304

Пример 2:
https://test.igov.org.ua/wf/service/action/item/removeSubcategory?nID=1&bRecursive=true

Ответ 2: HTTP STATUS 200

```json
{
    "code": "success",
    "message": "class org.igov.activiti.common.Subcategory id: 1 removed"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-идентификатор подкатегории|true|integer (int64)|
|QueryParameter|bRecursive|булевый флаг. если true -- удалять рекурсивно все данные связанные с подкатегорией. Если false, то при наличии вложенных сущностей, ссылающихся на эту, подкатегория удалена не будет|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|304|Ошибка удаления подкатегории|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение дерева тегов и услуг
----
GET /action/item/getCatalogTreeTag
----

===== Description
:hardbreaks:
Дополнительно:


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|строка-фильтр по имени сервиса. Если задано, то производится фильтрация данных - возвращаются только сервисы, в имени которых встречается значение этого параметра, без учета регистра.|false|string|
|QueryParameter|asID_Place_UA|массив строк - фильтр по ID места (мест), где надается услуга. Поддерживаемие ID: 3200000000 (КИЇВСЬКА ОБЛАСТЬ/М.КИЇВ), 8000000000 (М.КИЇВ). Если указан другой ID, фильтр не применяется.|false|multi string array|
|QueryParameter|nID_Place_Profile|фильтр по ID места тега услуги (опциональный)|false|integer (int64)|
|QueryParameter|bShowEmptyFolders|булевый флаг. Возвращать или нет пустые категории и подкатегории (по умолчанию false)|true|boolean|
|QueryParameter|nID_Category|ID категории|true|integer (int64)|
|QueryParameter|bNew|Новый формат ответа|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление категории
----
DELETE /action/item/removeCategory
----

===== Description
:hardbreaks:
Вовращает:

HTTP STATUS 200 - удаление успешно. HTTP STATUS 304 - не удалено.

Пример 1:
https://test.igov.org.ua/wf/service/action/item/removeCategory?nID=1
Ответ 1: HTTP STATUS 304

Пример 2:
https://test.igov.org.ua/wf/service/action/item/removeCategory?nID=1&bRecursive=true
Ответ 2: HTTP STATUS 200

```json
{
    "code": "success",
    "message": "class org.igov.activiti.common.Category id: 1 removed"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-идентификатор категории|true|integer (int64)|
|QueryParameter|bRecursive|булевый флаг. если true -- удалять рекурсивно все данные связанные с категорией. Если false, то при наличии вложенных сущностей, ссылающихся на эту, категория удалена не будет.|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|304|Ошибка удаления категории|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Загрузить из json файла
----
POST /action/item/uploadServicesAndPlacesTables
----

===== Description
:hardbreaks:
##### Пример страницы формы загрузки из файла:

```html
<html>
<body>
<form method="POST" enctype="multipart/form-data"
  action="http://localhost:8080/wf/service/action/item/uploadServicesAndPlacesTables">
  File to upload: <input type="file" name="file"><br /> <input type="submit"
  value="Upload"> Press here to upload the file!
</form>
</body>
</html>

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|FormDataParameter|file|файл для загрузки|true|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

==== Удаление всего дерева сервисов и категорий
----
DELETE /action/item/removeServicesTree
----

===== Description
:hardbreaks:
Вовращает:

HTTP STATUS 200 - удаление успешно.

Пример 1:
https://test.igov.org.ua/wf/service/action/item/removeServicesTree

```json
Ответ 1: HTTP STATUS 200
{
    "code": "success",
    "message": "ServicesTree removed"
}

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление сервиса
----
DELETE /action/item/removeService
----

===== Description
:hardbreaks:
Вовращает:

HTTP STATUS 200 - удаление успешно. HTTP STATUS 304 - не удалено.

Пример 1:
https://test.igov.org.ua/wf/service/action/item/removeService?nID=1

Ответ 1: HTTP STATUS 304

Пример 2: https://test.igov.org.ua/wf/service/action/item/removeService?nID=1&bRecursive=true
Ответ 2: HTTP STATUS 200

```json
{
    "code": "success",
    "message": "class org.igov.activiti.common.Service id: 1 removed"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер сервиса|true|integer (int64)|
|QueryParameter|bRecursive|булевый флаг. если true -- удалять рекурсивно все данные связанные с сервисом. Если false, то при наличии вложенных сущностей, ссылающихся на эту, сервис удален не будет|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|304|Ошибка удаления|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Изменение сервиса.
----
POST /action/item/setService
----

===== Description
:hardbreaks:
##### Можно менять/добавлять, но не удалять данные внутри сервиса, на разной глубине вложенности. Передается json в теле POST запроса в том же формате, в котором он был в getService.

Вовращает: HTTP STATUS 200 + json представление сервиса после изменения. Чаще всего то же, что было передано в теле POST запроса + сгенерированные id-шники вложенных сущностей, если такие были.


```json
Пример:
https://test.igov.org.ua/wf/service/action/item/setService
{
    "sSubjectOperatorName": "МВС",
    "subjectOperatorName": "МВС",
    "nID": 1,
    "sName": "Отримати довідку про несудимість",
    "nOrder": 1,
    "aServiceData": [
        {
            "nID": 1,
            "nID_City": {
                "nID": 2,
                "sName": "Кривий Ріг",
                "nID_Region": {
                    "nID": 1,
                    "sName": "Дніпропетровська"
                }
            },
            "nID_ServiceType": {
                "nID": 1,
                "sName": "Внешняя",
                "sNote": "Пользователь переходит по ссылке на услугу, реализованную на сторонней платформе"
            },
            "oSubject_Operator": {
                "nID": 1,
                "oSubject": {
                    "nID": 1,
                    "sID": "ПАО",
                    "sLabel": "ПАО ПриватБанк",
                    "sLabelShort": "ПриватБанк"
                },
                "sOKPO": "093205",
                "sFormPrivacy": "ПАО",
                "sName": "ПриватБанк",
                "sNameFull": "Банк ПриватБанк"
            },
            "oData": "{}",
            "sURL": "https://null.igov.org.ua",
            "bHidden": false
        }
    ],
    "sInfo": "",
    "sFAQ": "",
    "sLaw": "",
    "nSub": 0
}

```
Ответ:

```json
{
    "sSubjectOperatorName": "МВС",
    "subjectOperatorName": "МВС",
    "nID": 1,
    "sName": "Отримати довідку про несудимість",
    "nOrder": 1,
    "aServiceData": [
        {
            "nID": 1,
            "nID_City": {
                "nID": 2,
                "sName": "Кривий Ріг",
                "nID_Region": {
                    "nID": 1,
                    "sName": "Дніпропетровська"
                }
            },
            "nID_ServiceType": {
                "nID": 1,
                "sName": "Внешняя",
                "sNote": "Пользователь переходит по ссылке на услугу, реализованную на сторонней платформе"
            },
            "oSubject_Operator": {
                "nID": 1,
                "oSubject": {
                    "nID": 1,
                    "sID": "ПАО",
                    "sLabel": "ПАО ПриватБанк",
                    "sLabelShort": "ПриватБанк"
                },
                "sOKPO": "093205",
                "sFormPrivacy": "ПАО",
                "sName": "ПриватБанк",
                "sNameFull": "Банк ПриватБанк"
            },
            "oData": "{}",
            "sURL": "https://null.igov.org.ua",
            "bHidden": false
        }
    ],
    "sInfo": "",
    "sFAQ": "",
    "sLaw": "",
    "nSub": 0
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|soData_JSON|строка-json в том же формате, в котором он был в getService|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Скачать данные в виде json
----
GET /action/item/getServicesAndPlacesTables
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionTaskCentralController -- Действия Задачи Центрально
:hardbreaks:
Action Task Central Controller

==== Получение полей стартовой формы по: ИД субьекта, ИД услуги, ИД места Услуги
----
GET /action/task/getStartFormByTask_Central
----

===== Description
:hardbreaks:
возвращает JSON содержащий поля стартовой формы процесса, процесс находится на основании ИД таски полученой из сущности HistoryEvent_Service. На основании HistoryEvent_Service определяется региональный сервер откуда нужно получить поля формы и собственно ИД таски.

Примеры:
https://test.igov.org.ua/wf-central/service/action/task/getStartFormByTask_Central?nID_Subject=2&nID_Service=1&sID_UA=1200000000

Ответ, если запись существует (HTTP status Code: 200 OK):

```json
{
  waterback="--------------------",
  phone="380979362996",
  date_from="01/01/2014",
  bankIdbirthDay="27.05.1985",
  notice2="Я та особи, які зареєстровані (фактично проживають) у житловому приміщенні/будинку, даємо згоду на обробку персональних даних про сім’ю, доходи, майно, що необхідні для призначення житлової субсидії, та оприлюднення відомостей щодо її призначення.",
  house="--------------------",
garbage="--------------------",
  waterback_notice="",
  garbage_number="",
  floors="10",
  name_services="--------------------",
  date_to="30/12/2014",
  date3="",
  date2="",
  electricity="--------------------",
  garbage_name="",
  date1="",
  place_type="2",
  bankIdfirstName="ДМИТРО",
  declaration="--------------------",
  waterback_name="",
  electricity_notice="",
  bankIdinn="3119325858",
  house_name="",
  gas="--------------------",
  house_number="",
  subsidy="1",
  email="dmitrij.zabrudskij@privatbank.ua",
  warming="--------------------",
  hotwater_notice="",
  org0="Назва організації",
  org1="",
  electricity_number="123456",
  org2="",
  org3="",
  warming_name="",
  place_of_living="Дніпропетровська, Дніпропетровськ, пр. Героїв, 17, кв 120",
  fio2="",
  fio3="",
  total_place="68",
  garbage_notice="",
  fio1="",
  chapter1="--------------------",
  bankIdmiddleName="ОЛЕКСАНДРОВИЧ",
  gas_name="",
  bankIdPassport="АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002",
  warming_place="45",
  passport3="",
  gas_number="",
  passport2="",
  electricity_name="коммуна",
  area="samar",
  house_notice="",
  bankIdlastName="ДУБІЛЕТ",
  card1="",
  card3="",
  coolwater_number="",
  card2="",
  warming_notice="",
  hotwater_name="",
  income0="attr9",
  coolwater="--------------------",
  gas_notice="",
  overload="hxhxfhfxhfghg",
  warming_number="",
  income3="attr0",
  income1="attr0",
  income2="attr0",
  passport1="",
  coolwater_notice="",
  sBody_1="null",
  hotwater="--------------------",
  coolwater_name="",
  waterback_number="",
  man1="",
  hotwater_number="",
  sBody_2="null",
  comment="null",
  decision="null",
  selection="attr1"
}



```
Ответ, если записи не существует. (HTTP status Code: 500 Internal Server Error):

```json
{
  "code": "BUSINESS_ERR",
  "message": "Record not found"
}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|номер-ИД субьекта|true|integer (int64)|
|QueryParameter|nID_Server|номер-ИД сервера|false|integer (int32)|
|QueryParameter|nID_Service|номер-ИД услуги|true|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места Услуги|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== /setTaskAnswer_Central
----
GET /action/task/setTaskAnswer_Central
----

===== Description
:hardbreaks:
Нет описания

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|строка-ид заявки|true|string|
|QueryParameter|saField|строка-массива полей (например: "[{'id':'sFamily','type':'string','value':'Белявцев'},{'id':'nAge','type':'long','value':35}]")|true|string|
|QueryParameter|sToken|строка-токена. Данный параметр формируется и сохраняется в запись HistoryEvent_Service во время вызова метода setTaskQuestions|false|string|
|QueryParameter|nID_Subject|номер-ИД субьекта|false|integer (int64)|
|QueryParameter|sHead|строка заголовка сообщения|false|string|
|QueryParameter|bAuth|булевый флаг. Включить авторизацию|false|boolean|
|QueryParameter|sBody|строка тела сообщения|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ActionTaskCommonController — Действия Общие Задач
:hardbreaks:
Action Task Common Controller

==== Получение данных по таске
----
GET /action/task/getTaskData
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Сервис получения данных по таске #####

Request:

https://test.region.igov.org.ua/wf/service/action/task/getTaskData?nID_Task=nID_Task&sID_Order=sID_Order


Response:

```json
{
  "sStatusName": название юзертаски
  "sID_Status": ИД юзертаски
  "sDateTimeCreate": дата и время создания юзертаски
  "oProcess":{
    "sName":"название услуги (БП)"
    "sBP":"id-бизнес-процесса (БП)"
    "nID":"номер-ИД процесса"
    "sDateCreate":"дата создания процесса"
  },
  "aField":[...] - массив объектов полей Таски с их атрибутами
  "oData":{...} - oбъекты электронной очереди Таски либо значение NULL, если элементов электронной очереди в таске нет
 ... другие опциональные объекты: aGroup, aFieldStartForm, aAttachment и aMessage
}

```

Элементы массива aField обычно имеют следующую структуру:
 - для активных тасок:

```json
{
  "id": идентификатор, используемый для передачи данных в форму таски
  "name": отображаемое в форме описание поля
  "type": объект типа параметра
  "value": значение параметра
  "required": свойство указывает, что поле параметра обязательно для ввода значения
  "writable": свойство указывает, что от пользователя ожидаются введенные данные в поле при отправке формы
  "readable": свойство указывает на возможность отображения параметра и его обработки методами сервисов
}

```
 - для архивных тасок:

```json
{
  "id": идентификатор параметра
  "value": представленное значение
}

```



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Task|номер-ИД таски (обязательный)|false|integer (int64)|
|QueryParameter|nID_Process|номер-ИД процесса (опциональный, но обязательный если не задан nID_Task и sID_Order)|false|integer (int64)|
|QueryParameter|sID_Order|номер-ИД заявки (опциональный, но обязательный если не задан nID_Task и nID_Process)|false|string|
|QueryParameter|sLogin|(опциональный) логин, по которому проверяется вхождение пользователя в одну из групп, на которые распространяется данная задача|false|string|
|QueryParameter|bIncludeGroups|(опциональный) если задано значение true - в отдельном элементе aGroup возвращается массив отождествленных групп, на которые распространяется данная задача|false|boolean|
|QueryParameter|bIncludeStartForm|(опциональный) если задано значение true - в отдельном элементе aFieldStartForm возвращается массив полей стартовой формы|false|boolean|
|QueryParameter|bIncludeAttachments|(опциональный) если задано значение true - в отдельном элементе aAttachment возвращается массив элементов-объектов Attachment (без самого контента)|false|boolean|
|QueryParameter|bIncludeMessages|(опциональный) если задано значение true - в отдельном элементе aMessage возвращается массив сообщений по задаче|false|boolean|
|QueryParameter|bIncludeProcessVariables|(опциональный) если задано значение false - в элементе aProcessVariables не возвращается массив переменных процесса|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Поиск заявок по тексту (в значениях полей без учета регистра)
----
GET /action/task/getTasksByText
----

===== Description
:hardbreaks:
##### Примеры:
https://test.region.igov.org.ua/wf/service/action/task/getTasksByText?sFind=будинк

```json
["4637994","4715238","4585497","4585243","4730773","4637746"]

```
https://test.region.igov.org.ua/wf/service/action/task/getTasksByText?sFind=будинк&sLogin=kermit

```json
["4637994","4715238","4585243","4730773","4637746"]

```
https://test.region.igov.org.ua/wf/service/action/task/getTasksByText?sFind=будинк&sLogin=kermit&bAssigned=false

```json
["4637994","4637746"]

```
https://test.region.igov.org.ua/wf/service/action/task/getTasksByText?sFind=будинк&sLogin=kermit&bAssigned=true

```json
["4715238","4585243","4730773"]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|строка текст для поиска в полях заявки|true|string|
|QueryParameter|sLogin|строка необязательный параметр. При указании выбираются только таски, которые могут быть заассайнены или заассайнены на пользователя sLogin|false|string|
|QueryParameter|bAssigned|булево значение необязательный параметр. Указывает, что нужно искать по незаассайненным таскам (bAssigned=false) и по заассайненным таскам(bAssigned=true) на пользователя sLogin|false|string|
|QueryParameter|bSortByStartDate|булево значение необязательный параметр. Если true - будет выполнена сортировка по дате|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|возвращает список ID тасок у которых в полях встречается указанный текст|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сервис смены пароля пользователя в Activity
----
POST /action/task/changePassword
----

===== Description
:hardbreaks:
#### Примеры 
Request: 
https://alpha.test.igov.org.ua/wf/service/action/task/changePassword
sLoginOwner=kermit
sPasswordOld=kermit
sPasswordNew=kermit1
Response: Ok, 200 

 ```json
{
"userId":"kermit",
"userEmail":"kermit@activiti.org",
"userFirstName":"Kermit",
"userLastName":"The Frog"
}

```

Wrong sPasswordOld
Request:
https://alpha.test.igov.org.ua/wf/service/action/task/changePassword
sLoginOwner=kermit
sPasswordOld=kermit45
sPasswordNew=kermit1
Response: Forbidden 403

 ```json
{
"code":"BUSINESS_ERR",
"message":"Password kermit45 is wrong"
}

```

Wrong sLogin
Request:
https://alpha.test.igov.org.ua/wf/service/action/task/changePassword
sLoginOwner=kermit45
sPasswordOld=kermit
sPasswordNew=kermit1
Response: Forbidden 403

 ```json
{
"code":"BUSINESS_ERR",
"message":"Error! user has not been found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLoginOwner|Строка логин пользователя, меняющего пароль|true|string|
|BodyParameter|sPasswords|JSON-cnрока с двумя параметрами: sPasswordOld - Строка старый пароль; sPasswordNew - Строка новый пароль|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getTasks
----
GET /action/task/getTasks
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение списка всех тасок, которые могут быть доступны указанному логину #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/getTasks?sLogin=[sLogin]


- Возвращает список всех тасок, которые могут быть доступны указанному логину [sLogin] и которые уже заняты другими логинами, входящими во все те-же группы, в которые входит данный логин

Во время выполнения производит поиск групп, в которые входит указанный пользователь, и затем возвращает список задач, которые могут быть  заассайнены на пользователей из полученных групп:

Содержит следующие параметры:
- sLogin - id пользователя. обязательный параметр, указывающий пользователя
- bIncludeAlienAssignedTasks - необязательный параметр (по умолчанию false). Если значение false - то возвращать только свои и только не ассайнутые, к которым доступ.
- sOrderBy - метод сортировки задач. Необязательный параметр. По умолчанию 'id'. Допустимые значения 'id', 'taskCreateTime', 'ticketCreateDate'
- nSize - Количество задач в результате. Необязательный параметр. По умолчанию 10.
- nStart - Порядковый номер первой задачи для возвращения. Необязательный параметр. По умолчанию 0
- sFilterStatus - Необязательный параметр (по умолчанию обрабатывается как OpenedUnassigned). статус фильтрации задач, у которого возможные значения: OpenedUnassigned (только не-ассайнутые),  OpenedAssigned(только ассайнутые), Opened(только открытые (не в истории)), Closed(только закрытые (история))
- bFilterHasTicket - Необязательный параметр (по умолчанию false). Если true - возвращать только те задачи, у которых есть связанный тикет
Примеры:

https://test.region.igov.org.ua/wf/service/action/task/getTasks?sLogin=kermit

https://test.region.igov.org.ua/wf/service/action/task/getTasks?sLogin=kermit&nSize=15&nStart=10



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|true|string|
|QueryParameter|nID_Process|nID_Process|false|integer (int64)|
|QueryParameter|bIncludeAlienAssignedTasks|bIncludeAlienAssignedTasks|true|boolean|
|QueryParameter|sOrderBy|sOrderBy|false|string|
|QueryParameter|nSize|nSize|false|integer (int32)|
|QueryParameter|nStart|nStart|false|integer (int32)|
|QueryParameter|sFilterStatus|sFilterStatus|false|string|
|QueryParameter|bFilterHasTicket|bFilterHasTicket|false|boolean|
|QueryParameter|soaFilterField|soaFilterField|false|string|
|QueryParameter|bIncludeVariablesProcess|bIncludeVariablesProcess|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getTasksByAssigneeGroup
----
GET /action/task/groups/{group}
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|PathParameter|group|ИД авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<TaskAssigneeI>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обработка изменения статуса документа в УкрДок
----
POST /action/task/callback/ukrdoc
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Обработка изменения статуса документа в УкрДок #####

Request:

https://alpha.test.igov.org.ua/wf/service/action/task/callback/ukrdoc


Метод выполняет следующие действия:
 - получает текущий статус документа из тега data -> docStateEvent -> state -> current 
 - получает номер документа из тега data -> docStateEvent -> tables -> CardsDocument -> CarIdDocument 
 - ищет процесс, с которым связан данный документ используя сущность ActionTaskLink. Если сущности такой еще нет - то производится поиск  по переменной процесса sID_Document, которая устанавливается при отправке документа в УкрДок, и осуществляется сохранение сущности ActionTaskLink
 - после нахождения текущей активной задачи статус из УкрДока записывается в переменную sID_Document_UkrDoc задачи
 - завершает текущую задачу. для следующей активной задачи ответственным назначает пользователя завершенной задачи. Если пользователя не было - то задача остается без активного пользователя
В теле запроса передается объект с информацией об изменении:
Образец документа:

```json
"create_time": "2016.02.05 12:51:21",
"change_time": "2016.02.05 12:51:21",
"node_prev_id": "56b0b33edfb2840b2a5644c2",
"status": "processed",
"user_id": 5850,
"data": {
    "docStateEvent": {
            "state": {
                    "current": "Не завизирован",
                    "previous": "Создан"
            },
            "pk": {
                    "id": 6569546,
                    "year": 2016
            },
            "tables": {
                    "Executors": {
                            "body": [
                                    [
                                            "DD100262LVI",
                                            null,
                                            null,
                                            "2",
                                            1,
                                            0,
                                            null,
                                            null,
                                            null,
                                            null,
                                            "0",
                                            null
                                    ]
                            ],
                            "head": {
                                    "IdAddedMethod": 11,
                                    "Lightning": 10,
                                    "ExecutData": 9,
                                    "ControlDate": 8,
                                    "AttentionExecutData": 7,
                                    "InitData": 6,
                                    "KindOrder": 5,
                                    "VisOrder": 4,
                                    "KindExecutor": 3,
                                    "peo_peo_ldap_login": 2,
                                    "io_peo_ldap_login": 1,
                                    "peo_ldap_login": 0
                            }
                    },
                    "PunctAttending": {
                            "DataPunctAttending": "2016-02-05 12:51:20",
                            "NamePunctAttending": "Создание",
                            "peo_ldap_login": "DD100262LVI"
                    },
                    "CardsDocument": {
                         "Invizible": null,
                         "LastCoordDate": null,
                         "DocCreateData": null,
                         "CoordBonDays": null,
                         "Flavor": null,
                         "IdPetm": null,
                         "Lightning": "0",
                         "Locale": "RU",
                         "DocLastModifData": "2016-02-05 12:51:20",
                         "CoordRtrnDate": "2016-02-05 12:51:20",
                         "Prioritet": "Обычный",
                         "ClassId": "a",
                         "IdKindDoc": 19,
                         "IdKindIncomming": 0,
                         "IdGroup": 1,
                         "DocumentName": "Акт перерахунку сумки",
                         "NumberDocument": "0",
                         "CarIdDocument": 6569546,
                         "IdActivity": 4842,
                         "IdXMLT": 8223,
                         "peo_peo_ldap_login": "DD100262LVI",
                         "peo_ldap_login": "DD100262LVI",
                         "IdAttending": 6569544
                 }
         },
         "uniq": 5777275,
         "dlm": "2016-02-05 12:51:20"
    },
    "__conveyor_copy_task_result__": "ok"
  }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|event|event|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getCountTask
----
GET /action/task/getCountTask
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение количествоа задач по нескольким наборам критериев-фильтров для указанного логина #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/getCountTask?sLogin=[sLogin]?&amFilter=[amFilter]


Параметры:
- sLogin - имя пользователя для которого подсчитывать количества тасок
- amFilter - массив наборов фильтров, по которым выдавать количества задач. 
Допустимые параметры внутри наборов фильтров amFilter: 
sFilterStatus - статус фильтрации задач. Значение по умолчанию - OpenedUnassigned (только не-ассайнутые), OpenedAssigned(только ассайнутые), Opened(только открытые (не в истории)), Closed(только закрытые (история))) 
bFilterHasTicket - по умолчанию false. Если true - возвращать только те задачи, у которых есть связанный тикет
bIncludeAlienAssignedTasks - по умолчанию false. Если значение false - то возвращать только свои и только не ассайнутые, к которым доступ.
Примеры:

https://test.region.igov.org.ua/wf/service/action/task/getCountTask?sLogin=kermit&amFilter=[{"bFilterHasTicket":true},{"sFilterStatus":"OpenedUnassigned"},{"sFilterStatus":"OpenedAssigned","bFilterHasTicket":true}]
Ответы: 

```json
[ 
{"nCount":5},
{"nCount":688},
{"nCount":0}
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|true|string|
|QueryParameter|amFilter|amFilter|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,object»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /getDocumentStepRights
----
GET /action/task/getDocumentStepRights
----

===== Description
:hardbreaks:
##### Получение списка прав у логина по документу#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|true|string|
|QueryParameter|nID_Process|nID_Process|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /removeOldProcess
----
GET /action/task/removeOldProcess
----

===== Description
:hardbreaks:
##### Удаление закрытых процессов из таблиц активити#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ид процесса|false|integer (int64)|
|QueryParameter|sID_Process_Def|ид бизнес-процесса|false|string|
|QueryParameter|sDateFinishAt|дата закрытия процесса с |true|string|2010-01-01
|QueryParameter|sDateFinishTo|дата закрытия процесса по |true|string|2050-01-01
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Запуск процесса Activiti
----
GET /action/task/start-process/{key}
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Запуск процесса Activiti #####

HTTP Context: https://server:port/wf/service/action/task/start-process/{key}
- nID_Subject - ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)
Request:

https://test.region.igov.org.ua/wf/service/action/task/start-process/citizensRequest

Response

```json
  {
    "id":"31"
  }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|PathParameter|key|Ключ процесса|true|string|
|QueryParameter|organ|Орган|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessI>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка бизнес процессов к которым у пользователя есть доступ
----
GET /action/task/getBPs
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение списка бизнес процессов к которым у пользователя есть доступ #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/getLoginBPs?sLogin=userId

Метод возвращает json со списком бизнес процессов, к которым у пользователя есть доступ, в формате:

```json
[
  {
    "sID": "[process definition key]""sName": "[process definition name]"
  },
  {
    "sID": "[process definition key]""sName": "[process definition name]"
  }
]

```
Принадлежность пользователя к процессу проверяется по вхождению в группы, которые могут запускать usertask-и внутри процесса, или по вхождению в группу, которая может стартовать процесс

Пример:

https://test.region.igov.org.ua/wf/service/action/task/getLoginBPs?sLogin=kermit
Пример результата

```json
[
{
    "sID": "dnepr_spravka_o_doxodax",
    "sName": "Дніпропетровськ - Отримання довідки про доходи фіз. осіб"
  },
  {
    "sID": "dnepr_subsidies2",
    "sName": "Отримання субсидії на оплату житлово-комунальних послуг2"
  },
  {
    "sID": "khmelnitskij_mvk_2",
    "sName": "Хмельницький - Надання інформації, що підтверджує відсутність (наявність) земельної ділянки"
  },
  {
    "sID": "khmelnitskij_zemlya",
    "sName": "Заява про наявність земельної ділянки"
  },
  {
    "sID": "kiev_spravka_o_doxodax",
    "sName": "Київ - Отримання довідки про доходи фіз. осіб"
  },
  {
    "sID": "kuznetsovsk_mvk_5",
    "sName": "Кузнецовськ МВК - Узгодження графіка роботи підприємства торгівлі\/обслуговування"
  },
  {
    "sID": "post_spravka_o_doxodax_pens",
    "sName": "Отримання довідки про доходи (пенсійний фонд)"
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин пользователя|true|string|
|QueryParameter|bDocOnly|Выводить только список БП документов|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,string»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Сервис получения значения переменной процесса
----
GET /action/task/getProcessVariableValue
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Сервис получения значения переменной процесса #####

Request:

https://test.region.igov.org.ua/wf/service/action/task/getProcessVariableValue?nID_Process=[nID_Process]&sVariableName=[sVariableName]


nID_Process - ID процесса, в котором искать переменную
sVariableName - имя переменной, значение которой необходимо вернуть
Пример: https://test.region.igov.org.ua/wf/service/action/task/getProcessVariableValue?nProcessID=8965001&sVariableName=phone
Response:

```json
  {"phone":"+380 50 960 0041"}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ID процесса|true|string|
|QueryParameter|sVariableName|Название переменнной процесса значение которой необходимо найти|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== DeleteProcess
----
DELETE /action/task/delete-process-list
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: описания нет #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sanID_Process|sanID_Process|true|string|
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sReason|sReason|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка бизнес процессов к которым у пользователя есть доступ
----
GET /action/task/getLoginBPs
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение списка бизнес процессов к которым у пользователя есть доступ #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/getLoginBPs?sLogin=userId

Метод возвращает json со списком бизнес процессов, к которым у пользователя есть доступ, в формате:

```json
[
  {
    "sID": "[process definition key]""sName": "[process definition name]"
  },
  {
    "sID": "[process definition key]""sName": "[process definition name]"
  }
]

```
Принадлежность пользователя к процессу проверяется по вхождению в группы, которые могут запускать usertask-и внутри процесса, или по вхождению в группу, которая может стартовать процесс

Пример:

https://test.region.igov.org.ua/wf/service/action/task/getLoginBPs?sLogin=kermit
Пример результата

```json
[
{
    "sID": "dnepr_spravka_o_doxodax",
    "sName": "Дніпропетровськ - Отримання довідки про доходи фіз. осіб"
  },
  {
    "sID": "dnepr_subsidies2",
    "sName": "Отримання субсидії на оплату житлово-комунальних послуг2"
  },
  {
    "sID": "khmelnitskij_mvk_2",
    "sName": "Хмельницький - Надання інформації, що підтверджує відсутність (наявність) земельної ділянки"
  },
  {
    "sID": "khmelnitskij_zemlya",
    "sName": "Заява про наявність земельної ділянки"
  },
  {
    "sID": "kiev_spravka_o_doxodax",
    "sName": "Київ - Отримання довідки про доходи фіз. осіб"
  },
  {
    "sID": "kuznetsovsk_mvk_5",
    "sName": "Кузнецовськ МВК - Узгодження графіка роботи підприємства торгівлі\/обслуговування"
  },
  {
    "sID": "post_spravka_o_doxodax_pens",
    "sName": "Отримання довідки про доходи (пенсійний фонд)"
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин пользователя|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== /startProcess
----
POST /action/task/startProcess
----

===== Description
:hardbreaks:
##### Старт процесса#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sID_BP|sID_BP|true|string|
|BodyParameter|sJsonBody|JSON-щбъект с заполненными полями заполненной стартформы|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=utf-8

==== Создание нового обьекта-записи линка
----
GET /action/task/setLink
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Сервис создания обьекта-записи линка #####

Request:

https://alpha.test.igov.org.ua/wf/service/action/task/setLink?nID_Process=nID_Process&sKey=sKey&nID_Subject_Holder=nID_Subject_Holder


Response:

```json
  {"sKey":"Cтрока-ключ",       "nID":ИД обьекта,       "nID_Process":ИД бизнес процесса,       "nID_Subject_Holder":ИД субьекта-хранителя    }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД бизнес процесса|true|integer (int64)|
|QueryParameter|sKey|Cтрока-ключ|true|string|
|QueryParameter|nID_Subject_Holder|ИД субьекта-хранителя|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ActionTaskLink>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /closeProcess
----
GET /action/task/closeProcess
----

===== Description
:hardbreaks:
##### Закрытие всех инстансов бизнес-процесса#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Process_Def|ид бизнес-процесса|true|string|
|QueryParameter|nLimitCountRowDeleted|лимит количества заявок для удаления|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== GetTaskFormData
----
GET /action/task/getTaskFormData
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: описания нет #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Task|номер-ИД задачи|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

====  Центральный сервис получения контента файла
----
GET /action/task/getMessageFile_Local
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Message|номер-ИД сообщения|true|string|
|QueryParameter|nID_Process|номер-ИД процесса|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Вызов сервиса ответа по полям требующим уточнения
----
GET /action/task/setTaskAnswer
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Вызов сервиса ответа по полям требующим уточнения #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/setTaskAnswer?nID_Protected=nID_Protected&saField=saField&sToken=sToken&sBody=sBody


- обновляет поля формы указанного процесса значениями, переданными в параметре saField Важно:позволяет обновлять только те поля, для которых в форме бизнес процесса не стоит атрибут writable="false"

Во время выполнения метод выполняет такие действия:

- Находит в сущности HistoryEvent_Service нужную запись (по nID_Protected) и сверяет токен. Eсли токен в сущности указан но не совпадает с переданным, возвращается ошибка "Token wrong". Если он в сущности не указан (null) - возвращается ошибка "Token absent".
- Находит на региональном портале таску и устанавливает в глобальную переменную sAnswer найденной таски содержимое sBody.
- Устанавливает в каждое из полей из saField новые значения
- Обновляет в сущности HistoryEvent_Service поле soData значением из saField и поле sToken значением null.
- Сохраняет информацию о действии в Мой Журнал (Текст: На заявку №____ дан ответ гражданином: [sBody])

Примеры:

https://test.region.igov.org.ua/wf/service/action/task/setTaskAnswer?nID_Protected=54352839&saField=[{%27id%27:%27bankIdinn%27,%27type%27:%27string%27,%27value%27:%271234567890%27}]&sToken=93ODp4uPBb5To4Nn3kY1

Ответы: Пустой ответ в случае успешного обновления

Токен отсутствует


```json
{"code":"BUSINESS_ERR","message":"Token is absent"}


```
Токен не совпадает со значением в HistoryEvent_Service

```json
{"code":"BUSINESS_ERR","message":"Token is absent"}


```
Попытка обновить поле с атрибутом writable="false"

```json
{"code":"BUSINESS_ERR","message":"form property 'bankIdinn' is not writable"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|true|integer (int64)|
|QueryParameter|saField|saField - строка-массива полей|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /getAnswer_DFS_New
----
GET /action/task/getAnswer_DFS_New
----

===== Description
:hardbreaks:
##### Получение ответов по процессам ДФС#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|INN|ИНН|true|string|
|QueryParameter|snCountYear|Порядковый номер документа в году|true|string|
|QueryParameter|sID_Process|ИНН|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getBP
----
GET /action/task/getBP
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|строка-ID БП|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение сообщений по заявке
----
GET /action/task/getOrderMessages_Local
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== Загрузка данных по задачам
----
GET /action/task/downloadTasksData
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Загрузка данных по задачам #####

HTTP Context: https://server:port/wf/service/action/task/downloadTasksData


Загрузка полей по задачам в виде файла.

Поля по умолчанию, которые всегда включены в выборку:
- nID_Task - "id таски"
- sDateCreate - "дата создания таски" (в формате sDateCreateFormat)

Особенности обработки полей:
- Если тип поля enum, то брать не его ИД пункта в энуме а именно значение Если тип поля enum, и в значении присутствует знак ";", то брать только то ту часть текста, которая находится справа от этого знака

Пример: https://test.region.igov.org.ua/wf/service/action/task/downloadTasksData?&sID_BP=dnepr_spravka_o_doxodax&sID_State_BP=usertask1&sDateAt=2015-06-01&sDateTo=2015-08-01&saFields=${nID_Task};${sDateCreate};${area};;;0;${bankIdlastName} ${bankIdfirstName} ${bankIdmiddleName};4;${aim};${date_start};${date_stop};${place_living};${bankIdPassport};1;${phone};${email}&sID_Codepage=win1251&nASCI_Spliter=18&sDateCreateFormat=dd.mm.yyyy hh:MM:ss&sFileName=dohody.dat

Пример ответа:

```
1410042;16.32.2015 10:07:17;АНД (пров. Універсальний, 12);;;0;БІЛЯВЦЕВ ВОЛОДИМИР ВОЛОДИМИРОВИЧ;4;мета;16/07/2015;17/07/2015;мокешрмшгкеу;АЕ432204 БАБУШКИНСКИМ РО ДГУ УМВД 26.09.1996;1;380102030405;mendeleev.ua@gmail.com
995161;07.07.2015 05:07:27;;;;0;ДУБІЛЕТ ДМИТРО ОЛЕКСАНДРОВИЧ;4;для роботи;01/07/2015;07/07/2015;Дніпропетровська, Дніпропетровськ, вул. Донецьке шосе, 15/110;АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЙНИ В ДНИПРОПЕТРОВСЬКИЙ ОБЛАСТИ 18.03.2002;1;;ukr_rybak@rambler.ru

```
Формат поля saFieldsCalc - смотри сервис https://github.com/e-government-ua/i/blob/test/docs/specification.md#16-Получение-статистики-по-задачам-в-рамках-бизнес-процесса и параметр saFields
Пример запроса: https://test.region.igov.org.ua/wf/service/action/task/downloadTasksData?&sID_BP=dnepr_spravka_o_doxodax&bHeader=true&sID_State_BP=usertask1&sDateAt=2015-06-01&sDateTo=2015-10-01&saFieldsCalc=%22nCount=(sID_UserTask==%27usertask1%27?1:0);nTest=(sAssignedLogin==%27kermit%27?1:0)%22

Пример ответа (фрагмент):

```
;380970044803;ДМИТРО;;ОЛЕКСАНДРОВИЧ;;dd.MM.yyyy;Днепропетровск;;;3119325858;АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002;0463;dd.MM.yyyy;;тест;;ДУБІЛЕТ;vidokgulich@gmail.com;1.0;1.0

```
Формат поля saFieldSummary - смотри сервис https://github.com/e-government-ua/i/blob/test/docs/specification.md#16-Получение-статистики-по-задачам-в-рамках-бизнес-процесса и параметр saFieldSummary
Пример запроса: https://test.region.igov.org.ua/wf/service/action/task/downloadTasksData?&sID_BP=dnepr_spravka_o_doxodax&bHeader=true&sID_State_BP=usertask1&sDateAt=2015-06-01&sDateTo=2015-10-01&saFieldSummary=email;nVisites=count()

Пример ответа:

```
vidokgulich@gmail.com;2
kermit;1
rostislav.siryk@gmail.com;4
rostislav.siryk+igov.org.ua@gmail.com;3

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|название бизнес-процесса|true|string|
|QueryParameter|sID_State_BP|состояние задачи, по умолчанию исключается из фильтра Берется из поля taskDefinitionKey задачи|false|string|
|QueryParameter|saFields|имена полей для выборкы разделенных через ';', чтобы добавить все поля можно использовать - '*' или не передевать параметр в запросе. Поле также может содержать названия колонок. Например, saFields=Passport\=${passport};{email}|false|string|
|QueryParameter|nASCI_Spliter|ASCII код для разделителя|false|string|
|QueryParameter|sFileName|имя исходящего файла, по умолчанию - data_BP-bpName_.txt"|false|string|
|QueryParameter|sID_Codepage|кодировка исходящего файла, по умолчанию - win1251|false|string|
|QueryParameter|sDateCreateFormat|форматирование даты создания таски, по умолчанию - yyyy-MM-dd HH:mm:ss|false|string|
|QueryParameter|sDateAt|начальная дата создания таски, по умолчанию - вчера|false|string (date-time)|
|QueryParameter|sDateTo|конечная дата создания таски, по умолчанию - сегодня|false|string (date-time)|
|QueryParameter|nRowStart|начало выборки для пейджирования, по умолчанию - 0|false|integer (int32)|
|QueryParameter|nRowsMax|размер выборки для пейджирования, по умолчанию - 1000|false|integer (int32)|
|QueryParameter|bIncludeHistory|включить информацию по хисторик задачам, по умолчанию - true|false|boolean|
|QueryParameter|bHeader|добавить заголовок с названиями полей в выходной файл, по умолчанию - false|false|boolean|
|QueryParameter|saFieldsCalc|настраиваемые поля (название поля -- формула, issue 907|false|string|
|QueryParameter|saFieldSummary|сведение полей, которое производится над выборкой (issue 916)|false|string|
|QueryParameter|sMailTo|Email для отправки выбранных данных|false|string|
|QueryParameter|sLogin|логин для вытаскивания фильтра|false|string|
|QueryParameter|asField_Filter|признак для получения фильтра|false|string|
|QueryParameter|sTaskEndDateAt|начальная дата закрытия таски|false|string (date-time)|
|QueryParameter|sTaskEndDateTo|конечная дата закрытия таски|false|string (date-time)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Загрузка задач из Activiti
----
GET /action/task/login/{assignee}
----

===== Description
:hardbreaks:
#####  Request:
https://test.region.igov.org.ua/wf/service/action/task/kermit

Response:

```json
    [
      {
            "delegationState": "RESOLVED",
            "id": "38",
            "name": "Первый процесс пользователя kermit",
            "description": "Описание процесса",
            "priority": 51,
            "owner": "kermit-owner",
            "assignee": "kermit-assignee",
            "processInstanceId": "12",
            "executionId": "1",
            "createTime": "2015-04-13 00:51:34.527",
            "taskDefinitionKey": "task-definition",
            "dueDate": "2015-04-13 00:51:36.527",
            "category": "my-category",
            "parentTaskId": "2",
            "tenantId": "diver",
            "formKey": "form-key-12",
            "suspended": true,
            "processDefinitionId": "21"
      }
    ]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|PathParameter|assignee|ИД авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<TaskAssigneeI>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Загрузка каталога сервисов из Activiti
----
GET /action/task/process-definitions
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Загрузка каталога сервисов из Activiti #####

Request:

https://test.region.igov.org.ua/wf/service/action/task/process-definitions

Response:


```json
  [
    {
      "id": "CivilCardAccountlRequest:1:9",
      "category": "http://www.activiti.org/test",
      "name": "Видача картки обліку об’єкта торговельного призначення",
      "key": "CivilCardAccountlRequest",
      "description": "Описание процесса",
      "version": 1,
      "resourceName": "dnepr-2.bpmn",
      "deploymentId": "1",
      "diagramResourceName": "dnepr-2.CivilCardAccountlRequest.png",
      "tenantId": "diver",
      "suspended": true
    }
  ]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcDefinitionI>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== removeListBP
----
GET /action/task/removeListBP
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|строка-ИД БП //опциональный фильтр, иначе все|false|string|
|QueryParameter|sFieldType|строка-типа поля //опциональный фильтр, иначе все|false|string|
|QueryParameter|sID_Field|строка-ИД поля //опциональный фильтр, иначе все|false|string|
|QueryParameter|sVersion|строка-версия БП //опциональный фильтр, иначе все|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getListBP
----
GET /action/task/getListBP
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP|строка-ИД БП //опциональный фильтр, иначе все|false|string|
|QueryParameter|sFieldType|строка-типа поля //опциональный фильтр, иначе все|false|string|
|QueryParameter|sID_Field|строка-ИД поля //опциональный фильтр, иначе все|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcDefinitionI>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== DeleteProcess
----
DELETE /action/task/delete-process
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: описания нет #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Order|nID_Order|true|integer (int64)|
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sReason|sReason|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка ID пользовательских тасок по номеру заявки
----
GET /action/task/getTasksByOrder
----

===== Description
:hardbreaks:
##### Примеры:
https://test.region.igov.org.ua/wf/service/action/task/getTasksByOrder?nID_Order=123452

Response status 403.


```json
{"code":"BUSINESS_ERR","message":"CRC Error"}


```
https://test.region.igov.org.ua/wf/service/action/task/getTasksByOrder?nID_Order=123451

1) Если процесса с ID 12345 и тасками нет в базе то:

Response status 403.


```json
{"code":"BUSINESS_ERR","message":"Record not found"}


```
2) Если процесс с ID 12345 есть в базе с таской ID которой 555, то:

Response status 200.

```json
[ 555 ]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Order| число номер заявки, в котором, все цифры кроме последней - ID процесса в activiti. А последняя цифра - его контрольная сумма зашифрованная по алгоритму Луна.|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Успех запроса. Если процесс с соответствующим ИД и таской найдены в базе|string array
|401|Unauthorized|No Content
|403|CRC Error или Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получения обьекта-записи линка
----
GET /action/task/getLink
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Сервис получения обьекта-записи линка #####

Request:

https://alpha.test.igov.org.ua/wf/service/action/task/getLink?sKey=sKey&nID_Subject_Holder=nID_Subject_Holder


Response:

```json
  {"sKey":"Cтрока-ключ",       "nID":ИД обьекта,       "nID_Process":ИД бизнес процесса,       "nID_Subject_Holder":ИД субьекта-хранителя    }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД бизнес процесса|false|integer (int64)|
|QueryParameter|sKey|Cтрока-ключ|true|string|
|QueryParameter|nID_Subject_Holder|ИД субьекта-хранителя|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ActionTaskLink>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Вызов сервиса уточнения полей формы
----
POST /action/task/setTaskQuestions
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Вызов сервиса уточнения полей формы #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/setTaskQuestions?nID_Protected=nID_Protected&saField=saField&sMail=sMail


сервис запроса полей, требующих уточнения у гражданина, с отсылкой уведомления параметры:


при вызове сервиса:

- обновляется запись HistoryEvent_Service полем значениями из soData (из saField), sToken (сгенерированый случайно 20-ти символьный код), sHead, sBody (т.е. на этоп этапе могут быть ошибки, связанные с нахождением и апдейтом обьекта события по услуге)
- отсылается письмо гражданину на указанный емейл (sMail):
  с заголовком sHead,
  телом sBody
  перечисление полей из saField в формате таблицы: Поле / Тип / Текущее значение
  гиперссылкой в конце типа: https://[hostCentral]/order?nID_Protected=[nID_Protected]&sToken=[sToken]
- находитcя на региональном портале таска, которой устанавливается в глобальную переменные sQuestion содержимое sBody и saFieldQuestion - содержимое saField
- сохраняется информация о действии в Моем Журнале в виде
  По заявці №____ задане прохання уточнення: [sBody]
  плюс перечисление полей из saField в формате таблицы Поле / Тип / Текущее значение
- Пример: https://test.region.igov.org.ua/wf/service/action/task/setTaskQuestions?nID_Protected=52302969&saField=[{'id':'bankIdfirstName','type':'string','value':'3119325858'}]&sMail=test@email

Ответы: Пустой ответ в случае успешного обновления (и приход на указанный емейл письма описанного выше формата)

Возможные ошибки:

- не найдена заявка (Record not found) или ид заявки неверное (CRC Error)
- связанные с отсылкой письма, например, невалидный емейл (Error happened when sending email)
- из-за некорректных входящих данных, например неверный формат saField (пример ошибки: Expected a ',' or ']' at 72 [character 73 line 1])

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|true|integer (int64)|
|QueryParameter|sMail|строка электронного адреса гражданина|true|string|
|QueryParameter|sHead|строка заголовка письма|false|string|
|QueryParameter|sSubjectInfo|строка информация о субьекте|false|string|
|QueryParameter|nID_Subject|номер - ИД субьекта|false|integer (int64)|
|BodyParameter|sJsonBody|JSON-щбъект с параметрами: saField - строка-массива полей (required = true); soParams - строка-обьекта параметров (required = true); sBody - строка тела сообщения-коммента (общего) (required = false)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение статистики по задачам в рамках бизнес процесса
----
GET /action/task/download_bp_timing
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение статистики по задачам в рамках бизнес процесса #####

HTTP Context: https://server:port/wf/service/action/task/download_bp_timing?sID_BP_Name=XXX&sDateAt=XXX8&sDateTo=XXX


Метод возвращает .csv файл со информацией о завершенных задачах в указанном бизнес процессе за период. Если указан параметр saFieldSummary -- то также будет выполнено "сведение" полей (описано ниже). Если не указан, то формат выходного файла:

- nID_Process - ид задачи
- sLoginAssignee - кто выполнял задачу
- sDateTimeStart - Дата и время начала
- nDurationMS - Длительность выполнения задачи в миллисекундах
- nDurationHour - Длительность выполнения задачи в часах
- sName - Название задачи

Поля из FormProperty (если bDetail=true)
настраиваемые поля из saFields
Пример: https://test.region.igov.org.ua/wf/service/action/task/download_bp_timing?sID_BP_Name=lviv_mvk-1&sDateAt=2015-06-28&sDateTo=2015-07-01

Пример выходного файла

```
"Assignee","Start Time","Duration in millis","Duration in hours","Name of Task"
"kermit","2015-06-21:09-20-40","711231882","197","Підготовка відповіді на запит: пошук документа"

```
Сведение полей
параметр saFieldSummary может содержать примерно такое значение: "sRegion;nSum=sum(nMinutes);nVisites=count()"
тот элемент, который задан первым в параметре saFieldSummary - является "ключевым полем" следующие элементы состоят из названия для колонки, агрегирующей функции и названия агрегируемого поля. Например: "nSum=sum(nMinutes)"

где:

- nSum - название поля, куда будет попадать результат
- sum - оператор сведения
- nMinutes - расчетное поле переменная, которая хранит в себе значение уже существующего или посчитанного поля формируемой таблицы

Перечень поддерживаемых "операторов сведения":

- count() - число строк/элементов (не содержит аргументов)
- sum(field) - сумма чисел (содержит аргумент - название обрабатываемого поля)
- avg(field) - среднее число (содержит аргумент - название обрабатываемого поля)

Операторы можно указывать в произвольном регистре, т.е. SUM, sum и SuM "распознаются" как оператор суммы sum. 
Для среднего числа также предусмотрено альтернативное название "average".
Если в скобках не указано поле, то берется ключевое.

Значение "ключевого поля" переносится в новую таблицу без изменений в виде единой строки,и все остальные сводные поля подсчитываются исключительно в контексте
значения этого ключевого поля, и проставляютя соседними полями в рамках этой единой строки.

Особенности подсчета:

- если нету исходных данных или нету такого ключевого поля, то ничего не считается (в исходном файле просто будут заголовки)
- если расчетного поля нету, то поле не считается (т.е. сумма и количество для ключевого не меняется)
тип поля Сумма и Среднее -- дробное число, Количество -- целое. Исходя из этого при подсчете суммы значение конвертируется в число, если конвертация неудачна, то сумма не меняется. (т.е. если расчетное поле чисто текстовое, то сумма и среднее будет 0.0)

Пример: https://test.region.igov.org.ua/wf/service/action/task/download_bp_timing?sID_BP_Name=_test_queue_cancel&sDateAt=2015-04-01&sDateTo=2015-10-31&saFieldSummary=email;nSum=sum(nDurationHour);nVisites=count();nAvg=avg(nDurationHour)

Ответ:

```
"email","nSum","nVisites","nAvg"
"email1","362.0","5","72.4"
"email2","0.0","1","0.0"


```
Настраиваемые поля
Параметр saFields может содержать набор полей с выражениями, разделенными символом ; 
Вычисленное выражение, расчитанное на основании значений текущей задачи, подставляется в выходной файл 

Пример выражения 
saFields="nCount=(sID_UserTask=='usertask1'?1:0);nTest=(sAssignedLogin=='kermit'?1:0)" 
где:

- nCount, nTest - названия колонок в выходном файле
- sID_UserTask, sAssignedLogin - ID таски в бизнес процессе и пользователь, на которого заассайнена таска, соответственно

Пример: https://test.region.igov.org.ua/wf/service/action/task/download_bp_timing?sID_BP_Name=_test_queue_cancel&sDateAt=2015-04-01&sDateTo=2015-10-31&saFields="nCount=(sID_UserTask=='usertask1'?1:0);nTest=(sAssignedLogin=='kermit'?1:0)"

Результат:

```
"nID_Process","sLoginAssignee","sDateTimeStart","nDurationMS","nDurationHour","sName","bankIdPassport","bankIdfirstName","bankIdlastName","bankIdmiddleName","biometrical","date_of_visit","date_of_visit1","email","finish","have_passport","initiator","phone","urgent","visitDate","nCount","nTest"
"5207501","kermit","2015-09-25:12-18-28","1433990","0","обробка дмс","АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002","ДМИТРО","ДУБІЛЕТ","ОЛЕКСАНДРОВИЧ","attr1_no","2015-10-09 09:00:00.00","dd.MM.yyyy HH:MI","nazarenkod1990@gmail.com","attr1_ok","attr1_yes","","38","attr1_no","{""nID_FlowSlotTicket"":27764,""sDate"":""2015-10-09 09:00:00.00""}","0.0","1.0"
"5215001","kermit","2015-09-25:13-03-29","75259","0","обробка дмс","АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002","ДМИТРО","ДУБІЛЕТ","ОЛЕКСАНДРОВИЧ","attr1_no","2015-10-14 11:15:00.00","dd.MM.yyyy HH:MI","nazarenkod1990@gmail.com","attr1_ok","attr1_yes","","38","attr1_no","{""nID_FlowSlotTicket"":27767,""sDate"":""2015-10-14 11:15:00.00""}","0.0","1.0"
"5215055","dn200986zda","2015-09-25:13-05-22","1565056","0","обробка дмс","АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002","ДМИТРО","ДУБІЛЕТ","ОЛЕКСАНДРОВИЧ","attr1_no","2015-09-28 08:15:00.00","dd.MM.yyyy HH:MI","dmitrij.zabrudskij@privatbank.ua","attr2_missed","attr1_yes","","38","attr1_no","{""nID_FlowSlotTicket"":27768,""sDate"":""2015-09-28 08:15:00.00""}","0.0","0.0"

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_BP_Name|ИД бизнес процесса|true|string|
|QueryParameter|sDateAt|дата начала периода выборки|false|string (date-time)|
|QueryParameter|sDateTo|дата окончания периода выборки|false|string (date-time)|
|QueryParameter|nRowStart|позиция начальной строки для возврата (0 по умолчанию)|false|integer (int32)|
|QueryParameter|nRowsMax|количество записей для возврата (1000 по умолчанию)|false|integer (int32)|
|QueryParameter|bDetail|если да, то выгружать все поля тасок, иначе -- только основные (по умолчанию да)|false|boolean|
|QueryParameter|saFieldSummary|сведение полей, которое производится над выборкой|false|string|
|QueryParameter|saFields|вычисляемые поля (название поля -- формула)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/vnd.ms-excel

==== Получение списка полей бизнес процессов, к которым у пользователя есть доступ
----
GET /action/task/getFields
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Получение списка полей бизнес процессов к которым у пользователя есть доступ #####

HTTP Context: https://test.region.igov.org.ua/wf/service/action/task/getFields?sLogin=userId

Метод возвращает json со списком полей бизнес процессов, к которым у пользователя есть доступ, в формате:

```json
[
  {
    "sID": "ID field value", "sName": "[name of the field]", "sID_Type": "[type of the field]"
  },
  {
    "sID": "ID field value", "sName": "[name of the field]", "sID_Type": "[type of the field]"
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин пользователя|true|string|
|QueryParameter|bDocOnly|Выводить только список БП документов|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,string»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== saveForm
----
POST /action/task/saveForm
----

===== Description
:hardbreaks:
saveForm

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|sParams|проперти формы|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<HttpServletRequest>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== SendProccessToGRES
----
GET /action/task/sendProccessToGRES
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: описания нет #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Task|номер-ИД задачи|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== setBP
----
POST /action/task/setBP
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFileName|Cтрока-название файла|true|string|
|FormDataParameter|file|Новий БП|false|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

==== Удаление назначенного пользователя с задачи по ИД.
----
POST /action/task/resetUserTaskAssign
----

===== Description
:hardbreaks:
#####  Request:
https://test.region.igov.org.ua/wf/service/action/task/resetUserTaskAssign

- nID_UserTask=24
Response if task assigned: HTTP STATUS 200


```json
{}

```
Response if task is not assigned: HTTP STATUS 200


```json
{"Not assigned UserTask"}


```
Response if task not found: HTTP STATUS 403 Forbidden


```json
{
"code": "BUSINESS_ERR"
"message": "Record not found"
}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_UserTask|номер-ИД юзертаски|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|Таска занята или же нет|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Запись о таске не найдена|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /getAnswer_DFS
----
GET /action/task/getAnswer_DFS
----

===== Description
:hardbreaks:
##### Получение ответов по процессам ДФС#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|INN|ИНН|true|string|
|QueryParameter|snCountYear|Порядковый номер документа в году|true|string|
|QueryParameter|sID_Process|ИНН|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /getProcessTemplate
----
GET /action/task/getProcessTemplate
----

===== Description
:hardbreaks:
##### Получение шаблона процесса#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sID_BP|sID_BP|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=utf-8

==== mergeVariableValueOnProcessInstance
----
GET /action/task/mergeVariable
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|processInstanceId|processInstanceId|true|string|
|QueryParameter|key|key|true|string|
|QueryParameter|removeValues|removeValues|false|multi string array|
|QueryParameter|insertValues|insertValues|false|multi string array|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== DeleteProcess
----
DELETE /action/task/delete-process-simple
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: описания нет #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|nID_Process|true|string|
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sReason|sReason|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Отмена задачи (в т.ч. электронной очереди)
----
GET /action/task/cancelTask
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Order|номер-ИД процесса (с контрольной суммой)|true|integer (int64)|
|QueryParameter|sInfo|Строка с информацией (причиной отмены)|false|string|
|QueryParameter|bSimple|Простой вариант отмены (без электронной очереди)|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== Отмена задачи (в т.ч. электронной очереди)
----
POST /action/task/cancelTask
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Order|номер-ИД процесса (с контрольной суммой)|true|integer (int64)|
|QueryParameter|sInfo|Строка с информацией (причиной отмены)|false|string|
|QueryParameter|bSimple|Простой вариант отмены (без электронной очереди)|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== /getDocumentStepLogins
----
GET /action/task/getDocumentStepLogins
----

===== Description
:hardbreaks:
##### Получение списка прав у логина по документу#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|nID_Process|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,object»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обновление переменных задачи с ее опциональным завершением
----
POST /action/task/updateProcess
----

===== Description
:hardbreaks:
#####  ActionCommonTaskController: Обновление переменных задачи с ее опциональным завершением #####

HTTP Context: https://alpha.test.region.igov.org.ua/wf/service/action/task/updateProcess

POST Метод. Принимает параметр bSaveOnly. Если bSaveOnly=true - Только обновление переменных задачи. Если false - заверешение задачи после обновления переменных:
Метод принимает json в теле запроса со списком переменных для обновления и номером задачи:

```json
{
  "taskId" : "5",
  "properties" : [
  {
  "id" : "room",
  "value" : "normal"
  }
  ]
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|bSaveOnly|bSaveOnly|false|boolean|
|BodyParameter|sJsonBody|JSON-щбъект с заполненными полями заполненной стартформы|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=utf-8

==== /setDocument
----
GET /action/task/setDocument
----

===== Description
:hardbreaks:
##### Создание документа (позже будет заменен на универсальній сервис /setProcess)#####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|sLogin|true|string|
|QueryParameter|sID_BP|sID_BP|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение полей стартовой формы по ID таски
----
GET /action/task/getStartFormData
----

===== Description
:hardbreaks:
##### Примеры:
http://test.region.igov.org.ua/wf/service/action/task/getStartFormData?nID_Task=5170256
Ответ, если запись существует (HTTP status Code: 200 OK):

```json
{
  waterback="--------------------",
  phone="380979362996",
  date_from="01/01/2014",
  bankIdbirthDay="27.05.1985",
  notice2="Я та особи, які зареєстровані (фактично проживають) у житловому приміщенні/будинку, даємо згоду на обробку персональних даних про сім’ю, доходи, майно, що необхідні для призначення житлової субсидії, та оприлюднення відомостей щодо її призначення.",
house="--------------------",
  garbage="--------------------",
  waterback_notice="",
  garbage_number="",
  floors="10",
  name_services="--------------------",
  date_to="30/12/2014",
  date3="",
  date2="",
  electricity="--------------------",
  garbage_name="",
  date1="",
  place_type="2",
  bankIdfirstName="ДМИТРО",
  declaration="--------------------",
  waterback_name="",
  electricity_notice="",
  bankIdinn="3119325858",
  house_name="",
  gas="--------------------",
  house_number="",
  subsidy="1",
  email="dmitrij.zabrudskij@privatbank.ua",
  warming="--------------------",
  hotwater_notice="",
  org0="Назва організації",
  org1="",
  electricity_number="123456",
  org2="",
  org3="",
  warming_name="",
  place_of_living="Дніпропетровська, Дніпропетровськ, пр. Героїв, 17, кв 120",
  fio2="",
  fio3="",
  total_place="68",
  garbage_notice="",
  fio1="",
  chapter1="--------------------",
  bankIdmiddleName="ОЛЕКСАНДРОВИЧ",
  gas_name="",
  bankIdPassport="АМ765369 ЖОВТНЕВИМ РВ ДМУ УМВС УКРАЇНИ В ДНІПРОПЕТРОВСЬКІЙ ОБЛАСТІ 18.03.2002",
  warming_place="45",
  passport3="",
  gas_number="",
  passport2="",
  electricity_name="коммуна",
  area="samar",
  house_notice="",
  bankIdlastName="ДУБІЛЕТ",
  card1="",
  card3="",
  coolwater_number="",
  card2="",
  warming_notice="",
  hotwater_name="",
  income0="attr9",
  coolwater="--------------------",
  gas_notice="",
  overload="hxhxfhfxhfghg",
  warming_number="",
  income3="attr0",
  income1="attr0",
  income2="attr0",
  passport1="",
  coolwater_notice="",
  sBody_1="null",
  hotwater="--------------------",
  coolwater_name="",
  waterback_number="",
  man1="",
  hotwater_number="",
  sBody_2="null",
  comment="null",
  decision="null",
  selection="attr1"
}

```
Ответ, если записи не существует. (HTTP status Code: 500 Internal Server Error):


```json
{
  "code": "BUSINESS_ERR",
  "message": "Record not found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Task| номер-ИД таски, для которой нужно найти процесс и вернуть поля его стартовой формы.|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|500|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== setVariableToProcessInstance
----
GET /action/task/setVariable
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|processInstanceId|processInstanceId|true|string|
|QueryParameter|key|key|true|string|
|QueryParameter|value|value|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== setVariableToProcessInstanceUsingPost
----
POST /action/task/setVariable
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|allRequestParamsStr|allRequestParamsStr|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* text/plain

===== Produces

* */*

=== DebugCentralController -- Дебаг И Тест Центральный
:hardbreaks:
Debug Central Controller

====  Возвращает содержимое отсылаемого сообщения, если такое существует.
----
GET /test/getSubjectMessageDataTesting
----

===== Description
:hardbreaks:
Возвращает содержимое отсылаемого сообщения, если такое существует.:
Если не найдена запись SubjectMessage по ID или у найденного сообщения пустое поле, указывающее на контект сообщения, то метод возвращает ошибку с текстом сообщения "Record not found"
Пример:
https://test.igov.org.ua/wf/service/subject/message/getSubjectMessageData?nID_SubjectMessage=111111

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectMessage|номер-ИД записи с сообщением|false|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта (хозяина заявки сообщения)|false|integer (int64)|
|QueryParameter|bAuth|булевский флаг, Включить авторизацию|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getEventInfoByOrderID
----
GET /action/event/getEventInfoForTestingByOrderID
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|sID_Order|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== sendSMS
----
GET /test/sendsms
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|phone|phone|false|string|
|QueryParameter|text|text|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== Перенос данных из поля sMail в поле nID_SubjectContact_Mail таблицы SubjectMessage
----
GET /subject/message/transferDataFromMail
----

===== Description
:hardbreaks:
Возвращает список из 100 первых измененных записей таблицы.  Метод также подчищает данные из sMail, устанавливая занчение null

Пример ответа:

```json
[
 {
  "mail":"test@igov.org.ua",
  "oMail":{"subjectContactType":{"sName_EN":"Email","sName_UA":"Електрона адреса","sName_RU":"Электнонный адрес","nID":1},"sValue":"test@igov.org.ua","sDate":null,"nID":1},
  "sBody_Indirectly":"Body Inderectly",
  "nID_HistoryEvent_Service":3,
  "nID":1,
  "sHead":"head",
  "sBody":"body of subject message",
  "sDate":"2015-12-21 14:09:56.235",
  "nID_Subject":1,
  "sContacts":"contact",
  "sData":"data",
  "oSubjectMessageType":{"sDescription":"Оценка услуги","nID":1,"sName":"ServiceRate"}
 },
 {
  "mail":"test@igov.org.ua",
  "oMail":{"subjectContactType":{"sName_EN":"Email","sName_UA":"Електрона адреса","sName_RU":"Электнонный адрес","nID":1},"sValue":"test@igov.org.ua","sDate":null,"nID":1},
  "sBody_Indirectly":"Body Inderectly",
  "nID_HistoryEvent_Service":4,
  "nID":2,
  "sHead":"head2",
  "sBody":"",
  "sDate":"2015-12-21 14:09:56.235",
  "nID_Subject":1,
  "sContacts":"contact",
  "sData":"data",
  "oSubjectMessageType":{"sDescription":"Оценка услуги","nID":1,"sName":"ServiceRate"}
 }
]

```


Данные из поля sMail таблицы SubjectMessage переносятся в поле nID_SubjectMessage_Mail (объект oMail).
Значения в поле sMail устанавливаются в null
Если происходит исключение во время переноса данных, возвращается 403.


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|В случае успеха возвращает список первых 100 записей измененных с сущностями SubjectMessage|object array
|401|Unauthorized|No Content
|403|В случае появления исключения обработки sql-запросов|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Установка сообщения-оценки
----
GET /messages/setMessageRate
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Rate|Строка-ИД рейтинга/оценки (число от 1 до 5)|true|string|
|QueryParameter|nID_Protected|Номер-ИД заявки, защищенный по алгоритму Луна, опционально(для обратной совместимости)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить системное событие
----
GET /action/event/setEventSystem
----

===== Description
:hardbreaks:
Необходим для сбора логов из разных источников, например с криентского приложения

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sType|строка-тип|false|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта|false|integer (int64)|
|QueryParameter|nID_Server|Номер-ИД сервера|false|integer (int64)|
|QueryParameter|sFunction|строка-функция|false|string|
|QueryParameter|sHead|строка-заголовок|false|string|
|QueryParameter|sBody|строка-тело|false|string|
|QueryParameter|sError|строка-ошибка|false|string|
|BodyParameter|smData|Карта других параметров|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить системное событие
----
POST /action/event/setEventSystem
----

===== Description
:hardbreaks:
Необходим для сбора логов из разных источников, например с криентского приложения

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sType|строка-тип|false|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта|false|integer (int64)|
|QueryParameter|nID_Server|Номер-ИД сервера|false|integer (int64)|
|QueryParameter|sFunction|строка-функция|false|string|
|QueryParameter|sHead|строка-заголовок|false|string|
|QueryParameter|sBody|строка-тело|false|string|
|QueryParameter|sError|строка-ошибка|false|string|
|BodyParameter|smData|Карта других параметров|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== DebugCommonController - Дебаг И Тест Общий
:hardbreaks:
Debug Common Controller

==== /test/action/task/delete-processTest
----
GET /test/action/task/delete-processTest
----

===== Description
:hardbreaks:
#####  DebugCommonController: описания нет


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sProcessInstanceID|sProcessInstanceID|true|string|
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sReason|sReason|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /test/sendAttachmentsByMail
----
GET /test/sendAttachmentsByMail
----

===== Description
:hardbreaks:
#####  DebugCommonController: описания нет


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sMailTo|sMailTo|false|string|
|QueryParameter|nID_Task|nID_Task|false|string|
|QueryParameter|sBody|sBody|false|string|
|QueryParameter|bHTML|bHTML|false|boolean|
|QueryParameter|naID_Attachment|naID_Attachment|false|string|
|QueryParameter|bUnisender|bUnisender|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /rest/tasks/cancelTask
----
POST /rest/tasks/cancelTask
----

===== Description
:hardbreaks:
#####  DebugCommonController:


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Protected|nID_Protected|true|integer (int64)|
|QueryParameter|sInfo|sInfo|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== /test/action/getInfo
----
GET /test/action/getInfo
----

===== Description
:hardbreaks:
#####  DebugCommonController: 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_TestType|sID_TestType|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== /test/action/loadPayments
----
GET /test/action/loadPayments
----

===== Description
:hardbreaks:
#####  DebugCommonController: 


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /test/action/testSheduleBuilderFlowSlots
----
GET /test/action/testSheduleBuilderFlowSlots
----

===== Description
:hardbreaks:
#####  DebugCommonController: описания нет


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Flow_ServiceData|nID_Flow_ServiceData|false|integer (int64)|
|QueryParameter|nID_ServiceData|nID_ServiceData|false|integer (int64)|
|QueryParameter|sDateStart|sDateStart|false|string|
|QueryParameter|sDateStop|sDateStop|false|string|
|QueryParameter|bAll|bAll|false|boolean|
|QueryParameter|nDays|nDays|false|integer (int32)|
|QueryParameter|sOperation|sOperation|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== DocumentAccessController -- Доступы К Документам
:hardbreaks:
Document Access Controller

==== запись на доступ, с генерацией и получением уникальной ссылки на него
----
GET /document/access/setDocumentLink
----

===== Description
:hardbreaks:
Response

```json
[  //[0..N]
  {"name":"sURL",   //[1..1]
    "value":"https://e-gov.org.ua/index#nID_Access=4345&sSecret=JHg3987JHg3987JHg3987" //[1..1]
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Document|ИД-номер документа|true|integer (int64)|
|QueryParameter|sFIO|строка ФИО, кому доступ|false|string|
|QueryParameter|sTarget|строка цель получения доступа|false|string|
|QueryParameter|sTelephone|строка телефон того, кому доступ предоставляется|false|string|
|QueryParameter|nMS|число милисекунд, на которое предоставляется доступ|true|integer (int64)|
|QueryParameter|sMail|строка эл. почта того, кому доступ предоставляется|false|string|
|QueryParameter|nID_Subject|ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<AccessURL>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение контента документа по коду доступа,оператору, типу документа и паролю
----
GET /document/access/getDocumentAccessByHandler
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/access/getDocumentAccessByHandler?sCode_DocumentAccess=2&nID_DocumentOperator_SubjectOrgan=2&sPass=123&nID_DocumentType=1

Response КОНТЕНТ ДОКУМЕНТА В ВИДЕ СТРОКИ


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sCode_DocumentAccess|строка-код доступа документа|true|string|
|QueryParameter|nID_DocumentOperator_SubjectOrgan|строка-код органа(оператора)|true|integer (int64)|
|QueryParameter|nID_DocumentType|число-тип документа (опциональный)|false|integer (int64)|
|QueryParameter|sPass|строка-пароль для доступа к документу (опциональный, пока только для документов у которы sCodeType=SMS)|false|string|
|QueryParameter|nID_Subject|номер-ИД субьекта|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Document>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== DocumentCommonController -- Проверки Наложености ЭЦП По Строкам-подписантам
:hardbreaks:
Document Common Controller

==== Отмена сабмиченности и подписанности документа
----
GET /common/document/cancelDocumentSubmit
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|true|string|
|QueryParameter|sKey_Group|группа|true|string|
|QueryParameter|sKey_Step|степ документа|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Удаление подписанта документа
----
GET /common/document/removeDocumentStepSubject
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|true|string|
|QueryParameter|sKey_Group|группа|true|string|
|QueryParameter|sKey_Step|степ документа|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Клонирование подписанта-субьекта документа
----
GET /common/document/cloneDocumentStepSubject
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|false|string|
|QueryParameter|sKeyGroupPostfix|группа|false|string|
|QueryParameter|sKeyGroupPostfix_New|новая группа|false|string|
|QueryParameter|sID_Step|степ документа|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Синхронизация сабмитеров на степе по полю 
----
GET /common/document/syncDocumentSubmitersByField
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|true|string|
|QueryParameter|sKeyGroup_Default|группа - эталон/дэфолтная|true|string|
|QueryParameter|sID_Field|строка-ИД поля, в рамках значения/ний которого(логинов) пройдет синхронизация|true|string|
|QueryParameter|sKey_Step|степ документа|true|string|
|QueryParameter|bReClone|перезаписать при совпадении|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Получение списка подписанных документов без ЕЦП
----
GET /common/document/getDocumentSubmitedUnsigned
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин сотрудника|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<DocumentSubmitedUnsignedVO>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== проверка подписано ли ЕЦП
----
GET /common/document/isDocumentStepSubmitedAll
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД процесс-активити|true|string|
|QueryParameter|sLogin|Логин подписанта|true|string|
|QueryParameter|sKey_Step|Ключ шага документа|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление степов и процесса
----
GET /common/document/removeDocumentSteps
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Делегировать подписанта документа
----
GET /common/document/delegateDocumentStepSubject
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ИД процесс-активити|true|string|
|QueryParameter|sKey_Group|группа|true|string|
|QueryParameter|sKey_Group_Delegate|группа делегирования|true|string|
|QueryParameter|sKey_Step|степ документа|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<DocumentStepSubjectRight>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

=== DocumentController -- Документы И Смежные Сущности
:hardbreaks:
Document Controller

==== Получение документа в виде файла по ид документа
----
GET /document/getDocumentFile
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocumentFile?nID=1
Response ЗАГРУЖЕННЫЙ ФАЙЛ


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер документа|true|integer (int64)|
|QueryParameter|nID_Subject|ID-номер авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка всех "нескрытых" типов документов
----
GET /document/getDocumentTypes
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocumentTypes
Response

```json
[
    {"nID":0,"sName":"Другое", "bHidden":false},
    {"nID":1,"sName":"Справка", "bHidden":false},
    {"nID":2,"sName":"Паспорт", "bHidden":false}
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<DocumentType>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение документа в виде файла
----
GET /document/getDocumentAbstract
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocumentAbstract?sID=150826SV7733A36E803B
Response ЗАГРУЖЕННЫЙ ФАЙЛ


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ID-номер авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя) |false|integer (int64)|
|QueryParameter|sID|строковой ID документа|false|string|
|QueryParameter|nID_DocumentOperator_SubjectOrgan|номер ид -- определяет класс хэндлера который будет обрабатывать запрос|false|integer (int64)|
|QueryParameter|nID_DocumentType|число ид -- определяет тип документа, например 0 - "Квитанція про сплату", 1 - "Довідка про рух по картці (для візових центрів)"|false|integer (int64)|
|QueryParameter|sPass|строка-пароль|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление записи по ее ид
----
GET /document/removeDocumentType
----

===== Description
:hardbreaks:
Если запись с ид=nID не будет найдена, то вернется ошибка 403. Record not found, иначе -- запись удалится.
пример: https://test.igov.org.ua/wf/service/document/removeDocumentType?nID=20314
ответ: 200 ok


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ид-номер записи|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение контента документа по ид документа
----
GET /document/getDocumentContent
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocumentContent?nID=1
Response КОНТЕНТ ДОКУМЕНТА В ВИДЕ СТРОКИ


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер документа|true|integer (int64)|
|QueryParameter|nID_Subject|номер-ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка загруженных субъектом документов
----
GET /document/getDocuments
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocuments?nID_Subject=2
Response

```json
[
  {
    "sDate_Upload":"2015-01-01",
    "sContentType":"text/plain",
    "contentType":"text/plain",
    "nID":1,
    "sName":"Паспорт",
    "oDocumentType":{"nID":0,"sName":"Другое"},
    "sID_Content":"1",
    "oDocumentContentType":{"nID":2,"sName":"text/plain"},
    "sFile":"dd.txt",
    "oDate_Upload":1420063200000,
    "sID_Subject_Upload":"1",
    "sSubjectName_Upload":"ПриватБанк",
    "oSubject_Upload":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк", "sLabelShort":"ПриватБанк"},
     "oSubject":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк","sLabelShort":"ПриватБанк"}
  },
  {
    "sDate_Upload":"2015-01-01",
    "sContentType":"text/plain",
    "contentType":"text/plain",
    "nID":2,
    "sName":"Паспорт",
    "oDocumentType":{"nID":0,"sName":"Другое"},
    "sID_Content":"2",
    "oDocumentContentType":{"nID":2,"sName":"text/plain"},
    "sFile":"dd.txt",
    "oDate_Upload":1420063200000,
    "sID_Subject_Upload":"1",
    "sSubjectName_Upload":"ПриватБанк",
    "oSubject_Upload":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк", "sLabelShort":"ПриватБанк"},
     "oSubject":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк","sLabelShort":"ПриватБанк"}
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ID-номер авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Document>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение документа в виде файла (контент файла шлется в теле запроса)
----
POST /document/setDocumentFile
----

===== Description
:hardbreaks:
Response ИД ДОКУМЕНТА


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ИД-номер субъекта документа (владельца)|false|integer (int64)|
|QueryParameter|sID_Subject_Upload|ИД-строка субъекта, который загрузил документ|true|string|
|QueryParameter|sSubjectName_Upload|sSubjectName_Upload|true|string|
|QueryParameter|sName|строка-название документа|true|string|
|QueryParameter|sFileExtension|строка-расширения файла|false|string|
|QueryParameter|nID_DocumentType|ИД-номер типа документа|true|integer (int64)|
|QueryParameter|nID_DocumentContentType|строка-тип контента документа|false|integer (int64)|
|FormDataParameter|oFile|обьект файла (тип MultipartFile)|false|file|
|FormDataParameter|file|обьект мультипартфайла|false|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

==== Получение документа по ид документа
----
GET /document/getDocument
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocument?nID=1
Response

```json
{
    "sDate_Upload":"2015-01-01",
    "sContentType":"text/plain",
    "contentType":"text/plain",
    "nID":1,
    "sName":"Паспорт",
    "oDocumentType":{"nID":0,"sName":"Другое"},
    "sID_Content":"1",
    "oDocumentContentType":{"nID":2,"sName":"text/plain"},
    "sFile":"dd.txt",
    "oDate_Upload":1420063200000,
    "sID_Subject_Upload":"1",
    "sSubjectName_Upload":"ПриватБанк",
    "oSubject_Upload":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк", "sLabelShort":"ПриватБанк"},
     "oSubject":{"nID":1,"sID":"ПАО","sLabel":"ПАО ПриватБанк","sLabelShort":"ПриватБанк"}
 }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер документа|true|integer (int64)|
|QueryParameter|nID_Subject|ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Document>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение всех операторов(органов) которые имею право доступа к документу
----
GET /document/getDocumentOperators
----

===== Description
:hardbreaks:
Примеры: https://test.igov.org.ua/wf/service/document/getDocumentOperators
Response

```json
[
    {
        "nID_SubjectOrgan": 2,
        "sHandlerClass": "org.igov.service.business.document.access.handler.DocumentAccessHandler_IGov",
        "nID": 1,
        "sName": "iGov"
    }
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<DocumentOperator_SubjectOrgan>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Добавить/изменить запись типа контента документа
----
GET /document/setDocumentContentType
----

===== Description
:hardbreaks:
Если запись с ид=nID не будет найдена, то создастся новая запись (с автогенерируемым nID), иначе -- обновится текущая.

Примеры:

создать новый тип: 
https://test.igov.org.ua/wf/service/document/setDocumentContentType?nID=100&sName=test

ответ:

```json
{"nID":20311,"sName":"test"}

```
изменить (взять ид из предыдущего ответа): 
https://test.igov.org.ua/wf/service/document/setDocumentContentType?nID=20311&sName=test2

ответ:

```json
{"nID":20311,"sName":"test2"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ид-номер записи|true|integer (int64)|
|QueryParameter|sName|строка-название записи|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить все записи в mongo, на ключ которых не ссылается ни одна записьв сущности Document,  не ссылается ни одна запись в Attach-ах тасок Активити, удалить все записи в postgres, по sID_Content которой не найденони одной записи в mongo
----
POST /document/cleanUpInvalidDocuments
----

===== Description
:hardbreaks:
todo

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение списка типов контента документов
----
GET /document/getDocumentContentTypes
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf/service/document/getDocumentContentTypes
Response

```json
[
    {"nID":0,"sName":"application/json"},
    {"nID":1,"sName":"application/xml"},
    {"nID":2,"sName":"text/plain"},
    {"nID":3,"sName":"application/jpg"}
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<DocumentContentType>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение документа
----
GET /document/setDocument
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf/service/document/setDocument?sID_Subject_Upload=123&sSubjectName_Upload=Vasia&sName=Pasport&sFile=file.txt&nID_DocumentType=1&sDocumentContentType=application/zip&soDocumentContent=ffffffffffffffffff&nID_Subject=1

Response ИД ДОКУМЕНТА


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ИД-номер субъекта документа (владельца)|false|integer (int64)|
|QueryParameter|sID_Subject_Upload|ИД-строка субъекта, который загрузил документ|true|string|
|QueryParameter|sSubjectName_Upload|строка-название субъекта, который загрузил документ|true|string|
|QueryParameter|sName|строка-название документа|true|string|
|QueryParameter|nID_DocumentType|ИД-номер типа документа|true|integer (int64)|
|QueryParameter|sDocumentContentType|строка-тип контента документа|false|string|
|QueryParameter|soDocumentContent|контект в виде строки-обьекта|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|integer (int64)
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавить/изменить запись типа документа
----
GET /document/setDocumentType
----

===== Description
:hardbreaks:
примеры:
создать новый тип: https://test.igov.org.ua/wf/service/document/setDocumentType?nID=100&sName=test
ответ: 

```json
{"nID":20314,"sName":"test", , "bHidden":false}

```
изменить (взять ид из предыдущего ответа): https://test.igov.org.ua/wf/service/document/setDocumentType?nID=20314&sName=test2
ответ: 

```json
{"nID":20314,"sName":"test2", "bHidden":false}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ид-номер записи|true|integer (int64)|
|QueryParameter|sName|строка-название записи|true|string|
|QueryParameter|bHidden|флаг скрывать/не скрывать (при отдаче списка всех записей, булевское, по умолчанию = false)|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление записи по ее ид
----
GET /document/removeDocumentContentType
----

===== Description
:hardbreaks:
Если запись с ид=nID не будет найдена, то вернется ошибка 403. Record not found, иначе -- запись удалится.

пример:
https://test.igov.org.ua/wf/service/document/removeDocumentContentType?nID=20311

ответ: 200 ok


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ид-номер записи|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ECPCommonController -- Наложение Электронной Подписи
:hardbreaks:
ECP Common Controller

==== /applyCustom
----
POST /ecp/applyCustom
----

===== Description
:hardbreaks:
#####Накладівание кастомной ЄЦП.  Файл передается в теле запроса (POST) с именем параметра file. Примеры:
https://alpha.test.igov.org.ua/wf/service/ecp/applyCustom

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|FormDataParameter|file|file|true|file|
|FormDataParameter|file|file|true|file|
|FormDataParameter|file|file|true|file|
|QueryParameter|file|file|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

==== /applySelf
----
POST /ecp/applySelf
----

===== Description
:hardbreaks:
##### Накладівание своей ЄЦП. Файл передается в теле запроса (POST) с именем параметра file. Примеры:
https://alpha.test.igov.org.ua/wf/service/ecp/applySelf

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|FormDataParameter|file|file|true|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

=== ExportCommonController -- Вызов Стороннего АПИ
:hardbreaks:
Export Common Controller

==== /agroholding/transferDocumentVacation
----
GET /export/agroholding/transferDocumentVacation
----

===== Description
:hardbreaks:
##### Экспорт документа о отпуске в агрофирму. Примеры:
https://alpha.test.igov.org.ua/wf/service/export/agroholding/transferDocumentVacation

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== FinanceCentralController -- Финансовые И Смежные Сущности
:hardbreaks:
Finance Central Controller

==== Получить весь список обьектов мерчантов
----
GET /finance/getMerchants
----

===== Description
:hardbreaks:
Response


```json
[
    {
        "nID":1
        ,"sID":"Test_sID"
        ,"sName":"Test_sName"
        ,"sPrivateKey":"test_sPrivateKey"
        ,"sURL_CallbackStatusNew":"test_sURL_CallbackStatusNew"
        ,"sURL_CallbackPaySuccess":"test_sURL_CallbackPaySuccess"
        ,"nID_SubjectOrgan":1
        ,"sID_Currency":"UAH"
    }
    ,{
        "nID":2
        ,"sID":"i10172968078"
        ,"sName":"igov test"
        ,"sPrivateKey":"BStHb3EMmVSYefW2ejwJYz0CY6rDVMj1ZugJdZ2K"
        ,"sURL_CallbackStatusNew":"test_sURL_CallbackStatusNew"
        ,"sURL_CallbackPaySuccess":"test_sURL_CallbackPaySuccess"
        ,"nID_SubjectOrgan":1
        ,"sID_Currency":"UAH"
    }
]

```
Пример:
https://test.igov.org.ua/wf/service/finance/getMerchants

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возвращает список валют, подпадающих под параметры
----
GET /finance/getCurrencies
----

===== Description
:hardbreaks:
http://search.ligazakon.ua/l_doc2.nsf/link1/FIN14565.html[Источник данных]
Пример запроса: https://test.igov.org.ua/wf/service/finance/getCurrencies?sID_UA=004
Пример ответа:

```json
{
    "sID_UA"       : "004",
    "sName_UA"     : "Афґані",
    "sName_EN"     : "Afghani",
    "nID"          : 1
    "sID_Currency" : "AFA"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_UA|ИД-номер Код, в украинском классификаторе|false|string|
|QueryParameter|sName_UA|строка-название на украинском|false|string|
|QueryParameter|sName_EN|строка-название на английском|false|string|
|QueryParameter|sID_Currency|Международный строковой трехсимвольный код валюты|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Currency>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление мерчанта
----
DELETE /finance/removeMerchant
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf/service/finance/removeMerchant?sID=i10172968078Response
Status 200


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|ID-строка мерчанта(публичный ключ)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|204|No Content|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== обновляет запись валюты
----
GET /finance/setCurrency
----

===== Description
:hardbreaks:
обновляет запись (если задан один из параметров: nID, sID_UA; и по нему найдена запись) или вставляет (если не задан nID), и отдает экземпляр нового объекта

http://search.ligazakon.ua/l_doc2.nsf/link1/FIN14565.html[Источник данных]
Пример добавления записи:
https://test.igov.org.ua/wf/service/finance/setCurrency?sID_UA=050&sName_UA=Така&sName_EN=Taka&sID_Currency=BDT
Пример обновления записи:
https://test.igov.org.ua/wf/service/finance/setCurrency?sID_UA=050&sName_UA=Така


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|внутренний ИД-номер (уникальный; если sID_UA задан и по нему найдена запись)|false|integer (int64)|
|QueryParameter|sID_UA|ИД-номер Код, в украинском классификаторе (уникальный; если nID задан и по нему найдена запись)|false|string|
|QueryParameter|sName_UA|строка-название на украинском (уникальный; если nID задан и по нему найдена запись)|false|string|
|QueryParameter|sName_EN|строка-название на английском (уникальный; если nID задан и по нему найдена запись)|false|string|
|QueryParameter|sID_Currency|международный строковой трехсимвольный код валюты (уникальный; если nID задан и по нему найдена запись)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Currency>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обновление информации мерчанта
----
POST /finance/setMerchant
----

===== Description
:hardbreaks:
Response

```json
{
    "nID":1
    ,"sID":"Test_sID"
    ,"sName":"Test_sName22"
    ,"sPrivateKey":"test_sPrivateKey"
    ,"sURL_CallbackStatusNew":"test_sURL_CallbackStatusNew"
    ,"sURL_CallbackPaySuccess":"test_sURL_CallbackPaySuccess"
    ,"nID_SubjectOrgan":1
    ,"sID_Currency":"UAH"
}

```
Примеры обновления:
https://test.igov.org.ua/wf/service/finance/setMerchant?sID=Test_sID&sName=Test_sName2
https://test.igov.org.ua/wf/service/finance/setMerchant?nID=1&sName=Test_sName22

Пример добавления:
https://test.igov.org.ua/wf/service/finance/setMerchant?sID=Test_sID3&sName=Test_sName3&sPrivateKey=121212

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ID-номер мерчанта(внутренний) (если не задан или не найден - будет добавлена запись)|false|integer (int64)|
|QueryParameter|sID|ID-строка мерчанта(публичный ключ) (если не задан или не найден - будет добавлена запись)|false|string|
|QueryParameter|sName|строковое название мерчанта (при добавлении записи - обязательный)|false|string|
|QueryParameter|sPrivateKey|sPrivateKey строка-приватный ключ мерчанта (при добавлении записи - обязательный)|false|string|
|QueryParameter|nID_SubjectOrgan|ID-номер субьекта-органа мерчанта(может быть общий субьект у нескольких мерчантов)|false|integer (int64)|
|QueryParameter|sURL_CallbackStatusNew|строка-URL каллбэка, при новом статусе платежа(проведении проплаты)|false|string|
|QueryParameter|sURL_CallbackPaySuccess|строка-URL каллбэка, после успешной отправки платежа|false|string|
|QueryParameter|sID_Currency|международный строковой трехсимвольный код валюты|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить обьект мерчанта
----
GET /finance/getMerchant
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf/service/finance/getMerchant?sID=i10172968078
Response```json
{
    "nID":1
    ,"sID":"Test_sID"
    ,"sName":"Test_sName"
    ,"sPrivateKey":"test_sPrivateKey"
    ,"sURL_CallbackStatusNew":"test_sURL_CallbackStatusNew"
    ,"sURL_CallbackPaySuccess":"test_sURL_CallbackPaySuccess"
    ,"nID_SubjectOrgan":1
    ,"sID_Currency":"UAH"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|ID-строка мерчанта(публичный ключ)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление элемента по обязательно заданному одному из параметров
----
GET /finance/removeCurrency
----

===== Description
:hardbreaks:
http://search.ligazakon.ua/l_doc2.nsf/link1/FIN14565.html[Источник данных]
Пример запроса:
https://test.igov.org.ua/wf/service/finance/removeCurrency?sID_UA=050


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|внутренний ИД-номер (уникальный; если sID_UA задан и по нему найдена запись)|false|integer (int64)|
|QueryParameter|sID_UA|ИД-номер Код, в украинском классификаторе (уникальный; если nID задан и по нему найдена запись)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== FinanceCommonController -- Финансы Общие (в Т.ч. Платежи)
:hardbreaks:
Finance Common Controller

==== /finance/setPaymentStatus_TaskActiviti_Direct
----
GET /finance/setPaymentStatus_TaskActiviti_Direct
----

===== Description
:hardbreaks:
##### Контроллер платежей. Регистрация проведенного платежа - по прямому вызову


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|sID_PaymentSystem|Строка-ИД платежной системы|true|string|
|QueryParameter|sData|Строка со вспомогательными данными|true|string|
|QueryParameter|sPrefix|Cтрока-префикс платежа (если их несколько в рамках заявки)|false|string|
|QueryParameter|sID_Transaction|Строка-ИД транзакции|true|string|
|QueryParameter|sStatus_Payment|Строка-статуса платежа|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /finance/redirectPaymentLiqpay
----
GET /finance/redirectPaymentLiqpay
----

===== Description
:hardbreaks:
##### Получение URL-а и параметров для отправки платежа через POST-запрос


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Merchant|Строка-ИД Мерчанта|true|string|
|QueryParameter|sSum|Сумма (разделитель копеек - точка)|false|string|
|QueryParameter|sID_Order|Строка-ИД заявки-платежа|false|string|
|QueryParameter|sDescription|Описание платежа|false|string|
|QueryParameter|sID_Currency|ИД валюты (3 символа)|false|string|
|QueryParameter|sURL_CallbackStatusNew|sURL_CallbackStatusNew|false|string|
|QueryParameter|sURL_CallbackPaySuccess|sURL_CallbackPaySuccess|false|string|
|QueryParameter|nID_Subject|номер-ИД субьекта|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /finance/setPaymentStatus_TaskActiviti
----
POST /finance/setPaymentStatus_TaskActiviti
----

===== Description
:hardbreaks:
##### Контроллер платежей. Регистрация проведенного платежа - по колбэку от платежной системы


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|sID_PaymentSystem|Строка-ИД платежной системы|true|string|
|QueryParameter|sData|Строка со вспомогательными данными|true|string|
|QueryParameter|sPrefix|Строка-префикс платежа (если их несколько в рамках заявки)|false|string|
|BodyParameter|data|Строка-Данные от платежной системы|false|string|
|QueryParameter|signature|Строка-Подпись платежной системы|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /finance/setPaymentStatus_TaskActiviti
----
POST /setPaymentStatus_TaskActiviti
----

===== Description
:hardbreaks:
##### Контроллер платежей. Регистрация проведенного платежа - по колбэку от платежной системы


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|sID_PaymentSystem|Строка-ИД платежной системы|true|string|
|QueryParameter|sData|Строка со вспомогательными данными|true|string|
|QueryParameter|sPrefix|Строка-префикс платежа (если их несколько в рамках заявки)|false|string|
|BodyParameter|data|Строка-Данные от платежной системы|false|string|
|QueryParameter|signature|Строка-Подпись платежной системы|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== MUController -- Контроллер Для Взаимодействия С Веб Сервисом Министерства Юстиции
:hardbreaks:
MU Controller

==== getObjectEarthTargets
----
GET /MU/test
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|service_code|service_code|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getObjectEarthTargets
----
GET /MU/getServiceUrl
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|service_code|service_code|true|string|
|QueryParameter|application_id|application_id|true|integer (int32)|
|QueryParameter|session_id|session_id|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getObjectEarthTargets
----
POST /MU/setOrder
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|application_id|application_id|false|string|
|QueryParameter|sessionId|sessionId|false|string|
|QueryParameter|fileName|fileName|false|string|
|QueryParameter|file_sign|Документ для передачи в веб сервис министерства юстиции|false|multi string array|
|QueryParameter|file_stamp|Подпись документа для передачи в веб сервис министерства юстиции|false|multi string array|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ObjectController -- Обьекты И Смежные Сущности
:hardbreaks:
Object Controller

==== Получение списка целевых назначений земель, подпадающих под параметры
----
GET /object/getObjectEarthTargets
----

===== Description
:hardbreaks:
Пример запроса:
https://test.igov.org.ua/wf/service/object/getObjectEarthTargets?sID_UA=01.01
Пример ответа:

```json
{
  "sID_UA"   : "01.01",
  "sName_UA" : "Для ведення товарного сільськогосподарського виробництва",
  "nID"      : 1
}

```
http://www.neruhomist.biz.ua/classification.html[источник данных]

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_UA|ид-строка. подразделение в коде КВЦПЗ (уникальный)|false|string|
|QueryParameter|sName_UA|строка-название целевого назначения земель на украинском (уникальный, достаточно чтоб совпала любая часть названия)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ObjectEarthTarget>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить список объектов ObjectCustoms 
----
GET /object/getObjectCustoms
----

===== Description
:hardbreaks:
Пример ответа:

```json
[
  {
    "sID_UA": "0101",
    "sName_UA": "Коні, віслюки, мули та лошаки, живі:",
    "sMeasure_UA": "-",
    "nID": 1
  },
  {
    "sID_UA": "0101 10",
    "sName_UA": "Коні, віслюки, мули та лошаки, живі:  чистопородні племінні тварини:",
    "sMeasure_UA": "-",
    "nID": 2
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_UA|строка-ид(опциональный, если другой уникальный ключ задан и по нему найдена запись) (формат 0101 01 01 01)|false|string|
|QueryParameter|sName_UA|строка-ид(опциональный, если другой уникальный ключ задан и по нему найдена запись)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление записи по уникальному значению nID или sID_UA
----
GET /object/removeObjectCustoms
----

===== Description
:hardbreaks:
Запрос вида /wf/service/object/removeObjectCustoms?;


- nID     (опциональный, если другой уникальный-ключ задан и по нему найдена запись)
- sID_UA  (опциональный, если другой уникальный-ключ задан и по нему найдена запись)(формат 0101 01 01 01)

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|нет описания|false|integer (int64)|
|QueryParameter|sID_UA|нет описания|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Обновление или вставка новуой записи
----
GET /object/setObjectCustoms
----

===== Description
:hardbreaks:
Запрос вида /wf/service/object/setObjectCustoms?
обновление записи происходит в том случае, если есть параметр nID
и хотя бы один другой параметр: sID_UA, sName_UA или sMeasure_UA;
вставка записи происходит в том случае, если в метод не передается
параметр nID, но передаются три других параметра;
пример возвращаемого объекта:

```json
{
  "sID_UA": "0101",
  "sName_UA": "Коні, віслюки, мули та лошаки, живі:",
  "sMeasure_UA": "-",
  "nID": 1
}

```
при вставке и обновлении поля sID_UA важно, чтобы параметр не имел впереди и позади пробелов, иначе может нарушиться уникальность записи
при вставке и обновлении поля sName_UA важно брать в кавычки запись, если она содержит "точку с пробелом" — ";"
- nID         (опциональный, если другой уникальный-ключ задан и по нему найдена запись)
- sID_UA      (опциональный, если другой уникальный-ключ задан и по нему найдена запись)(формат 0101 01 01 01)
- sName_UA    (опциональный, если другой уникальный-ключ задан и по нему найдена запись)
- sMeasure_UA (опциональный)


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|строка-ключ(опциональный, если другой уникальный-ключ задан и по нему найдена запись)|false|integer (int64)|
|QueryParameter|sID_UA|строка-ключ(опциональный, если другой уникальный-ключ задан и по нему найдена запись)(формат 0101 01 01 01)|false|string|
|QueryParameter|sName_UA|строка-ключ(опциональный, если другой уникальный-ключ задан и по нему найдена запись)|false|string|
|QueryParameter|sMeasure_UA|строка названия мерчанта на украинском|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== ObjectFileCommonController -- Обьекты Файлов Общие
:hardbreaks:
Object File Common Controller

==== Загрузка прикрепленного к заявке файла из базы по новой схеме
----
GET /object/file/getProcessAttach
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД процесса|false|string|
|QueryParameter|sID_Field|ИД поля|false|string|
|QueryParameter|sKey|Ключ в БД|false|string|
|QueryParameter|sID_StorageType|Тип БД|false|string|
|QueryParameter|sFileName|Имя файла по умолчанию|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== checkProcessAttach
----
GET /object/file/checkProcessAttach
----

===== Description
:hardbreaks:
##### проверка ЭЦП по новому концепту

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_StorageType|cтрока-ИД типа хранилища Redis или Mongo|false|string|
|QueryParameter|sFileNameAndExt|название и расширение файла|false|string|
|QueryParameter|sID_Process|ид процесса|false|string|
|QueryParameter|sID_Field|ид поля|false|string|
|QueryParameter|sKey|ключ в базе данных|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Загрузка прикрепленного к заявке файла из базы по новой схеме
----
GET /object/file/getDocumentImage
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД процесс-активити|false|string|
|QueryParameter|sLogin|Логин подписанта|false|string|
|QueryParameter|sKey_Step|Ключ шага документа|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== setProcessAttachText
----
POST /object/file/setProcessAttachText
----

===== Description
:hardbreaks:
##### загрузка body-атачмента по новому концепту

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|false|string|
|QueryParameter|bSigned|наложено или не наложено ЭЦП|false|boolean|
|QueryParameter|sID_StorageType|cтрока-ИД типа хранилища Redis или Mongo|false|string|
|QueryParameter|aAttribute|массив атрибутов в виде сериализованного обьекта JSON|false|multi <<Map«string,object»>> array|
|QueryParameter|sFileNameAndExt|название и расширение файла|true|string|
|QueryParameter|sID_Field|ид поля|false|string|
|QueryParameter|sContentType|строка-MIME тип отправляемого файла (по умолчанию = "text/html")|false|string|
|BodyParameter|sData|контент файла в виде строки|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /dfs/getPatternFilled
----
POST /object/file/dfs/getPatternFilled
----

===== Description
:hardbreaks:
##### Заполнение указанного шаблона(по его ИД ищется файл в подпапке проекта) указанными параметрами, и его отдача.
<br>Пример запроса: https://alpha.test.region.igov.org.ua/wf/service/object/file/dfs/getPatternFilled?sID_Pattern=F1301801в теле запроса передавать JSON-обьект в виде строки, например:<br>{<br>{
	"HLNAME":"БІЛЯВЦЕВ"
	,"HPNAME":"ВОЛОДИМИР"
	,"HFNAME":"ВОЛОДИМИРОВИЧ"
	,"HTIN":"2943209693"
	,"HKSTI":"2301"
	,"HSTI":"2650 ДПІ У ГОЛОСІЇВСЬКОМУ Р-НІ ГУ МІНДОХОДІВ У М.КИЄВІ"
	,"HEMAIL":"olga.kuzminova87@gmail.com"
	,"HCOUNTRY":"Украіна"
	,"HCITY":"Дніпро"
	,"HSTREET":"Красный камень"
	,"HBUILD":"5"
	,"R01G01":"22"
	,"R01G01":"22"
	,"R01G02":"22"
	,"R02G01":"22"
	,"R02G02":"22"
	,"C_REG":"23"
	,"C_RAJ":"01"
	,"TIN":"3578965412"
	,"C_DOC":"F13"
	,"C_DOC_SUB":"018"
	,"C_DOC_VER":"01"
	,"C_DOC_STAN":"1"
	,"C_DOC_TYPE":"00"
	,"C_DOC_CNT":"0000001"
	,"PERIOD_TYPE":"1"
	,"PERIOD_MONTH":"12"
	,"PERIOD_YEAR":"2015"
	,"C_STI_ORIG":"2301"

)<br><br>В ответ получим заполненный шаблон. например:<br>{
  "soPatternFilled": "<?xml version=\"1.0\" encoding=\"windows-1251\"?><DECLAR xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceSchemaLocation=\"F1301801.xsd\"><DECLARHEAD><TIN>3578965412</TIN><C_DOC>F13</C_DOC><C_DOC_SUB>018</C_DOC_SUB><C_DOC_VER>01</C_DOC_VER><C_DOC_TYPE>00</C_DOC_TYPE><C_DOC_CNT>0000001</C_DOC_CNT><C_REG>23</C_REG><C_RAJ>01</C_RAJ><PERIOD_MONTH>12</PERIOD_MONTH><PERIOD_TYPE>1</PERIOD_TYPE><PERIOD_YEAR>2015</PERIOD_YEAR><C_STI_ORIG>2301</C_STI_ORIG><C_DOC_STAN>1</C_DOC_STAN><D_FILL>24102016</D_FILL><SOFTWARE xsi:nil=\"true\"></SOFTWARE></DECLARHEAD><DECLARBODY><HLNAME>БІЛЯВЦЕВ</HLNAME><HPNAME>ВОЛОДИМИР</HPNAME><HFNAME>ВОЛОДИМИРОВИЧ</HFNAME><HTIN>2943209693</HTIN><HKSTI>2301</HKSTI><HSTI>2650 ДПІ У ГОЛОСІЇВСЬКОМУ Р-НІ ГУ МІНДОХОДІВ У М.КИЄВІ</HSTI><HEMAIL>olga.kuzminova87@gmail.com</HEMAIL><HCOUNTRY>Украіна</HCOUNTRY><HREG xsi:nil=\"true\"></HREG><HRAJ xsi:nil=\"true\"></HRAJ><HCITY>Дніпро</HCITY><HSTREET>Красный камень</HSTREET><HBUILD>5</HBUILD><HSHOT xsi:nil=\"true\"></HSHOT><HCORP xsi:nil=\"true\"></HCORP><HAPT xsi:nil=\"true\"></HAPT><HPASS xsi:nil=\"true\"></HPASS><HPASSDATE xsi:nil=\"true\"></HPASSDATE><HPASSISS xsi:nil=\"true\"></HPASSISS><R01G01>22</R01G01><R01G02>22</R01G02><R02G01>22</R02G01><R02G02>22</R02G02><HFILL>24102016</HFILL></DECLARBODY></DECLAR>",
  "sFileName": "23013578965412F1301801100000000111220152301.xml"
}

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|mField|Список алиасов и значений из формы в json формате|false|object|
|QueryParameter|sID_Pattern|Ид файла-шаблона|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== setDocumentImage
----
POST /object/file/setDocumentImage
----

===== Description
:hardbreaks:
##### загрузка body-атачмента по новому концепту(PDF)

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|false|string|
|QueryParameter|bSigned|наложено или не наложено ЭЦП|false|boolean|
|QueryParameter|sID_StorageType|cтрока-ИД типа хранилища Redis или Mongo|false|string|
|QueryParameter|aAttribute|массив атрибутов в виде сериализованного обьекта JSON|false|multi <<Map«string,object»>> array|
|QueryParameter|sFileNameAndExt|название и расширение файла|true|string|
|QueryParameter|sID_Field|ид поля|false|string|
|QueryParameter|sContentType|строка-MIME тип отправляемого файла (по умолчанию = "text/html")|false|string|
|QueryParameter|sLogin|Логин подписанта|true|string|
|QueryParameter|sKey_Step|Ключ шага документа|true|string|
|FormDataParameter|file|файл для сохранения в БД|true|file|
|BodyParameter|sData|контент файла в виде строки|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* application/json

==== setTaskAttachment
----
POST /object/file/setTaskAttachment
----

===== Description
:hardbreaks:
#####  Set/update файла-атачмента к таске Activiti

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nTaskId|номер-ИД задачи|true|string|
|QueryParameter|sContentType|строка-MIME тип отправляемого файла (по умолчанию = "text/html")|false|string|
|QueryParameter|sDescription|строка-описание|true|string|
|QueryParameter|sFileName|sFileName|true|string|
|QueryParameter|nID_Attach|id аттача Activiti|false|string|
|BodyParameter|sData|sData|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<AttachmentEntityI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Проверка ЭЦП на атачменте(файл) таски Activiti
----
GET /object/file/check_attachment_sign
----

===== Description
:hardbreaks:
##### Примеры:
https://test.region.igov.org.ua/wf/service/object/file/check_attachment_sign?nID_Task=7315073&nID_Attach=7315075
Ответ:

```json
{
  "state": "ok",
  "customer": {
    "inn": "1436057000",
    "fullName": "Сервіс зберігання сканкопій",
    "signatureData": {
      "name": "АЦСК ПАТ КБ «ПРИВАТБАНК»",
      "serialNumber": "0D84EDA1BB9381E80400000079DD02004A710800",
      "timestamp": "29.10.2015 13:45:33",
      "code": true,
      "desc": "ПІДПИС ВІРНИЙ",
      "dateFrom": "13.08.2015 11:24:31",
      "dateTo": "12.08.2016 23:59:59",
      "sn": "UA-14360570-1"
    },
    "organizations": [
      {
        "type": "edsOwner",
        "name": "ПАТ КБ «ПРИВАТБАНК»",
        "mfo": "14360570",
        "position": "Технологічний сертифікат",
        "ownerDesc": "Співробітник банку",
        "address": {
          "type": "factual",
          "state": "Дніпропетровська",
          "city": "Дніпропетровськ"
        }
      },
      {
        "type": "edsIsuer",
        "name": "ПУБЛІЧНЕ АКЦІОНЕРНЕ ТОВАРИСТВО КОМЕРЦІЙНИЙ БАНК «ПРИВАТБАНК»",
        "unit": "АЦСК",
        "address": {
          "type": "factual",
          "state": "Дніпропетровська",
          "city": "Дніпропетровськ"
        }
      }
    ]
  }
}

```

Ответ для несуществующей таски (nID_Task):

```json
{"code":"SYSTEM_ERR","message":"ProcessInstanceId for taskId '7315070' not found."}

```

Ответ для несуществующего атачмента (nID_Attach):

```json
{"code":"SYSTEM_ERR","message":"Attachment for taskId '7315073' not found."}

```

Ответ для атачмента который не имеет наложеной ЭЦП:

```json
{}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Task|ИД-номер таски|true|string|
|QueryParameter|nID_Attach|строка-ИД атачмента приложеного к таске|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Загрузки прикрепленного к заявке файла из постоянной базы
----
GET /object/file/download_file_from_db
----

===== Description
:hardbreaks:
##### Пример:
 https://alpha.test.igov.org.ua/wf/service/object/file/download_file_from_db?taskId=82596&attachmentId=6726532&nFile=7


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|taskId|строка-ИД задачи|true|string|
|QueryParameter|attachmentId|строка-ID прикрепленного файла|false|string|
|QueryParameter|nFile|порядковый номер прикрепленного файла|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== GetAttachmentsFromRedis
----
GET /object/file/download_file_from_redis
----

===== Description
:hardbreaks:
#####  ObjectFileCommonController: описания нет


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|key|key|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Аплоад(upload) и прикрепление текстового файла в виде атачмента к таске Activiti
----
POST /object/file/upload_content_as_attachment
----

===== Description
:hardbreaks:
#####Пример: http://localhost:8080/wf/service/object/file/upload_content_as_attachment?nTaskId=24&sDescription=someText&sFileName=FlyWithMe.html

```json
Ответ без ошибок:
{
  "taskId": "38",
  "processInstanceId": null,
  "userId": "kermit",
  "name": "FlyWithMe.html",
  "id": "25",
  "type": "text/html;html",
  "description": "someText",
  "time": 1433539278957,
  "url": null
}

ID созданного attachment - "id": "25"

```

Ответ с ошибкой:

```json
{"code":"SYSTEM_ERR","message":"Cannot find task with id 384"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nTaskId|строка-Логин пользователя|true|string|
|QueryParameter|sContentType|строка-MIME тип отправляемого файла (по умолчанию = "text/html")|false|string|
|QueryParameter|sDescription|строка-описание|true|string|
|QueryParameter|sFileName|sFileName|true|string|
|QueryParameter|sID_Field|sID_Field|false|string|
|BodyParameter|sData|sData|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<AttachmentEntityI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Проверка ЭЦП на файле хранящемся в Redis
----
GET /object/file/check_file_from_redis_sign
----

===== Description
:hardbreaks:
#####  Примеры:
https://test.region.igov.org.ua/wf/service/object/file/check_file_from_redis_sign?sID_File_Redis=d2993755-70e5-409e-85e5-46ba8ce98e1d

Ответ json описывающий ЭЦП:


```json
{
  "state": "ok",
  "customer": {
    "inn": "1436057000",
    "fullName": "Сервіс зберігання сканкопій",
    "signatureData": {
      "name": "АЦСК ПАТ КБ «ПРИВАТБАНК»",
      "serialNumber": "0D84EDA1BB9381E80400000079DD02004A710800",
      "timestamp": "29.10.2015 13:45:33",
      "code": true,
      "desc": "ПІДПИС ВІРНИЙ",
      "dateFrom": "13.08.2015 11:24:31",
      "dateTo": "12.08.2016 23:59:59",
      "sn": "UA-14360570-1"
    },
    "organizations": [
      {
        "type": "edsOwner",
        "name": "ПАТ КБ «ПРИВАТБАНК»",
        "mfo": "14360570",
        "position": "Технологічний сертифікат",
        "ownerDesc": "Співробітник банку",
        "address": {
          "type": "factual",
          "state": "Дніпропетровська",
          "city": "Дніпропетровськ"
        }
      },
      {
        "type": "edsIsuer",
        "name": "ПУБЛІЧНЕ АКЦІОНЕРНЕ ТОВАРИСТВО КОМЕРЦІЙНИЙ БАНК «ПРИВАТБАНК»",
        "unit": "АЦСК",
        "address": {
          "type": "factual",
          "state": "Дніпропетровська",
          "city": "Дніпропетровськ"
        }
      }
    ]
  }
}

```
Ответ для несуществующего ключа (sID_File_Redis):

```json
{"code":"SYSTEM_ERR","message":"File with sID_File_Redis 'd2993755-70e5-409e-85e5-46ba8ce98e1e' not found."}


```
Ответ для файла который не имеет наложеной ЭЦП:


```json
{}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_File_Redis|строка-ключ по которому можно получить файл из хранилища Redis|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json;charset=UTF-8

==== Сервис для получения Attachment из execution
----
GET /object/file/download_file_from_db_execution
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|taskId|ИД-номер таски|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== moveAttachsToMongo
----
GET /object/file/moveAttachsToMongo
----

===== Description
:hardbreaks:
#####  ObjectFileCommonController: Перенос атачментов задач активити в mongo DB  
пробегается по всем активным задачам и переносит их атачменты в mongo DB (если они еще не там) 
и в самом объекте атачмента меняет айдишники атачментов на новые
Метод содержит необязательные параметры, которые определяют какие задачи обрабатывать
nStartFrom - порядковый номер задачи в списке всех задач, с которого начинать обработку
nChunkSize - количество задач, которые обрабатывать начиная или с первой или со значения nStartFrom. 
Задачи выюираются по 10 из базы, поэтому лучше делать значени nChunkSize кратным 10
nProcessId - обрабатывать задачу с заданным айдишником
Примеры:

https://test.region.igov.org.ua/wf/service/object/file/moveAttachsToMongo
Перенести все атачменты задач в Монго ДБ

https://test.region.igov.org.ua/wf/service/object/file/moveAttachsToMongo?nProcessId=9397569
Перенести атачменты процесса с ID 9397569 в Монго ДБ

https://test.region.igov.org.ua/wf/service/object/file/moveAttachsToMongo?nStartFrom=0&nChunkSize=10

Перенести аттачменты процесса с 0 по 10 в монго

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nStartFrom|Порядковый номер процесса с которого начинать обработку аттачментов|false|string|
|QueryParameter|nChunkSize|строка-размер блока для выборки процесса на обработку|false|string|
|QueryParameter|nProcessId|строка-ИД конкретного процесса|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== PutAttachmentsToRedis
----
POST /object/file/upload_file_to_redis
----

===== Description
:hardbreaks:
#####  Укладываем в редис multipartFileToByteArray


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|FormDataParameter|file|file|true|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* */*

==== Аплоад(upload) и прикрепление файла в виде атачмента к таске Activiti
----
POST /object/file/upload_file_as_attachment
----

===== Description
:hardbreaks:
#####  Примеры: 
http://test.igov.org.ua/wf/service/object/file/upload_file_as_attachment?taskId=68&description=ololo

```json
Ответ без ошибок:
{
  "taskId": "38",
  "processInstanceId": null,
  "userId": "kermit",
  "name": "jmt.png",
  "id": "45",
  "type": "image/png;png",
  "description": "SomeDocumentDescription",
  "time": 1433539278957,
  "url": null
}

ID созданного attachment - "id": "45"


```
Ответ с ошибкой:


```json
{"code":"SYSTEM_ERR","message":"Cannot find task with id 384"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|taskId|ИД-номер таски|true|string|
|FormDataParameter|file|файл html. в html это имя элемента input типа file - <input name="file" type="file" />. в HTTP заголовках - Content-Disposition: form-data; name="file" ...|true|file|
|QueryParameter|description|строка-описание|true|string|
|QueryParameter|sID_Field|ИД поля формы, к которому загружается файл|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<AttachmentEntityI>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* application/json

==== Загрузки прикрепленного к заявке файла из постоянной базы
----
GET /object/file/download_file_from_storage_static
----

===== Description
:hardbreaks:
##### Пример:
 https://alpha.test.igov.org.ua/wf/service/object/file/download_file_from_storage_static?sId=111111&sFileName=111.txt&sType=text


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sId|sId|true|string|
|QueryParameter|sFileName|sFileName|true|string|
|QueryParameter|sType|sType|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== GetAttachmentsFromRedisBytes
----
GET /object/file/download_file_from_redis_bytes
----

===== Description
:hardbreaks:
#####  ObjectFileCommonController: описания нет


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|key|key|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Работа с файлами-шаблонами
----
GET /object/file/getPatternFile
----

===== Description
:hardbreaks:
#####  возвращает содержимое указанного файла с указанным типом контента (если он задан).
Если указанный путь неверен и файл не найден -- вернется соответствующая ошибка.

Примеры:

https://test.region.igov.org.ua/wf/service/object/file/getPatternFile?sPathFile=print//subsidy_zayava.html

ответ: вернется текст исходного кода файла-шаблона

https://test.region.igov.org.ua/wf/service/object/file/getPatternFile?sPathFile=print//subsidy_zayava.html&sContentType=text/html

ответ: файл-шаблон будет отображаться в виде html-страницы

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sPathFile|строка-полный путь к файлу|true|string|
|QueryParameter|sContentType|строка-тип контента|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== setProcessAttach
----
POST /object/file/setProcessAttach
----

===== Description
:hardbreaks:
##### загрузка файла-атачмента по новому концепту

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|false|string|
|QueryParameter|bSigned|наложено или не наложено ЭЦП|false|boolean|
|QueryParameter|sID_StorageType|cтрока-ИД типа хранилища Redis или Mongo|false|string|
|QueryParameter|aAttribute|массив атрибутов в виде сериализованного обьекта JSON|false|multi <<Map«string,object»>> array|
|QueryParameter|sContentType|строка-MIME тип отправляемого файла (по умолчанию = "text/html")|false|string|
|QueryParameter|sFileNameAndExt|название и расширение файла|true|string|
|QueryParameter|sID_Field|ид поля|false|string|
|FormDataParameter|file|файл для сохранения в БД|true|file|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* multipart/form-data

===== Produces

* application/json

=== ObjectPlaceController -- Обьекты Мест (населенных Пунктов И Регионов) И Стран
:hardbreaks:
Object Place Common Controller

==== Получение сущности Place
----
GET /object/place/getPlaceEntity
----

===== Description
:hardbreaks:
Пример: https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?nID=22830
Ответ:
```json
{
    "sID_UA": "90005000462",
    "nID": 22830,
    "sName": "child_of_462",
    "nID_PlaceType": 5,
    "sNameOriginal": "5000_462_child"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД места|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Place>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение данных из справочника КОАТУУ
----
GET /object/place/getObjectPlace_UA
----

===== Description
:hardbreaks:
Получаем данные из справочника КОАТУУ. Пример:
https://alpha.test.igov.org.ua/wf/service/object/place/getObjectPlace_UA?sFind=днепр

Ответ:

```json
[
  {
    "sID": "00008000",
    "sName_UA": "Дніпропетровська обл.",
    "nID_PlaceType": 1,
    "nID": 1
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|sFind - кретерий поиска в sID или sName_UA (без учета регистра, в любой части текста)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ObjectPlace_UA>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение субъекта
----
GET /object/place/getPlaceType
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf-central/service/object/place/getPlaceType?nID=1
Ответ

```json
[
    {
        "bArea": true,
        "bRoot": true,
        "nID": 1,
        "sName": "Область",
        "nOrder": null
    }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|нет описания|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<PlaceType>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение списка улиц
----
GET /object/place/sub/PB/getSubPlaces_
----

===== Description
:hardbreaks:
Получем список улиц. Пример:
https://alpha.test.igov.org.ua/wf/service/object/place/sub/PB/getSubPlaces_/?sID_SubPlace_PB=UA40773&sFind=южн

Ответ:


```json
{  "listAddress":   [{      "code": "23TFD62IDSDX00",	     "desc": "1-я Южная",	     "type": "улица"    }, {	     "code": "23T149MQULAP00",	     "desc": "Южная Сторона",	     "type": "улица"    }   ]}
```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_SubPlace_PB|sID_SubPlace_PB - код узла адреса)|true|string|
|QueryParameter|sFind|sFind - строка поиска (ищет по вхождению текста в название улицы)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json
* application/json;charset=UTF-8

==== Получение типа места
----
GET /object/place/getPlaceTypes
----

===== Description
:hardbreaks:
Примеры
Получить тип места (область)
https://test.igov.org.ua/wf-central/service/object/place/getPlaceTypes?bArea=true&bRoot=true
Ответ

```json
[
    {
        "bArea": true,
        "bRoot": true,
        "nID": 1,
        "sName": "Область",
        "nOrder": null
    }
]




```
Получить тип места (район).
https://test.igov.org.ua/wf-central/service/object/place/getPlaceTypes?bArea=true&bRoot=false
Ответ

```json
[
    {
        "bArea": true,
        "bRoot": false,
        "nID": 2,
        "sName": "Район",
        "nOrder": null
    }
]




```
Получить тип места (ПГТ, город, село).
https://test.igov.org.ua/wf-central/service/object/place/getPlaceTypes?bArea=false&bRoot=false
Ответ

```json
[
    {
        "bArea": false,
        "bRoot": false,
        "nID": 3,
        "sName": "Город",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 4,
        "sName": "ПГТ",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 5,
        "sName": "Село",
        "nOrder": null
    }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|bArea|булевый флаг. если true -- только территория (район)|true|boolean|
|QueryParameter|bRoot|булевый флаг. если true -- только корень (область)|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<PlaceType>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Вставить новый объект Place
----
POST /object/place/setPlace
----

===== Description
:hardbreaks:
Примеры
https://test.igov.org.ua/wf/service/object/place/setPlace?sName=child_of_462&nID_PlaceType=5&sID_UA=90005000462&sNameOriginal=5000_462_child

Результат
HTTP code = 200 OK


GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?sID_UA=90005000462 должен вернуть вашу сущность.

```json
{
    "sID_UA": "90005000462",
    "nID": 22830,
    "sName": "child_of_462",
    "nID_PlaceType": 5,
    "sNameOriginal": "5000_462_child"
}

```
Примечание: Первичный ключ (параметр nID) мы не указываем, т.к. хибернейт обязан сам генерировать PK



Обновить объект Place (параметр для поиска sID_UA).
https://test.igov.org.ua/wf/service/object/place/setPlace?sName=child_of_462&nID_PlaceType=5&sID_UA=90005000462&sNameOriginal=5000_462_child
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?sID_UA=90005000462 должен вернуть вашу сущность с обновленными параметрами:

```json
{
    "sID_UA": "90005000462",
    "nID": 22830,
    "sName": "child_of_462",
    "nID_PlaceType": 5,
    "sNameOriginal": "5000_462_child"
}

```



Обновить объект Place (параметр для поиска nID, PK).
https://test.igov.org.ua/wf/service/object/place/setPlace?sName=The_child_of_462&nID_PlaceType=5&sNameOriginal=50000_462_child&nID=22830&sID_UA=90005000462
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?nID=22830 должен вернуть вашу сущность с обновленными параметрами:

```json
{
    "sID_UA": "90005000462",
    "nID": 22830,
    "sName": "child_of_462",
    "nID_PlaceType": 5,
    "sNameOriginal": "5000_462_child"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|id места|false|integer (int64)|
|QueryParameter|sName|строка имени|false|string|
|QueryParameter|nID_PlaceType|номер-МД типа места (населенного пункта/региона)|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|QueryParameter|sNameOriginal|строка имени оригинального|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Изменить объект "Cтрана"
----
GET /object/place/setCountry
----

===== Description
:hardbreaks:
апдейтит элемент (если задан один из уникальных ключей) или вставляет (если не задан nID), и отдает экземпляр нового объекта.
Если нет ни одного параметра возвращает ошибку 403. All args are null! Если есть один из уникальных ключей, но запись не найдена -- ошибка 403. Record not found! Если кидать "новую" запись с одним из уже существующих ключей nID_UA -- то обновится существующая запись по ключу nID_UA, если будет дублироваться другой ключ -- ошибка 403. Could not execute statement (из-за уникальных констрейнтов)

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер, идентификатор записи|false|integer (int64)|
|QueryParameter|nID_UA|ИД-номер Код, в Украинском классификаторе (уникальное)|false|integer (int64)|
|QueryParameter|sID_Two|ИД-строка Код-двухсимвольный, международный (уникальное, строка 2 символа)|false|string|
|QueryParameter|sID_Three|ИД-строка Код-трехсимвольный, международный (уникальное, строка 3 символа)|false|string|
|QueryParameter|sNameShort_UA|строка-Назва країни, коротка, Украинская (уникальное, строка до 100 символов)|false|string|
|QueryParameter|sNameShort_EN|строка-Назва країни, коротка, англійською мовою (уникальное, строка до 100 символов)|false|string|
|QueryParameter|sReference_LocalISO|Ссылка на локальный ISO-стандарт, с названием (a-teg с href) (строка до 100 символов)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Нет ни одного параметра / запись не найдена / дублируется один из ключей: nID, sID_Two, sID_Three|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получения дерева мест (регионов и городов)
----
GET /object/place/getPlaces
----

===== Description
:hardbreaks:
Пример: 
https://test.igov.org.ua/wf/service/object/place/getPlaces
Ответ:

```json
[
    {
        "nID": 1,
        "sName": "Дніпропетровська",
        "aCity": [
            {
                "nID": 1,
                "sName": "Дніпропетровськ"
            },
            {
                "nID": 2,
                "sName": "Кривий Ріг"
            }
        ]
    },
    {
        "nID": 2,
        "sName": "Львівська",
        "aCity": [
            {
                "nID": 3,
                "sName": "Львів"
            }
        ]
    },
    {
        "nID": 3,
        "sName": "Івано-Франківська",
        "aCity": [
            {
                "nID": 4,
                "sName": "Івано-Франківськ"
            },
            {
                "nID": 5,
                "sName": "Калуш"
            }
        ]
    },
    {
        "nID": 4,
        "sName": "Миколаївська",
        "aCity": []
    },
    {
        "nID": 5,
        "sName": "Київська",
        "aCity": [
            {
                "nID": 6,
                "sName": "Київ"
            }
        ]
    },
    {
        "nID": 6,
        "sName": "Херсонська",
        "aCity": [
            {
                "nID": 7,
                "sName": "Херсон"
            }
        ]
    },
    {
        "nID": 7,
        "sName": "Рівненська",
        "aCity": [
            {
                "nID": 8,
                "sName": "Кузнецовськ"
            }
        ]
    },
    {
        "nID": 8,
        "sName": "Волинська",
        "aCity": [
            {
                "nID": 9,
                "sName": "Луцьк"
            }
        ]
    }
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить обьект по одному из четырех ключей (nID, nID_UA, sID_Two, sID_Three)
----
GET /object/place/removeCountry
----

===== Description
:hardbreaks:
удаляет обьект по одному из четырех ключей (nID, nID_UA, sID_Two, sID_Three) или кидает ошибку 403. Record not found!.


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер, идентификатор записи|false|integer (int64)|
|QueryParameter|nID_UA|ИД-номер Код, в Украинском классификаторе (уникальное)|false|integer (int64)|
|QueryParameter|sID_Two|ИД-строка Код-двухсимвольный, международный (уникальное, строка 2 символа)|false|string|
|QueryParameter|sID_Three|ИД-строка Код-трехсимвольный, международный (уникальное, строка 3 символа)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение данных из справочника КОАТУУ
----
GET /object/place/getObjectPlace_UA2
----

===== Description
:hardbreaks:
Получаем данные из справочника КОАТУУ. Пример:
https://alpha.test.igov.org.ua/wf/service/object/place/getObjectPlace_UA2?sID=09&sName_UA=дніпр

Ответ:

```json
[
  {
    "sID": "00008000",
    "sName_UA": "Дніпропетровська обл.",
    "nID_PlaceType": 1,
    "nID": 1
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|sID - кретерий поиска в sID (без учета регистра, в любой части текста)|true|string|
|QueryParameter|sName_UA|sName_UA - кретерий поиска в sName_UA (без учета регистра, в любой части текста)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ObjectPlace_UA>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Возвращает название сущности Place исходной заявки
----
GET /object/place/getPlaceByProcess
----

===== Description
:hardbreaks:
Возвращает название сущности Place исходной заявки или кидает ошибку 403. Record not found!.


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|ИД-номер, идентификатор заявки|true|integer (int64)|
|QueryParameter|nID_Server|ИД-номер сервера|true|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Place>>
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление объекта Place
----
POST /object/place/removePlace
----

===== Description
:hardbreaks:
Примеры
Удалить объект Place по первичному ключу (параметр nID).

https://test.igov.org.ua/wf-central/service/object/place/removePlace?nID=22830
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?nID=22830 должен вернуть cообщение об ошибке:

```json
{
    "code": "SYSTEM_ERR",
    "message": "Entity with id=22830 does not exist"
}




```
Удалить объект Place по уникальному UA id (параметр sID_UA).
https://test.igov.org.ua/wf-central/service/object/place/removePlace?sID_UA=90005000462
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceEntity?nID=22830 должен вернуть cообщение об ошибке:

```json
{
    "code": "SYSTEM_ERR",
    "message": "Entity with sID_UA='90005000462' not found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД места|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Возвращает объект Страны по первому из 4х ключей (nID, nID_UA, sID_Two, sID_Three)
----
GET /object/place/getCountry
----

===== Description
:hardbreaks:
Если нет ни одного параметра возвращает ошибку 403. required at least one of parameters (nID, nID_UA, sID_Two, sID_Three)!
Eсли задано два ключа от разных записей -- вернется та, ключ который "первее" в таком порядке: nID, nID_UA, sID_Two, sID_Three.
пример: https://test.igov.org.ua/wf/service/object/place/getCountry?nID_UA=123
Ответ:

```json
{
  "nID_UA":123,
  "sID_Two":"AU",
  "sID_Three":"AUS",
  "sNameShort_UA":"Австралія",
  "sNameShort_EN":"Australy",
  "sReference_LocalISO":"ISO_3166-2:AU",
  "nID":20340
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер, идентификатор записи|false|integer (int64)|
|QueryParameter|nID_UA|ИД-номер Код, в Украинском классификаторе (уникальное)|false|integer (int64)|
|QueryParameter|sID_Two|ИД-строка Код-двухсимвольный, международный (уникальное, строка 2 символа)|false|string|
|QueryParameter|sID_Three|ИД-строка Код-трехсимвольный, международный (уникальное, строка 3 символа)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Не задано хотя бы одного ключа из: nID, nID_UA, sID_Two, sID_Three|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение иерархии объектов вверх начиная с указанного узла
----
GET /object/place/getPlace
----

===== Description
:hardbreaks:
ПримерыПолучить иерархию объектов вверх начиная с указанного узла (параметр nID).

https://test.igov.org.ua/wf-central/service/object/place/getPlace?nID=462
Ответ

```json
{
    "nLevelArea": null,
    "nLevel": 0,
    "o": {
        "nID": 462,
        "sName": "Віхове",
        "nID_PlaceType": 5,
        "sID_UA": "5923555102",
        "sNameOriginal": ""
    },
    "a": []
}

```
Примечание: по умолчанию возвращаются иерархия с ограниченным уровнем (только 1 уровень)
Получить иерархию объектов вверх начиная с указанного узла (параметр nID). Для активации выборки по полной иерархии необходимо указать параметр bTree.
https://test.igov.org.ua/wf-central/service/object/place/getPlace?nID=462&bTree=true
Ответ (возвращает иерархию объектов снизу вверх, напр. от деревни к району/области)

```json
{
    "nLevelArea": null,
    "nLevel": 2,
    "o": {
        "nID": 459,
        "sName": "Недригайлівський район/смт Недригайлів",
        "nID_PlaceType": 2,
        "sID_UA": "5923500000",
        "sNameOriginal": ""
    },
    "a": [
        {
            "nLevelArea": null,
            "nLevel": 1,
            "o": {
                "nID": 460,
                "sName": "Недригайлів",
                "nID_PlaceType": 4,
                "sID_UA": "5923555100",
                "sNameOriginal": ""
            },
            "a": [
                {
                    "nLevelArea": null,
                    "nLevel": 0,
                    "o": {
                        "nID": 462,
                        "sName": "Віхове",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923555102",
                        "sNameOriginal": ""
                    },
                    "a": []
                }
            ]
        }
    ]
}

```
Получить иерархию объектов вверх начиная с указанного узла (параметр sUA_ID).
https://test.igov.org.ua/wf-central/service/object/place/getPlace?sID_UA=5923555102
Получить иерархию объектов вверх начиная с указанного узла (параметр sUA_ID). Для активации выборки по полной иерархии необходимо указать параметр bTree.
https://test.igov.org.ua/wf-central/service/object/place/getPlace?sID_UA=5923555102&bTree=true

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|id места|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|QueryParameter|bTree|булевый флаг. если true -- в виде дерева|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<PlaceHierarchy>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Возвращает весь список стран
----
GET /object/place/getCountries
----

===== Description
:hardbreaks:
(залит справочник согласно Википедии и Класифікації країн світу)

пример:
https://test.igov.org.ua/wf/service/object/place/getCountries

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Country>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление типа места
----
POST /object/place/removePlaceType
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf-central/service/object/place/removePlaceType?nID=23417
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceTypes?bArea=false&bRoot=false


должен вернуть масив без вашей сущности:

```json
[
    {
        "bArea": false,
        "bRoot": false,
        "nID": 3,
        "sName": "Город",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 4,
        "sName": "ПГТ",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 5,
        "sName": "Село",
        "nOrder": null
    }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД записи|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Изменение дерева мест (регионов и городов)
----
POST /object/place/setPlaces
----

===== Description
:hardbreaks:
Можно менять регионы (не добавлять и не удалять) + менять/добавлять города (но не удалять), Передается json в теле POST запроса в том же формате, в котором он был в getPlaces.

Возвращает: HTTP STATUS 200 + json представление сервиса после изменения. Чаще всего то же, что было передано в теле POST запроса + сгенерированные id-шники вложенных сущностей, если такие были.

Пример: 
https://test.igov.org.ua/wf/service/object/place/setPlaces


```json
[
  {
    "nID": 1,
    "sName": "Дніпропетровська",
    "aCity":
    [
      {
        "nID": 1,
        "sName": "Cічеслав"
      },
      {
        "nID": 2,
        "sName": "Кривий Ріг"
      }
    ]
  }
]

```
Ответ: HTTP STATUS 200

```json
[
    {
        "nID": 1,
        "sName": "Дніпропетровська",
        "aCity": [
            {
                "nID": 1,
                "sName": "Cічеслав"
            },
            {
                "nID": 2,
                "sName": "Кривий Ріг"
            }
        ]
    }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|jsonData|строка-json в том же формате, в котором он был в getPlaces|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить иерархию объектов вниз начиная с указанного узла
----
GET /object/place/getPlacesTree
----

===== Description
:hardbreaks:
Примеры
Параметыр nID

https://test.igov.org.ua/wf/service/object/place/getPlacesTree?nID=459
Ответ

```json
{
    "nLevelArea": null,
    "nLevel": 0,
    "o": {
        "nID": 459,
        "sName": "Недригайлівський район/смт Недригайлів",
        "nID_PlaceType": 2,
        "sID_UA": "5923500000",
        "sNameOriginal": ""
    },
    "a": [
        {
            "nLevelArea": null,
            "nLevel": 1,
            "o": {
                "nID": 460,
                "sName": "Недригайлів",
                "nID_PlaceType": 4,
                "sID_UA": "5923555100",
                "sNameOriginal": ""
            },
            "a": []
        }
    ]
}

```
Примечание: по умолчанию возвращаются иерархия с ограниченным уровнем вложенности детей (поле nDeep, по умолчанию равно 1)
Получить иерархию объектов вниз начиная с указанного узла (параметр nID) и количества уровней вниз (параметр nDeep).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?nID=459&nDeep=4
Ответ:

```json
{
    "nLevelArea": null,
    "nLevel": 0,
    "o": {
        "nID": 459,
        "sName": "Недригайлівський район/смт Недригайлів",
        "nID_PlaceType": 2,
        "sID_UA": "5923500000",
        "sNameOriginal": ""
    },
    "a": [
        {
            "nLevelArea": null,
            "nLevel": 1,
            "o": {
                "nID": 460,
                "sName": "Недригайлів",
                "nID_PlaceType": 4,
                "sID_UA": "5923555100",
                "sNameOriginal": ""
            },
            "a": [
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 458,
                        "sName": "Вільшана",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923584401",
                        "sNameOriginal": ""
                    },
                    "a": []
                },
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 461,
                        "sName": "Вакулки",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923555101",
                        "sNameOriginal": ""
                    },
                    "a": []
                },
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 462,
                        "sName": "Віхове",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923555102",
                        "sNameOriginal": ""
                    },
                    "a": []
                }
            ]
        }
    ]
}

```
Получить иерархию объектов вниз начиная с указанного узла (параметр sUA_ID).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?sID_UA=5923500000

```json
{
    "nLevelArea": null,
    "nLevel": 0,
    "o": {
        "nID": 459,
        "sName": "Недригайлівський район/смт Недригайлів",
        "nID_PlaceType": 2,
        "sID_UA": "5923500000",
        "sNameOriginal": ""
    },
    "a": [
        {
            "nLevelArea": null,
            "nLevel": 1,
            "o": {
                "nID": 460,
                "sName": "Недригайлів",
                "nID_PlaceType": 4,
                "sID_UA": "5923555100",
                "sNameOriginal": ""
            },
            "a": []
        }
    ]
}

```
Получить иерархию объектов вниз начиная с указанного узла (параметр sUA_ID) и количества уровней вниз (параметр nDeep).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?sID_UA=5923500000&nDeep=3
Ответ:

```json
{
    "nLevelArea": null,
    "nLevel": 0,
    "o": {
        "nID": 459,
        "sName": "Недригайлівський район/смт Недригайлів",
        "nID_PlaceType": 2,
        "sID_UA": "5923500000",
        "sNameOriginal": ""
    },
    "a": [
        {
            "nLevelArea": null,
            "nLevel": 1,
            "o": {
                "nID": 460,
                "sName": "Недригайлів",
                "nID_PlaceType": 4,
                "sID_UA": "5923555100",
                "sNameOriginal": ""
            },
            "a": [
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 458,
                        "sName": "Вільшана",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923584401",
                        "sNameOriginal": ""
                    },
                    "a": []
                },
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 461,
                        "sName": "Вакулки",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923555101",
                        "sNameOriginal": ""
                    },
                    "a": []
                },
                {
                    "nLevelArea": null,
                    "nLevel": 2,
                    "o": {
                        "nID": 462,
                        "sName": "Віхове",
                        "nID_PlaceType": 5,
                        "sID_UA": "5923555102",
                        "sNameOriginal": ""
                    },
                    "a": []
                }
            ]
        }
    ]
}

```
Получить иерархию объектов вниз начиная с указанного узла (параметр nID или sUA_ID) c фильтрацией по типу (nID_PlaceType).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?nID=459&nDeep=3&nID_PlaceType=5

Получить иерархию объектов вниз начиная с указанного узла (параметр nID или sUA_ID) c фильтрацией по региону (bArea).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?nID=459&bArea=false&nDeep=3

Получить иерархию объектов вниз начиная с указанного узла (параметр nID или sUA_ID) c фильтрацией по корневому региону (bRoot).
https://test.igov.org.ua/wf/service/object/place/getPlacesTree?nID=459&bRoot=false&nDeep=3

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|id места|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|QueryParameter|nID_PlaceType|номер-МД типа места (населенного пункта/региона)|false|integer (int64)|
|QueryParameter|bArea|булевый флаг. если true -- только территория (район)|false|boolean|
|QueryParameter|bRoot|булевый флаг. если true -- только корень (область)|false|boolean|
|QueryParameter|nDeep|число вложенных уровней|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<PlaceHierarchy>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Cоздание нового тип места
----
POST /object/place/setPlaceType
----

===== Description
:hardbreaks:
Пример:
https://test.igov.org.ua/wf-central/service/object/place/setPlaceType?sName=Type_1&nOrder=2&bArea=false&bRoot=false
Результат
HTTP code = 200 OK

GET запрос по адресу https://test.igov.org.ua/wf-central/service/object/place/getPlaceTypes?bArea=false&bRoot=false


должен вернуть масив с вашей сущностью:

```json
[
    {
        "bArea": false,
        "bRoot": false,
        "nID": 3,
        "sName": "Город",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 4,
        "sName": "ПГТ",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 5,
        "sName": "Село",
        "nOrder": null
    },
    {
        "bArea": false,
        "bRoot": false,
        "nID": 23418,
        "sName": "Type_1",
        "nOrder": 2
    }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|QueryParameter|sName|строка имени|false|string|
|QueryParameter|nOrder|номер порядковый|false|integer (int64)|
|QueryParameter|bArea|булевый флаг. если true -- только территория (район)|true|boolean|
|QueryParameter|bRoot|булевый флаг. если true -- только корень (область)|true|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== ProcessSubjectController — Иерархия Процессов
:hardbreaks:
Process Subject Controller

==== Получение иерархии процессов
----
GET /subject/process/getProcessSubject
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/getProcessSubject?snID_Process_Activiti=MJU_Dnipro&nDeepLevel=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|nDeepLevel|глубина выборки|false|integer (int64)|
|QueryParameter|sFind|текст поиска (искать в ФИО, по наличию вхождения текста в ФИО)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubjectResult>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить процесс
----
GET /subject/process/setProcessSubjectDatePlan
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/setProcessSubjectDatePlan?snID_Process_Activiti=MJU_Dnipro&sDatePlan=2016-11-19 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|sDatePlan|sDatePlan|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить процесс
----
GET /subject/process/setProcessSubject
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/setProcessSubject?snID_Process_Activiti=MJU_Dnipro&sLogin=1&sDatePlan=19-11-2016&nOrder=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|sLogin|sLogin|false|string|
|QueryParameter|sDatePlan|sDatePlan|false|string|
|QueryParameter|nOrder|nOrder|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Задать статус процесса
----
GET /subject/process/setProcessSubjectStatus
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/setProcessSubjectStatus?snID_Process_Activiti=MJU_Dnipro&nID_ProcessSubjectStatus=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|sID_ProcessSubjectStatus|nID_ProcessSubjectStatus|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Задать номер заявки
----
GET /subject/process/setProcessSubjectOrder
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/setProcessSubjectOrder?snID_Process_Activiti=MJU_Dnipro&nOrder=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|nOrder|nOrder|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение иерархии процессов
----
GET /subject/process/getProcessSubjectTree
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/getProcessSubjectTree?snID_Process_Activiti=MJU_Dnipro&nDeepLevel=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|nDeepLevel|глубина выборки|false|integer (int64)|
|QueryParameter|sFind|текст поиска (искать в ФИО, по наличию вхождения текста в ФИО)|false|string|
|QueryParameter|bIncludeRoot|Флаг отображения рутового элемента для всей иерархии (true-отоборажаем, false-нет, по умолчанию Y)|false|boolean|
|QueryParameter|nDeepLevelWidth|Ширина выборки|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubjectResultTree>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Задать логин
----
GET /subject/process/setProcessSubjectLogin
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/process/setProcessSubjectLogin?snID_Process_Activiti=MJU_Dnipro&sLogin=1 


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Process_Activiti|ид процесса|true|string|
|QueryParameter|sLogin|sLogin|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<ProcessSubject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== RelationController — Обработка Relation
:hardbreaks:
Relation Controller

==== getRelations
----
GET /relation/getRelations
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Relation|sID_Relation|true|string|
|QueryParameter|nID_Parent|nID_Parent|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Relation_VO>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== SubjectCommonController — Организационная Иерархия
:hardbreaks:
Subject Common Controller

==== Получение сабджекта по логину
----
GET /subject/getSubjectByLoginAccount
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/getSubjectByLoginAccount?sLogin=kermit 
Ответ: HTTP STATUS 200



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|логин|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Subject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== SubjectController - Субъекты  И Смежные Сущности
:hardbreaks:
Subject Controller

==== Получение данных из справочника КВЕД
----
GET /subject/getActionKVED2
----

===== Description
:hardbreaks:
Получаем данные из справочника КВЕД. Пример:
https://alpha.test.igov.org.ua/wf/service/subject/getActionKVED2?sID=03&sNote=Прісноводне

Ответ:

```json
[
  {
    "sID": "03.12",
    "sNote": "Прісноводне рибальство ",
    "nID": 37
  },
  {
    "sID": "03.22",
    "sNote": "Прісноводне рибництво (аквакультура) ",
    "nID": 39
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID|sID - кретерий поиска в sID (без учета регистра, в любой части текста)|true|string|
|QueryParameter|sNote|sNote - кретерий поиска в sNote (без учета регистра, в любой части текста)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectActionKVED>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение данных из справочника КВЕД
----
GET /subject/getActionKVED
----

===== Description
:hardbreaks:
Получаем данные из справочника КВЕД. Пример:
https://alpha.test.igov.org.ua/wf/service/subject/getActionKVED?sFind=рибальство

Ответ:

```json
[
  {
    "sID": "03.11",
    "sNote": "Морське рибальство ",
    "nID": 36
  },
  {
    "sID": "03.12",
    "sNote": "Прісноводне рибальство ",
    "nID": 37
  }
]

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sFind|sFind - кретерий поиска в sID или sNote (без учета регистра, в любой части текста)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectActionKVED>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Предоставление сабджекту роли
----
GET /subject/setSubjectHumanRole
----

===== Description
:hardbreaks:
Предоставление сабджекту роли

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectHuman|nID_SubjectHuman|true|integer (int64)|
|QueryParameter|nID_SubjectHumanRole|nID_SubjectHumanRole|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Возвратить весь список таможенных органов
----
GET /subject/getSubjectOrganJoinTax
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Возвратить весь список таможенных органов #####

HTTP Context: https://server:port/wf/service/subject/getSubjectOrganJoinTax


Возвращает весь список таможенных органов (залит справочник согласно Державна фіскальна служба України. Офіційний портал)

Пример: https://test.igov.org.ua/wf/service/subject/getSubjectOrganJoinTax


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectOrganJoin|ID региональной таможни|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrganJoinTax>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /getSubjectOrgan
----
GET /subject/getSubjectOrgan
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получение объекта SubjectOrgan по номеру #####

HTTP Context: http://server:port/wf/service/subject/getSubjectOrgan


Если объект с заданным номером на найден - возвращается код 404
Примеры:

https://test.igov.org.ua/wf/service/subject/getSubjectOrgan?nID_Subject=1

Response

```json
{"oSubject":
	{"sID":"ПАО",
	"sLabel":"ПАО ПриватБанк",
	"sLabelShort":"ПриватБанк",
	"nID":1},
"sOKPO":"093205",
"sFormPrivacy":"ПАО",
"sNameFull":"Банк ПриватБанк",
"nID":1,
"sName":"ПриватБанк"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|номер-ИД субьекта|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrgan>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удалить cубьект-орган, или вставить
----
GET /subject/removeSubjectOrganJoinTax
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Удалить cубьект-орган, или вставить #####

HTTP Context: https://server:port/wf/service/subject/removeSubjectOrganJoinTax


Удаляет обьект по одному из двух ключей (nID, sID_UA) или кидает ошибку 403. Record not found!.


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД записи|false|integer (int64)|
|QueryParameter|sID_UA|строка-ИД места (в классификаторе Украины)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Добавление/обновление аккаунта субъекта
----
GET /subject/setSubjectAccount
----

===== Description
:hardbreaks:
Добавляет или обновляет аккаунт субъекта в зависимости от того задан или нет параметр **nID**. В случае успешного выполнения возвращается измененная или добавленная сущность.
Пример добавления записи:
**(Важно: обязательно измените любой параметр (не sNote), иначе получите ошибку ограничения уникальности записи)**

https://test.igov.org.ua/wf/service/subject/setSubjectAccount?nID_Subject=1&sLogin=mylog&nID_Server=55&nID_SubjectAccountType=2&sNote=Заметка_про_что-то

Ответ:

```json
{
  "sLogin": "mylog",
  "sNote": "Заметка про что-то",
  "subjectAccountType": {
    "sID": "PD",
    "sNote": "PD",
    "nID": 2
  },
  "nID_Server": 5,
  "nID_Subject": 1,
  "nID": 103
}

```
Пример обновления записи:

https://test.igov.org.ua/wf/service/subject/setSubjectAccount?nID=1&sNote=Заметка_обновленная

Ответ:

```json
{
  "sLogin": "Логин01",
  "sNote": "Заметка обновленная",
  "subjectAccountType": {
    "sID": "iGov",
    "sNote": "iGov",
    "nID": 1
  },
  "nID_Server": 1,
  "nID_Subject": 1,
  "nID": 1
}

```
Пример ошибочного добавления записи ( не заданы обязательные поля ):

https://test.igov.org.ua/wf/service/subject/setSubjectAccount

Ответ:

```json
{
  "code": "BUSINESS_ERR",
  "message": "Ошибка! При добавлении обязательны параметры: nID_Subject, sLogin, nID_Server, nID_SubjectAccountType"
}

```
Пример ошибочного добавления записи ( нарушение уникальности аккаунта ):

https://test.igov.org.ua/wf/service/subject/setSubjectAccount?nID_Subject=1&sLogin=Логин01&nID_Server=1&nID_SubjectAccountType=1

Ответ:

```json
{
  "code": "SYSTEM_ERR",
  "message": "could not execute statement; SQL [n/a]; constraint [SubjectAccount_sLogin_nID_SubjectAccountType_nID_Server_nID_key]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement"
}

```
Пример ошибочного обновление записи ( не существующий аккаунт ):

https://test.igov.org.ua/wf/service/subject/setSubjectAccount?nID=777

Ответ:

```json
{
  "code": "BUSINESS_ERR",
  "message": "Entity with id=777 does not exist"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ID аккаунта ( если не задан, то запись добавляется )|false|integer (int64)|
|QueryParameter|nID_Subject|ID субъекта ( необходим, при добавлении )|false|integer (int64)|
|QueryParameter|sLogin|Логин ( необходим, при добавлении )|false|string|
|QueryParameter|nID_Server|ID сервера ( необходим, при добавлении )|false|integer (int64)|
|QueryParameter|nID_SubjectAccountType|ID типа аккаунта ( необходим, при добавлении )|false|integer (int64)|
|QueryParameter|sNote|Строка нотации|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectAccount>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получает весь массив объектов джоинов субьектов-органа п.2 (либо всех либо в рамках заданных в запросе nID_Region, nID_City или sID_UA)
----
GET /subject/getSubjectOrganJoins
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получает весь массив объектов п.2 (либо всех либо в рамках заданных в запросе nID_Region, nID_City или sID_UA) #####

Параметры:

Пример ответа:

```json
[
  {
    "nID_SubjectOrgan":32343  // nID - ИД-номер автоитеррируемый (уникальный, обязательный) (long)
    ,"sNameUa":"Українська мова"  // sNameUa - ИД-строка <200 символов
    ,"sNameRu":"Русский язык"  // sNameRu - строка <200 символов
    ,"sID_Privat":"12345"  // sID_Privat - ИД-строка ключ-частный <60 символов //опциональный
    ,"sID_Public":"130501"  // sID_Public - строка ключ-публичный <60 символов
    ,"sGeoLongitude":"15.232312"  // sGeoLongitude - строка долготы //опциональный
    ,"sGeoLatitude":"23.234231"  // sGeoLatitude - строка широты //опциональный
    ,"nID_Region":11  // nID_Region - ИД-номер //опциональный
    ,"nID_City":33  // nID_City - ИД-номер //опциональный
    ,"sID_UA":"1"  // sID_UA - ИД-строка кода классификатора КОАТУУ //опциональный
  }
]

```
Пример:

https://test.igov.org.ua/wf/service/subject/getSubjectOrganJoins?nID_SubjectOrgan=1&sID_UA=1


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectOrgan|ИД-номер Субьекта-органа|true|integer (int64)|
|QueryParameter|nID_Region|ИД-номер места-региона (deprecated)|false|integer (int64)|
|QueryParameter|nID_City|ИД-номер места-города (deprecated)|false|integer (int64)|
|QueryParameter|sID_UA|ИД-строка места (унифицировано)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrganJoin>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /saveSubjectHuman
----
POST /subject/setSubjectHuman
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Нет описания #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|subjectHuman|subjectHuman|true|<<SubjectHuman>>|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectHuman>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /getSubjectHuman
----
GET /subject/getSubjectHuman
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получение объекта SubjectHuman по номеру #####

HTTP Context: http://server:port/wf/service/subject/getSubjectHuman


Если объект с заданным номером на найден - возвращается код 404
Примеры:

https://test.igov.org.ua/wf/service/subject/getSubjectHuman?nID_Subject=1

Response

```json
{"oSubject":
	{"sID":"2872618515",
	"sLabel":"Белявцев Владимир Владимирович",
	"sLabelShort":"Белявцев В. В.",
	"nID":2},
"sINN":"2872618515",
"sSB":"314542353425125",
"sPassportSeria":"AN",
"sPassportNumber":"11223344",
"sFamily":"Белявцев",
"sSurname":"Владимирович",
"nID":1,
"sName":"Владимир"}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|номер-ИД субьекта|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectHuman>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение информации о сервере
----
GET /subject/getServer
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получение информации о сервере #####

HTTP Context: https://test.region.igov.org.ua/wf/service/subject/getServer?nID=nID


возвращает json представление сущности Server, которая содержит информацию о сервере.

Примеры:
https://test.region.igov.org.ua/wf/service/subject/getServer?nID=0

Ответ:

```json
{
    "sID": "Common_Region",
    "sType": "Region",
    "sURL_Alpha": "https://test.region.igov.org.ua/wf",
    "sURL_Beta": "https://test-version.region.igov.org.ua/wf",
    "sURL_Omega": "https://master-version.region.igov.org.ua/wf",
    "sURL": "https://region.igov.org.ua/wf",
    "nID": 0
}

```
https://test.region.igov.org.ua/wf/service/subject/getServer?nID=-1
Ответ:
HTTP Status: 500 (internal server error)

```json
{
    "code": "BUSINESS_ERR",
    "message": "Record not found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|nID сервера|true|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление массива объектов п.2 (находя их по ИД)
----
GET /subject/removeSubjectOrganJoins
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Удаление массива объектов п.2 (находя их по ИД) #####

Пример: 
https://test.igov.org.ua/wf/service/subject/removeSubjectOrganJoins?nID_SubjectOrgan=1&asID_Public=130505,130506,130507,130508


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectOrgan|ИД-номер |true|integer (int64)|
|QueryParameter|asID_Public|массив ИД-номеров (в урл-е) (например [3423,52354,62356,63434])|true|multi string array|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение полного набора данных по субъектам
----
GET /subject/getSubjectsBy
----

===== Description
:hardbreaks:
Получаем полный набор данных по субъектам. Пример:
https://test.igov.org.ua/wf/service/subject/getSubjectsBy

что-бы протестировать эту чать кода надо 1) запустить проэкт 2)ввести дефолтные парольи логин из 'нашего хозяйства'  3)ввести в адресную строку типа этой (без слешей)http://localhost:8080/service/subject/getSubjectsBy?nID_Server=0&saAccount=["Barmaley","GrekD"] 4)ввести вторые логин и пароль из 'нашего хозяйства' Ответ:


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|saAccount|Массив с логинами чиновников в виде json|false|string|
|QueryParameter|nID_Server|Ид сервера|false|integer (int64)|
|QueryParameter|bSkipDetails|Не показывать подробности про организации и чиновников|false|boolean|false
|QueryParameter|nID_SubjectAccountType|Массив с типами аакаунтов  в виде json|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение субъекта
----
GET /subject/syncSubject
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получение субъекта #####

HTTP Context: http://server:port/wf/service/subject/syncSubject


Если субъект найден, или добавление субъекта в противном случае

От клиента ожидается ОДИН и только ОДИН параметр из нижеперечисленных

- nID - ИД-номер субъекта
- sINN - строка-ИНН (субъект - человек)
- sOKPO - строка-ОКПО (субъек - организация)
- nID_Subject - ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)


Примеры:

https://test.igov.org.ua/wf/service/subject/syncSubject?sINN=34125265377

https://test.igov.org.ua/wf/service/subject/syncSubject?sOKPO=123

https://test.igov.org.ua/wf/service/subject/syncSubject?nID=1

Response

```json
{
    "nID":150,
    "sID":"34125265377",
    "sLabel":null,
    "sLabelShort":null
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер субъекта|false|integer (int64)|
|QueryParameter|sINN|строка-ИНН (субъект - человек)|false|string|
|QueryParameter|nID_SubjectHumanIdType|номер-ИД типа идентификации субьекта-человека (по умолчанию 0)|false|integer (int32)|
|QueryParameter|sCode_Subject|строка-код, параметр-идентификатора субьекта (без префикса типа)|false|string|
|QueryParameter|sOKPO|строка-ОКПО (субъек - организация)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Subject>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Добавить/обновить массив объектов
----
GET /subject/setSubjectOrganJoin
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Добавить/обновить массив объектов п.2 (сопоставляя по ИД, и связывая новые с nID_Region, nID_City или sID_UA, по совпадению их названий) #####

Пример:
https://test.igov.org.ua/wf/service/subject/setSubjectOrganJoin?nID_SubjectOrgan=1&sNameRu=Днепр.РОВД


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectOrgan|ИД-номер|true|integer (int64)|
|QueryParameter|sNameUa|ИД-строка |true|string|
|QueryParameter|sNameRu|строка|true|string|
|QueryParameter|sID_Privat|ИД-строка ключ-частный <60 символов|true|string|
|QueryParameter|sID_Public|строка ключ-публичный <60 символов|true|string|
|QueryParameter|sGeoLongitude|строка долготы|true|string|
|QueryParameter|sGeoLatitude|строка широты|true|string|
|QueryParameter|sID_UA|ИД-строка|true|string|
|QueryParameter|nID_Region|ИД-номер|false|integer (int64)|
|QueryParameter|nID_City|ИД-номер|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение аккаунтов субъектов
----
GET /subject/getSubjectAccounts
----

===== Description
:hardbreaks:
Возвращает список аккаунтов субъектов, согласно заданных параметров. Обязательно должен быть задан один из параметров: **ID субъекта** или **Логин**. Если заданы оба, **Логин** игнорируется
Пример:
https://test.igov.org.ua/wf/service/subject/getSubjectAccounts?nID_Subject=1&nID_Server=1
Ответ:

```json
[
  {
	   "sLogin": "Логин01",
	   "sNote": "Примечание_1",
	   "subjectAccountType":
	   {
	     "sID": "iGov",
	     "sNote": "iGov",
	     "nID": 1
	   },
	   "nID_Server": 1,
	   "nID_Subject": 1,
	   "nID": 1
	 },
	 {
	   "sLogin": "Логин01",
	   "sNote": "Примечание_2",
	   "subjectAccountType":
	     {
	       "sID": "PD",
	       "sNote": "PD",
	       "nID": 2
	       },
    "nID_Server": 1,
	   "nID_Subject": 1,
	   "nID": 2
  }
]

```
Пример с ошибкой: не указаны обязательные параметры:
https://test.igov.org.ua/wf/service/subject/getSubjectAccounts
Ответ:

```json
{"code":"BUSINESS_ERR","message":"Error! Parameters nID_Subject and  sLogin is null"}

```
Пример, если записи не найдены:
https://test.igov.org.ua/wf/service/subject/getSubjectAccounts?nID_Subject=1&nID_Server=100
Ответ:

```json
{
  "code":"BUSINESS_ERR",
	 "message":"Record not found"
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Subject|ID субъекта ( необходим, если не указан Логин )|false|integer (int64)|
|QueryParameter|sLogin|Логин ( необходим, если, не указан ID субъекта )|false|string|
|QueryParameter|nID_Server|ID сервера|false|integer (int64)|
|QueryParameter|nID_SubjectAccountType|ID типа аккаунта|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectAccount>> array
|400|Ошибка в параметрах|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== /setSubjectOrgan
----
POST /subject/setSubjectOrgan
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Нет описания #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|subjectOrgan|subjectOrgan|true|<<SubjectOrgan>>|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrgan>>
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Синхронизация контактов
----
GET /subject/syncContacts
----

===== Description
:hardbreaks:
#### Пример: 
https://test.igov.org.ua/wf/service/subject/syncContacts?snID_Subject=2&sMailTo=test44@gmail.com&sPhone=654 
Ответ: 
HTTP Status: 200 

```json
[{"subject":{ 
"sID":"2872618515",
"sLabel":"Белявцев Владимир Владимирович", 
"sLabelShort":"Белявцев В. В.", 
"nID":2 
},"subjectContactType": 
{ 
"sName_EN":"Email", 
"sName_UA":"Електрона адреса", 
"sName_RU":"Электнонный адрес", 
"nID":1 
}, 
"sValue":"test44@gmail.com", 
"sDate":"2016-02-23 19:57:56.279", 
"nID":1003 
}, 
{ 
"subject": {
"sID":"2872618515", 
"sLabel":"Белявцев Владимир Владимирович", 
"sLabelShort":"Белявцев В. В.", 
"nID":2 
}, 
"subjectContactType": { 
"sName_EN":"Phone", 
"sName_UA":"Телефон", 
"sName_RU":"Телефон", 
"nID":0 
}, 
"sValue":"654", 
"sDate":"2016-02-23 19:58:41.325", 
"nID":1002} 
] 

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|snID_Subject|Строка ИД субъекта (автоматически добавляемые параметр, опциональный)|false|string|
|QueryParameter|sMailTo|Строка адрес электронной почты|false|string|
|QueryParameter|sPhone|Строка номер телефона|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Изменить cубьект-орган, или вставить
----
GET /subject/setSubjectOrganJoinTax
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Изменить cубьект-орган, или вставить #####

HTTP Context: https://server:port/wf/service/subject/setSubjectOrganJoinTax


Апдейтит элемент (если задан один из уникальных ключей) или вставляет (если не задан nID), и отдает экземпляр нового объекта.

Если нет ни одного параметра возвращает ошибку 403. All args are null! Если есть один из уникальных ключей, но запись не найдена -- ошибка 403. Record not found! Если кидать "новую" запись с одним из уже существующих ключей sID_UA -- то обновится существующая запись по ключу sID_UA, если будет дублироваться другой ключ -- ошибка 403. Could not execute statement (из-за уникальных констрейнтов)


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер, идентификатор записи|false|integer (int64)|
|QueryParameter|nID_SubjectOrganJoin|номер-ИД субьекта-органа джоина|false|integer (int32)|
|QueryParameter|sID_UA|ИД-номер Код, в Украинском классификаторе (уникальное)|false|string|
|QueryParameter|sName_UA|название на украинском (строка до 190 символов)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrganJoinTax>>
|401|Unauthorized|No Content
|403|All args are null|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получает весь массив атрибутов джоина субьекта-органа
----
POST /subject/getSubjectOrganJoinAttributes
----

===== Description
:hardbreaks:
##### SubjectController - Субъекты  и смежные сущности. Получает весь массив атрибутов джоина субьекта-органа #####



===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер Джоина Субьекта-органа|true|integer (int64)|
|BodyParameter|smAttributeCustom|Карта кастомніх атрибутов|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectOrganJoinAttribute>> array
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== SubjectGroupController — Организационная Иерархия
:hardbreaks:
Subject Group Controller

==== getSubjectGroupsTree
----
GET /subject/group/getSubjectGroupsTree
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Group_Activiti|ид группы|true|string|
|QueryParameter|nDeepLevel|глубина выборки|false|integer (int64)|
|QueryParameter|sFind|текст поиска (искать в ФИО, по наличию вхождения текста в ФИО)|false|string|
|QueryParameter|bIncludeRoot|Флаг отображения рутового элемента для всей иерархии (true-отоборажаем, false-нет, по умолчанию Y)|false|boolean|
|QueryParameter|nDeepLevelWidth|Ширина выборки|false|integer (int64)|
|QueryParameter|sSubjectType|Тип выборки: Organ- иерархия в разрезе органы,  Human -иерархия в разрезе людей, * - иерархия органы+люди|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectGroupResultTree>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение организационной иерархии
----
GET /subject/group/getSubjectGroups
----

===== Description
:hardbreaks:
##### Пример:
https://alpha.test.region.igov.org.ua/wf/service/subject/group/getSubjectGroups?sID_Group_Activiti=MJU_Dnipro&nDeepLevel=1 
Ответ: HTTP STATUS 200

{
"aSubjectGroup": [
{
"sID_Group_Activiti": "MJU_Dnipro_Top3",
"sChain": "MJU_Dnipro_",
"nID": 172,
"sName": "Управління державної виконавчої служби-начальник управління"
	}
	],
aSubjectUser": [
{
"sLogin": "MJU_common",
"sFirstName": "мінюст",
sLastName": "тестовий користувач",
sEmail":,
sPicture": "null
        }
    ]
}


```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Group_Activiti|ид группы|true|string|
|QueryParameter|nDeepLevel|глубина выборки|false|integer (int64)|
|QueryParameter|sFind|текст поиска (искать в ФИО, по наличию вхождения текста в ФИО)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectGroupAndUser>>
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getBPs_ForReferent
----
GET /subject/group/getBPs_ForReferent
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин сотрудника|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<SubjectRightBPVO>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== getBPs_ForExport
----
GET /subject/group/getBPs_ForExport
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sLogin|Логин сотрудника|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<Map«string,string»>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

=== SubjectMessageCommonController -- Сообщения Субьектов
:hardbreaks:
Subject Message Common Controller

==== /sendSms
----
GET /subject/message/sendSms
----

===== Description
:hardbreaks:
##### Контроллер отправки смс с проверкой номера по оператору абонента


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|phone|Номер телефона в формате 380XXXXXXXXX|true|string|
|QueryParameter|message|Текст сообщения|true|string|
|QueryParameter|sID_Order|Номер заявки|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== /sendSms
----
POST /subject/message/sendSms
----

===== Description
:hardbreaks:
##### Контроллер отправки смс с проверкой номера по оператору абонента


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|phone|Номер телефона в формате 380XXXXXXXXX|true|string|
|QueryParameter|message|Текст сообщения|true|string|
|QueryParameter|sID_Order|Номер заявки|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== callbackSMS
----
GET /subject/message/getCallbackSMS_PB
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|soData_JSON|soData_JSON|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

==== callbackSMS
----
POST /subject/message/getCallbackSMS_PB
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|BodyParameter|soData_JSON|soData_JSON|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* text/plain;charset=UTF-8

=== SubjectMessageController -- Сообщения Субьектов
:hardbreaks:
Subject Message Controller

==== Сохранить сообщение-фидбек заявки
----
POST /subject/message/setMessageFeedbackExtended
----

===== Description
:hardbreaks:
сохраняет сообщение-фидбек
Если запись успешно добавлена/обновлена то устанавливается sToken='' и sDate устанавливается в текущую.
Если запись найдена и sBody<>'', то возвращается статус 403 и сообщение "Already exists"
Если запись не найдена и sBody<>'', то возвращается 404 статус и сообщение "Record Not Found"
Если sToken<>'' и sToken<>null и sToken не совпадет с HistoryEvent_Service.sToken то возвращается 403 статус и сообщение "Security Error"

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки услуги|true|string|
|QueryParameter|sToken|Строка-токен (защита от постороннего доступа)|true|string|
|QueryParameter|nID_SubjectMessageType|Номер-ИД типа сообщения|false|integer (int64)|
|QueryParameter|sBody|строка текста фидбэка|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Already exist (если sBody в SubjectMessage не пустое ) / Security Error (если не совпадает токен)|No Content
|404|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /setMessageRate
----
GET /subject/message/setMessageRate
----

===== Description
:hardbreaks:
Установка сообщения-оценки

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки (временно опциональный)|true|string|
|QueryParameter|sID_Rate|Строка-ИД рейтинга/оценки (число от 1 до 5)|true|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить отзыв по услуге от сторонней организации
----
GET /subject/message/setFeedbackExternal
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Token|Строка-токен для доступа к записи|false|string|
|QueryParameter|sID_Source|ID источника|true|string|
|QueryParameter|sAuthorFIO|ФИО автора отзыва|true|string|
|QueryParameter|sMail|e-mail автора отзыва|true|string|
|QueryParameter|sHead|Заголовок отзыва|false|string|
|QueryParameter|sBody|Тело отзыва|true|string|
|QueryParameter|sPlace|Место|false|string|
|QueryParameter|sEmployeeFIO|Имя сотрудника|false|string|
|QueryParameter|nID_Rate|ID оценки|false|integer (int64)|
|QueryParameter|sID_Order|ID заявки|false|string|
|QueryParameter|nID_Service|ID сервиса|false|integer (int64)|
|QueryParameter|nID|ID отзыва, который надо отредактировать|false|integer (int64)|
|QueryParameter|nID_Subject|ID субъекта создавшего сообщение|false|integer (int64)|
|QueryParameter|bSelf|булевый параметр bSelf|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить отзыв по услуге от сторонней организации
----
POST /subject/message/setFeedbackExternal
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Token|Строка-токен для доступа к записи|false|string|
|QueryParameter|sID_Source|ID источника|true|string|
|QueryParameter|sAuthorFIO|ФИО автора отзыва|true|string|
|QueryParameter|sMail|e-mail автора отзыва|true|string|
|QueryParameter|sHead|Заголовок отзыва|false|string|
|QueryParameter|sBody|Тело отзыва|true|string|
|QueryParameter|sPlace|Место|false|string|
|QueryParameter|sEmployeeFIO|Имя сотрудника|false|string|
|QueryParameter|nID_Rate|ID оценки|false|integer (int64)|
|QueryParameter|sID_Order|ID заявки|false|string|
|QueryParameter|nID_Service|ID сервиса|false|integer (int64)|
|QueryParameter|nID|ID отзыва, который надо отредактировать|false|integer (int64)|
|QueryParameter|nID_Subject|ID субъекта создавшего сообщение|false|integer (int64)|
|QueryParameter|bSelf|булевый параметр bSelf|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение сообщения по услуге
----
GET /subject/message/setServiceMessage
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта (хозяина заявки сообщения)|false|integer (int64)|
|QueryParameter|sToken|Строка-Token|false|string|
|QueryParameter|sBody|Строка-тело сообщения|true|string|
|QueryParameter|sData|Строка дополнительных данных автора|false|string|
|QueryParameter|soParams|строка-массива параметров|false|string|
|QueryParameter|bAuth|булевский флаг, Включить авторизацию|false|boolean|
|QueryParameter|sID_File|Строка-ИД записи/файла (в оперативном кеше 'StorageTemp' (например Redis))|false|string|
|QueryParameter|sFileName|строка-Название файла|false|string|
|QueryParameter|sFileContentType|строка-типа контента файла|false|string|
|QueryParameter|nID_SubjectMessageType|ИД-номер типа сообщения|true|integer (int64)|
|QueryParameter|sHead|Заголовок сообщения|false|string|
|QueryParameter|sMail|электронка, но которую отсылаем|false|string|
|QueryParameter|bAddDate|указывать дату и время отправки письма|false|boolean|
|QueryParameter|sID_DataLink|Строка-ИД(ключ) записи/файла|false|string|
|QueryParameter|sID_DataLinkSource|Строка-ИД(ключ) источника записи/файла (Central(default), Region)|false|string|
|QueryParameter|sID_DataLinkAuthor|Строка-ИД(ключ) автора записи/файла (System(default), SFS)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение сообщения по услуге
----
POST /subject/message/setServiceMessage
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта (хозяина заявки сообщения)|false|integer (int64)|
|QueryParameter|sToken|Строка-Token|false|string|
|QueryParameter|sBody|Строка-тело сообщения|true|string|
|QueryParameter|sData|Строка дополнительных данных автора|false|string|
|QueryParameter|soParams|строка-массива параметров|false|string|
|QueryParameter|bAuth|булевский флаг, Включить авторизацию|false|boolean|
|QueryParameter|sID_File|Строка-ИД записи/файла (в оперативном кеше 'StorageTemp' (например Redis))|false|string|
|QueryParameter|sFileName|строка-Название файла|false|string|
|QueryParameter|sFileContentType|строка-типа контента файла|false|string|
|QueryParameter|nID_SubjectMessageType|ИД-номер типа сообщения|true|integer (int64)|
|QueryParameter|sHead|Заголовок сообщения|false|string|
|QueryParameter|sMail|электронка, но которую отсылаем|false|string|
|QueryParameter|bAddDate|указывать дату и время отправки письма|false|boolean|
|QueryParameter|sID_DataLink|Строка-ИД(ключ) записи/файла|false|string|
|QueryParameter|sID_DataLinkSource|Строка-ИД(ключ) источника записи/файла (Central(default), Region)|false|string|
|QueryParameter|sID_DataLinkAuthor|Строка-ИД(ключ) автора записи/файла (System(default), SFS)|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение массива сообщений по услуге
----
GET /subject/message/getServiceMessages
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|true|string|
|QueryParameter|sToken|Строка-Token|false|string|
|QueryParameter|bAuth|булевский флаг, Включить авторизацию|false|boolean|
|QueryParameter|isRegion|булевский флаг, определяющий сервер вызова|false|boolean|
|QueryParameter|nID_Subject|Номер-ИД субьекта (владельца заявки)|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получить сообщение-фидбек заявки
----
GET /subject/message/getMessageFeedbackExtended
----

===== Description
:hardbreaks:
получает сообщение-фидбека:
Если объект не найден по sID_Order, то возвращается код 404 и сообщение "Record Not Found"
Если sToken<>'' и sToken<>null и sToken не совпадет с HistoryEvent_Service.sToken то возвращается 403 статус и сообщение "Security Error"
если в найденном обекте SubjectMessage sBody='', то sDate в результате возвращается как null
Пример:
https://test.igov.org.ua/wf/service/subject/message/getMessageFeedbackExtended?sID_Order=0-4446&sToken=TokenValue
```json
{
    "sDate":"2015-11-10 23:23:59 001",
    "sHead":"Получение справки о доходах",
    "sID_Order":"0-4446",
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки услуги|true|string|
|QueryParameter|sToken|Строка-токен (защита от постороннего доступа)|true|string|
|QueryParameter|nID_SubjectMessageType|Номер-ИД типа сообщения|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Security Error (если не совпадает токен)|No Content
|404|Record not found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получить отзыв по услуге от сторонней организации по номеру отзыва и паролю или все отзывы по сервису
----
GET /subject/message/getFeedbackExternal
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ID отзыва|false|integer (int64)|
|QueryParameter|sID_Token|Строка-токен для доступа к записи|false|string|
|QueryParameter|nID__LessThen_Filter|фильтр, при задаче которого будет выдаваться список, в котором nID записей будут менее чем этот|false|integer (int64)|
|QueryParameter|nRowsMax|фильтр, при задаче которого будет лимитироваться указанное число отдаваемых строк|false|integer (int32)|
|QueryParameter|nID_Service|ID сервиса|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение сообщение 
----
GET /subject/message/setMessage
----

===== Description
:hardbreaks:
При заданных параметрах sID_Order или nID_Protected с/без nID_Server и sID_Rate - обновляется поле nRate в записи сущности HistoryEvent_Service, которая находится по sID_Order или nID_Protected с/без nID_Server (подробнее тут, при этом приходящее значение из параметра sID_Rate должно содержать число от 1 до 5. т.е. возможные ошибки:

- nID_Protected некорректное -- ошибка 403. CRC Error, пишется в лог (т.е. сообщение все равно сохраняется)
- sID_Rate некорректное (не число или не в промежутке от 1 до 5) -- ошибка 403. Incorrect sID_Rate, пишется в лог
- запись заявки (по nID_Protected без последней цифры) не найдена -- ошибка 403. Record not found, пишется в лог проверить запись HistoryEvent_Service можно через сервис \sevices\getHistoryEvent_Service?nID_Protected=xxx (link: 17. Работа с обьектами событий по услугам)

Примеры:
https://test.igov.org.ua/wf/service/subject/message/setMessage?sHead=name&sBody=body&sMail=a@a.a
Ответ: Status 200 если Ok


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sHead|Строка-заглавие сообщения|true|string|
|QueryParameter|sBody|Строка-тело сообщения|false|string|
|QueryParameter|nID_Subject|ИД-номер субьекта (автора) (добавляется в запрос автоматически после аутентификации пользователя)|false|integer (int64)|
|QueryParameter|sMail|Строка электронного адреса автора|false|string|
|QueryParameter|sContacts|Строка контактов автора|false|string|
|QueryParameter|sData|Строка дополнительных данных автора|false|string|
|QueryParameter|nID_SubjectMessageType|ИД-номер типа сообщения|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранение сообщение 
----
POST /subject/message/setMessage
----

===== Description
:hardbreaks:
При заданных параметрах sID_Order или nID_Protected с/без nID_Server и sID_Rate - обновляется поле nRate в записи сущности HistoryEvent_Service, которая находится по sID_Order или nID_Protected с/без nID_Server (подробнее тут, при этом приходящее значение из параметра sID_Rate должно содержать число от 1 до 5. т.е. возможные ошибки:

- nID_Protected некорректное -- ошибка 403. CRC Error, пишется в лог (т.е. сообщение все равно сохраняется)
- sID_Rate некорректное (не число или не в промежутке от 1 до 5) -- ошибка 403. Incorrect sID_Rate, пишется в лог
- запись заявки (по nID_Protected без последней цифры) не найдена -- ошибка 403. Record not found, пишется в лог проверить запись HistoryEvent_Service можно через сервис \sevices\getHistoryEvent_Service?nID_Protected=xxx (link: 17. Работа с обьектами событий по услугам)

Примеры:
https://test.igov.org.ua/wf/service/subject/message/setMessage?sHead=name&sBody=body&sMail=a@a.a
Ответ: Status 200 если Ok


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sHead|Строка-заглавие сообщения|true|string|
|QueryParameter|sBody|Строка-тело сообщения|false|string|
|QueryParameter|nID_Subject|ИД-номер субьекта (автора) (добавляется в запрос автоматически после аутентификации пользователя)|false|integer (int64)|
|QueryParameter|sMail|Строка электронного адреса автора|false|string|
|QueryParameter|sContacts|Строка контактов автора|false|string|
|QueryParameter|sData|Строка дополнительных данных автора|false|string|
|QueryParameter|nID_SubjectMessageType|ИД-номер типа сообщения|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

====  Возвращает содержимое отсылаемого сообщения, если такое существует.
----
GET /subject/message/getSubjectMessageData
----

===== Description
:hardbreaks:
Возвращает содержимое отсылаемого сообщения, если такое существует.:
Если не найдена запись SubjectMessage по ID или у найденного сообщения пустое поле, указывающее на контект сообщения, то метод возвращает ошибку с текстом сообщения "Record not found"
Пример:
https://test.igov.org.ua/wf/service/subject/message/getSubjectMessageData?nID_SubjectMessage=111111

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_SubjectMessage|номер-ИД записи с сообщением|false|string|
|QueryParameter|nID_Subject|Номер-ИД субьекта (хозяина заявки сообщения)|false|integer (int64)|
|QueryParameter|bAuth|булевский флаг, Включить авторизацию|false|boolean|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Сохранить ответ об отзыве по услуге от сторонней организации
----
POST /subject/message/setFeedbackAnswerExternal
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Token|Строка-токен для доступа к записи|false|string|
|QueryParameter|sBody|Тело ответа|true|string|
|QueryParameter|sAuthorFIO|ФИО автора ответа|true|string|
|QueryParameter|nID_SubjectMessageFeedback|ID отзыва, ответ на который надо сохранить|true|integer (int64)|
|QueryParameter|bSelf|Собственный контр-ответ автора фидбека|false|boolean|
|QueryParameter|nID_Subject|ID субъекта создавшего сообщение|false|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|201|Created|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

====  Центральный сервис получения контента файла
----
GET /subject/message/getMessageFile
----

===== Description
:hardbreaks:
получает массив байт контента файла:
Если не найдена запись с сообщением nID_Message, то возвращать ошибку с текстом сообщения "Record not found"
Если не найден файл в монге, то возвращать ошибку с текстом сообщения "Content not found"
Логика связанная с параметром sID_Order 
 -задан, то сверять наличие привязанности записи сообщения SubjectMessage с записью HistoryEvent_Service 

 (по полю "nID_HistoryEvent_Service" в SubjectMessage) и значению поля sID_Order в связанной записи HistoryEvent_Service; 
 если значения sID_Order не совпадают - выдавать ошибку "Alien order" 
 если значения sID_Order не связаны - выдавать ошибку "Order not found" 
 -не задан - отдавать найденный контент, если он найден /n/nПример:
https://test.igov.org.ua/wf/service/subject/message/getMessageFile?sID_Order=0-4446&nID_Message=

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|sID_Order|Строка-ИД заявки|false|string|
|QueryParameter|nID_Message|Номер-ИД сообщения|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== /setMessageFeedback_Indirectly
----
GET /subject/message/setMessageFeedback_Indirectly
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Protected|Номер-ИД заявки, защищенный по алгоритму Луна|true|integer (int64)|
|QueryParameter|nID_Proccess_Feedback|Номер-ИД бп фидбека по заявке|true|string|
|QueryParameter|sBody_Indirectly|Строка отзыв об услуге|true|string|
|QueryParameter|sID_Rate_Indirectly|Строка-ИД Рейтинга/оценки (число от 1 до 5)|true|string|
|QueryParameter|nID_Server|ИД сервера, где размещена заявка (опционально, по умолчанию 0)|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|string
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Получение массива сообщений 
----
GET /subject/message/getMessages
----

===== Description
:hardbreaks:
Примеры:
https://test.igov.org.ua/wf/service/subject/message/getMessages
nID_Subject - ID авторизированого субъекта (добавляется в запрос автоматически после аутентификации пользователя)
Response:

```json
[
    {
        "nID":76,"sHead":"Закликаю владу перевести цю послугу в електронну форму!"
        ,"sBody":"Дніпропетровськ - Видача витягу з технічної документації про нормативну грошову оцінку земельної ділянки"
        ,"sDate":"2015-06-03 22:09:16.536"
        ,"nID_Subject":0
        ,"sMail":"bvv4ik@gmail.com"
        ,"sContacts":""
        ,"sData":""
        ,"oSubjectMessageType": {
            "sDescription": "Просьба добавить услугу",
            "nID": 0,
            "sName": "ServiceNeed"
        }
    }
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

==== Получение сообщения
----
GET /subject/message/getMessage
----

===== Description
:hardbreaks:
Примеры: https://test.igov.org.ua/wf/service/subject/message/getMessage?nID=76

```json
Ответ:
{
    "nID":76
    ,"sHead":"Закликаю владу перевести цю послугу в електронну форму!"
    ,"sBody":"Дніпропетровськ - Видача витягу з технічної документації про нормативну грошову оцінку земельної ділянки"
    ,"sDate":"2015-06-03 22:09:16.536"
    ,"nID_Subject":0
    ,"sMail":"bvv4ik@gmail.com"
    ,"sContacts":""
    ,"sData":""
    ,"oSubjectMessageType": {
        "sDescription": "Просьба добавить услугу",
        "nID": 0,
        "sName": "ServiceNeed"
    }
}

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|nID|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|object
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* application/json

=== С — Действия Эскалаций
:hardbreaks:
Action Escalation Controller

==== Удаление записи функции эскалации по ее nID
----
GET /action/escalation/removeEscalationRuleFunction
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД функции  эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Запуск всех правил эскалаций
----
GET /action/escalation/runEscalation
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возвращает массив объектов сущности EscalationStatus
----
GET /action/escalation/getEscalationStatuses
----

===== Description
:hardbreaks:
##### Пример: https://<server>/wf/service/action/escalation/getEscalationStatuses

Oтвет:


```json
[
{"sNote":"Отослано письмо","nID":1,"sID":"MailSent"},
{"sNote":"БП создан","nID":2,"sID":"BP_Created"},
{"sNote":"БП в процессе","nID":3,"sID":"BP_Process"},
{"sNote":"БП закрыт","nID":4,"sID":"BP_Closed"}
]

```


===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationStatus>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавление/обновление записи функции эскалации
----
GET /action/escalation/setEscalationRuleFunction
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер (уникальный-автоитерируемый):
 - если nID не задан, то это создание записи;
 - если nID задан, но его нету — будет ошибка;
- если nID задан, и он есть — запись обновляется.
|false|integer (int64)|
|QueryParameter|sName|строка-название (Например "Отсылка уведомления на электронную почту")|true|string|
|QueryParameter|sBeanHandler|строка бина-обработчика|false|string|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRuleFunction>>
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Запуск правила эскалации по его Ид
----
GET /action/escalation/runEscalationRule
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ид правила эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возврат одной записи правила эскалации по ее nID
----
GET /action/escalation/getEscalationRule
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД правила эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRule>>
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Выборка всех записей функции эскалации
----
GET /action/escalation/getEscalationRuleFunctions
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRuleFunction>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Удаление записи правила эскалации по ее nID
----
GET /action/escalation/removeEscalationRule
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД правила эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|No Content
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Добавление/обновление записи правила эскалации
----
GET /action/escalation/setEscalationRule
----

===== Description
:hardbreaks:
##### ПРИМЕР:

```
https://test.region.igov.org.ua/wf/service/action/escalation/setEscalationRule?sID_BP=zaporoshye_mvk-1a&sID_UserTask=*&sCondition=nElapsedDays==nDaysLimit&soData={nDaysLimit:3,asRecipientMail:'test@email.com'}&sPatternFile=escalation/escalation_template.html&nID_EscalationRuleFunction=1


```
ОТВЕТ:

```json
  {
    "sID_BP":"zaporoshye_mvk-1a",
    "sID_UserTask":"*",
    "sCondition":"nElapsedDays==nDaysLimit",
    "soData":"{nDaysLimit:3,asRecipientMail:[test@email.com]}",
    "sPatternFile":"escalation/escalation_template.html",
    "nID":1008,
    "nID_EscalationRuleFunction":
    {"sBeanHandler":"EscalationHandler_SendMailAlert",
      "nID":1,
      "sName":"Send Email"
    }
  }

```


===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|ИД-номер (уникальный-автоитерируемый):
- если nID не задан, то это создание записи
- если nID задан, но его нету -- будет ошибка "403. Record not found"
- если nID задан, и он есть -- запись обновляется
|false|integer (int64)|
|QueryParameter|sID_BP|ИД-строка бизнес-процесса|true|string|
|QueryParameter|sID_UserTask|ИД-строка юзертаски бизнеспроцесса (если указана * -- то выбираются все задачи из бизнес-процесса)|true|string|
|QueryParameter|sCondition|строка-условие (на языке javascript )|true|string|
|QueryParameter|soData|строка JSON-обьектобьект, с данными|true|string|
|QueryParameter|sPatternFile|строка файла-шаблона (примеры тут)|true|string|
|QueryParameter|nID_EscalationRuleFunction|ИД-номер функции эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRule>>
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возврат одной записи функции эскалации по ее nID
----
GET /action/escalation/getEscalationRuleFunction
----

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID|номер-ИД функции эскалации|true|integer (int64)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRuleFunction>>
|401|Unauthorized|No Content
|403|Record not found|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возвращает массив объектов сущности по заданним параметрам
----
GET /action/escalation/getEscalationHistory
----

===== Description
:hardbreaks:
#####Примеры:
 Пример 1: https://alpha.test.igov.org.ua/wf/service/action/escalation/getEscalationHistory

Пример ответа:


```json
  [{
    "sDate":"2015-09-09 21:20:25.000",
    "nID":1,
    "nID_Process":9463,
    "nID_Process_Root":29193,
    "nID_UserTask":894,
    "nID_EscalationStatus":91
  }
  ...
  ]

```
Пример 2:
 https://alpha.test.igov.org.ua/wf/service/action/escalation/getEscalationHistory?nID_Process=6276&nID_Process_Root=57119&nID_UserTask=634&sDateStart=2014-11-24%2000:03:00&sDateEnd=2014-12-26%2000:03:00&nRowsMax=100

===== Parameters
[options="header"]
|===
|Type|Name|Description|Required|Schema|Default
|QueryParameter|nID_Process|номер-ИД процесса|false|integer (int64)|
|QueryParameter|nID_Process_Root|номер-ИД процесса (корневого)|false|integer (int64)|
|QueryParameter|nID_UserTask|номер-ИД юзертаски|false|integer (int64)|
|QueryParameter|sDateStart|строка дата начала выборки, в формате YYYY-MM-DD hh:mm:ss|false|string|
|QueryParameter|sDateEnd|строка дата конца выборки, в формате YYYY-MM-DD hh:mm:ss|false|string|
|QueryParameter|nRowsMax|максимальное число строк, по умолчанию 100 (защита - не более 5000)|false|integer (int32)|
|===

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationHistory>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

==== Возвращает список всех записей правил эскалации
----
GET /action/escalation/getEscalationRules
----

===== Responses
[options="header"]
|===
|HTTP Code|Description|Schema
|200|OK|<<EscalationRule>> array
|401|Unauthorized|No Content
|403|Forbidden|No Content
|404|Not Found|No Content
|===

===== Consumes

* application/json

===== Produces

* */*

